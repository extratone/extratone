Energy Management 



Energy Management 



Edited by 
Francisco Macia Perez 



In -Tech 

intechweb.org 



Published by In-Teh 

In-Teh 

Olajnica 19/2, 32000 Vukovar, Croatia 

Abstracting and non-profit use of the material is permitted with credit to the source. Statements and 
opinions expressed in the chapters are these of the individual contributors and not necessarily those of 
the editors or publisher. No responsibility is accepted for the accuracy of information contained in the 
published articles. Publisher assumes no responsibility liability for any damage or injury to persons or 
property arising out of the use of any materials, instructions, methods or ideas contained inside. After 
this work has been published by the In-Teh, authors have the right to republish it, in whole or part, in any 
publication of which they are an author or editor, and the make other personal use of the work. 

© 2010 In-teh 

www . intech web . org 

Additional copies can be obtained from: 

publication@intechweb.org 

First published March 2010 
Printed in India 

Technical Editor: Martina Peric 
Cover designed by Dino Smrekar 

Energy Management, 

Edited by Francisco Macia Perez 

p. cm. 
ISBN 978-953-307-065-0 



Preface 



Forecasts point to a huge increase in energy demand over the next 25 years, with a direct and 
immediate impact on the exhaustion of fossil fuels, the increase in pollution levels and the 
global warming that will have significant consequences for all sectors of society. 

Irrespective of the likelihood of these predictions or what researchers in different scientific 
disciplines may believe or publicly say about how critical the energy situation may be on a 
world level, it is without doubt one of the great debates that has stirred up public interest in 
modern times. 

The diverse and tragic events that have affected us recently — such as atmospheric phenomena, 
terrorist attacks, economic crises and ecological catastrophes — should help us to understand 
that the only possible response to these types of situations is to predict the possible scenarios 
that we might face in the short, medium and long term. In this way we may be prepared to 
prevent them or at least to mitigate their effects. 

These arguments alone are enough to fully justify that the study of energy management 
issues should be seriously taking into account by researchers, whose initiatives must be 
called to become an important benchmark. Furthermore, there is a reason, even for the most 
sceptical, to take an interest in energy management: we are at an ideal moment in which 
set out new objectives for sectors that are fast reaching their limits. For example, for some 
time the end user has been more concerned about power consumption and overheating in 
a new microprocessor than its speed in gigahertz. Similarly, Internet service providers are 
seeking more processing power and storage capacity at the same time as a suitable location 
that assures them of a stable and continuous electricity supply for their installations. So that, 
if right decisions are made on time then these threats can be transformed into opportunities. 

Whatever their motivations, many enterprises and governments have already started to 
develop energy management programs. For the moment, we can assume that we are still 
in the initial phases and that we are a little lost and bewildered, constantly asking ourselves 
what steps we should take or what measures we should adopt. 

We should probably already be thinking about the design of a worldwide strategic plan 
for energy management across the planet. It would include measures to raise awareness, 
educate the different actors involved, develop policies, provide resources, prioritise actions 
and establish contingency plans. This process is complex and depends on political, social, 
economic and technological factors that are hard to take into account simultaneously. Then, 
before such a plan is formulated, studies such as those described in this book can serve to 
illustrate what Information and Communication Technologies have to offer in this sphere 
and, with luck, to create a reference to encourage investigators in the pursuit of new and 
better solutions. 



VII 



Contents 



Preface V 

1 . Embedded Energy Management System for the ICT Saving Energy Consumption 001 
Francisco Macia-Perez, Diego Marcos-Jorquera, Virgilio Gilart-lglesias, 

Juan Antonio Gil Martinez-Abarca, Luis Felipe Herrera-Quintero, 
and Antonio Ferrandiz-Colmeiro 

2. Distributed Energy Management Using the Market-Oriented Programming 017 
Toshiyuki Miyamoto 

3. Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 039 
Hung-Chin Jang and Hon-Chung Lee 

4. Motor Energy Management based on Non-Intrusive Monitoring Technology 

and Wireless Sensor Networks 057 

Hu Jingtao 

5. Home energy management problem: towards an optimal and robust solution 077 
Duy Long Ha, Stephane Ploix, Mireille Jacomino and Minh Hoang Le 

6. Passivity-Based Control and Sliding Mode Control applied to Electric Vehicles 

based on Fuel Cells, Supercapacitors and Batteries on the DC Link 107 

M. Becherif, M. Y. Ayad, A. Henni, M. Wack, A. Aboubou, A. Allag and M. SebaT 

7. Equivalent consumption minimization strategies of series hybrid city buses 133 
Liangfei Xu, Guijun Cao, Jianqiu Li, Fuyuan Yang, Languang Lu and Minggao Ouyang 

8. Intelligent Energy Management in Hybrid Electric Vehicles 147 
Hamid Khayyam, Abbas Kouzani, Saeid Nahavandi, 

Vincenzo Marano and Giorgio Rizzoni 

9. Optimal Management of Power Systems 177 
Luca Andreassi and Stefano Ubertini 

10. Energy Management 203 
Alaa Mohd 



Embedded Energy Management System for the 

ICT Saving Energy Consumption 

Francisco Macia-Perez, Diego Marcos-Jorquera, Virgilio Gilart-Iglesias, 
Juan Antonio Gil Martinez- Abarca, Luis Felipe Herrera-Quintero, 

and Antonio Ferrandiz-Colmeiro 

Computer Science Department. University of Alicante 

Spain 

1. Introduction 

The importance of Information and Communication Technologies (ICT) in all areas of 
human activity in today's world is an indisputable fact. In the last years, there has been an 
exponential increase of the use of these technologies within the society, from its professional 
use in enterprises and organizations to its personal use in playful and everyday activities at 
home. In addition, the new ICT paradigms evolution together with the growing use of 
Internet have caused the apparition of new business models that require complex systems 
in order to support them, available 24 hours per day 7 days per week, with better quality of 
service, etc. 

However, this growing use of ICT technologies together with the requirements of emerging 
business models is converting these technologies in one of the main responsible of the 
worldwide energy consumption increase. In this way, (Gartner press, 2007) determines that 
the emission rate of CO2 originated from the ICT consumption is the 2% and predict that 
this energy consumption will grow in an exponential way in the next years if solutions are 
not adopted. 

In fact, one part of this consumption is due to an inefficient use of the ICT technologies. 
According to the study described in (Mines et al., 2008), a great number of the ICT managers 
know the necessary measures that they have to realize in order to obtain a energy saving 
produced by the use of ICT in their organizations, however, usually this measures are not 
applied if they do not mean an economic benefit for the business. One of the main reasons 
of the inadequate energy consumption of ICT listed in the study is the lack of awareness of 
the users in relation to this energetic problem that involve an incorrect use of the ICT 
infrastructures. Some examples of this uses are to leave power on Personal Computers 
(PC's), printers, servers or network devices when is not necessary. 

There is the paradox that one of the solutions with more repercussion nowadays in order to 
optimize the energy consumption of the ICT is the use of the same ICT. This approach is 
one of the main proposals of the European Union (Commission European Report, 2008) that 
pretend to promote an efficient use of the energy consumption through the use of the 
Information and Communications Technologies. 



Energy Management 



In consonance with this approach, our proposal consists of providing embedded IT 
management services in physical network devices (generally, small sized devices with 
simple services and low energy consumption), so that, in order to deploy those services, it is 
enough to select the specific device providing the service, and connecting it to the 
communications network. The device itself will obtain the minimum information required 
to activate the initial set up and, once this has been completed, execute the management 
tasks with minimal human intervention. 

Obviously, from a functional point of view the services offered by these devices are totally 
compatible with the traditional network services and therefore their integration and 
interoperability are ensured. 

By way of illustration and with the aim of arguing the motivating of the proposal, we 
suggest a specific management service that we named Energy Management System (EMS): 
a service for the ICT systems monitoring and consumption control of these same systems 
doing that the ICT resources will be available only when they are necessaries (in a proactive 
or scheduled way). Thus it will be possible to avoid processing and consumption during the 
downtimes. The goal of this service is to reduce and to optimize the energy consumption of 
the ICT infrastructures. 

The basic function of the service will be to indicate to the embedded EMS device (eEMS) 
which equipment and which service or services of those equipments we wish to check in 
order to reduce the energy consumption. These actions will be done according to system 
global load or of the requirements defined by the user or system administrator. 
In the following sections we provide a review of the current state of the art of the 
technologies involved; a description of the EMS service, hardware and software structure of 
the device in which it is embedded; the specification of the application protocol and its 
implementation as Web Service embedded in a specific network device and the test scenario 
in order to validate the proposal; and, finally, the conclusions on the research and the 
current lines of work. 



2. Background 

Increasing in the energy consumption has turned into a global problem. EU has ordered to 
the member states and industry to use the ICT to increase the energy efficiency as a mode to 
fight against climatic change and drive to economy recovery. According to European Union 
forecasts, through the ICT, the CO2 emissions can be reduced up to 15% in 2020. For achieve 
this purpose, the saving energy is based on two mainly ways. On the one hand, to make 
aware population about how to use the energy. On the other hand, an improvement in 
control and management of the energy use in industries, offices and public places. In this 
document it is recommended that the ICT industry itself could be the pioneer reducing their 
own CO2 emissions near to 20% in 2020 (European Union, 2008). 

The majority of the proposals in order to reduce the ICT energetic consumption are focused 
on getting better design of the devices architectures. In (Moshnyaga & Tamaru, 1997) 
different design techniques of ICT devices architectures are described with the aim of 
reducing the energetic consumption of these devices. In this way the Green Grid (The green 
gird, 2009) is focused on the best practices and management approaches for lowering data 
centers energy consumption. The Department of Energy of USA released the Server Energy 



Embedded Energy Management System for the ICT Saving Energy Consumption 3 

Measurement Protocol (EnergyStar, 2009) that establishes a procedure for attaching an 
energy usage measurement to existing performance measurements for servers. 
Another approach (Lawton, 2007) very used nowadays to reduce the ICT energetic 
consumption is the virtualization. This proposal is originated from the hypothesis that the 
majority of the servers in the data centers are working to the 20% of its capability. The use of 
virtualization systems such as VMWare enables to execute virtual machines inside an only 
server, making good use of its processing capability. 




Fig. 1. Google's Datacenter distribution. 



In the same way, another alternative that takes an advantages of the virtualization for the 
reduction of power consumption of the DataCenters, as which it is produced by TIC's 
elements and its infrastructure (e.g refrigeration systems), basically it is the geographical 
distribution of DataCenters, under climatic zones that allows in dynamic way, move the 
computation to some places, where there exists a better conditions of temperature and also 
a places where the electricity's fees are lowest (Follow the moon). This approach is not 
oriented directly for the computation, besides, only this is applicable to a very big 
companies as Google. 

However, in complex ICT environments with high availability requirements (replication, 
load balancing and clusterization), the proposals described previously are not enough to 
reduce the energetic consumption because the system management is not contemplated in a 
global way. 

The use of embedded devices in order to provide services in a distributed environment is 
other of the solutions that allow decreasing the ICT infrastructures energetic consumption. 
In this sense, many of these devices include the Power over Ethernet (PoE) technology. This 
technology allows providing energy to the devices through of Ethernet wire (Deuty, 2004). 
On the other hand, there are many proposals in order to monitor and control the energy 
consumption trough of ICT tools and applications. In (Pietilainen, 2003) several of these 
tools are described. These tools use emergent technologies such as Internet and distributed 
systems to control and to supervise energy consumption. This kind of tools is oriented to 
inspect the general energetic consumption in the buildings, and although they could be 
used to control the ICT specific consumption, these tools and applications do not include 



Energy Management 



features of proactive management, autonomy and inattention to optimize the consumption. 
In these cases, the person that manage the application is who once analyzed the information 
obtained has to take the decision and to execute it himself in order to optimize the 
consumption. In addition, these tools have to be executed in PCs, servers or more complex 
systems, and therefore, add an increase of the energetic consumption. 

The early researches about the energy management consumption were mainly focused on 
embedded and notebook systems. In these studies, the way of manage dynamically the 
energy for extending battery life is based on switching devices to lower-power modes 
when there is a reduced demand of services. Static strategies of energy management can 
lead to poor performance or unnecessary energy consumption when there are wide 
variations in the rate of requests of services (Ren et al., 2005). Some researches have augured 
that operating systems should be able to both implement energy-conservation policies and 
manage power for server applications at the system level (beini et al., 1998). In (Lien et al., 
2004) a system for saving energy in a web server clusters has been proposed by using 
dinamic server management. So, architecture for Dynamic Web-Server has beens 
presented for resources management in a server cluster. The goal was to allocate 
different numbers of servers for different service rates in a way that automatically 
adapts the server cluster to the Web requests and improves the energy efficiency. 
According to these proposals, in (Lien et al., 2004) a system for estimation of the energy 
consumption of streaming media centers has been proposed. All of the mentioned studies 
show the importance of to achieve saving energy consumption, specially, when the number 
of machines wired in networks is very high. 

The use of network management systems can help to automate the maintenance activities, 
allowing an efficient use of the network resources, and to be used to reduce the energy 
consumption. The first open standards which attempted to address problems of ICT 
management in a global manner were SNMP and CMIP (RFC project, 2009), proposed by 
the IETF (Internet Engineering Task Force); both protocols being principally oriented 
towards network monitoring and control. The main inconvenience of these administration 
models was their dependence on the platform. 

The use of multi-agent systems for computer network management provides a series of 
characteristics which favour automation and self reliance in maintenance processes (Du et 
al., 2003) (Guo et al., 2005). The creation of projects such as AgentLink III, the first 
Coordinated Action on based on Agents financed by the 6th European Commission 
Framework Programme, is a clear indicator of the considerable degree of interest in research 
into software agents. 

In areas where automated handling of information and those where several devices are 
involved, such as industrial processes or domotics, there has been a trend in the 
development of autonomous management towards architectures designed for services for 
embedded systems (Topp et al., 2002) (Jammes et al., 2005). This final framework includes 
monitoring systems developed by third parties but residing with the client, who is 
responsible for their control and management. Along these lines we find proposals such as 
NAGIOS (N AGIOS, 2009), MON (MON, 2009), MUNIN/MONIT (MUNIT, 2009) (MONIT, 
2009) or nPULSE (nPULSE, 2009) generic monitoring systems for network services for 
linux, with Web interface, highly configurable and based on open code which monitors the 
availability of network services and applications. The disadvantage of these proposals is 
based on the complexity of their installation and configuration in environments without 



Embedded Energy Management System for the ICT Saving Energy Consumption 5 

qualified system administrators, in addition to the complex systems and infrastructures 
required for their implementation. 

The approach described in this research work is presented as a solution that bring together 
the advantages of the current network management systems oriented to the control of ICT 
energetic consumption together with the use of embedded devices that minimize the 
consumption of these management systems. 

3. Energy Management Service 

The main goal of the EMS is to manage the power on or power off of a set of elements in a 
communications network in terms of a planning or in a proactive manner, analyzing the 
status of the system that is managed. 

The eEMS is the version of the management service that has been implemented in Web 
Service, and it has been embedded in a network device (known as eEMS Device) designed 
for this purpose (see fig. 2). This device is small in size, with low consumption, robust, 
transparent to existing ICT infrastructures and with minimum maintenance required from 
the system administrators. 

The system administrator informs the eEMS device, by means of its interface agents, which of 
the network components require a power management. The eEMS device has sufficient 
knowledge of each device to carry out this task. This knowledge is included in management 
agents displaced to the device for this purpose. The management agents implement specific 
protocols for power on devices, as the Wake on LAN (WoL) standard, or for power off, as 
the shoutdown in SNMP. In some cases, to take the decision to power off or power on a 
device, they utilize a set of monitoring agents that analyze applications, services or network 
traffic. In this way, if the device receives a request for manage a set of devices, it will request 
the adequate monitoring agents and management agents in a self sufficient manner in order to 
carry out this work. The management and monitoring agents dire enough flexible to adapt to 
the possible different scenarios. 

Thus, the eEMS device represents the core of the system. Figure 2 shows a diagram of the 
main elements and actors involved in the service, together with the existing relation 
between them. We may synthesise these as: eEMS Device, Network Components, Discovery 
Service, EMS Center, EMS Clients, a set of Software Agents and the EMS application 
protocol (EMSP). These elements shall subsequently be described in greater detail. 
The eEMS device, as has been seen, is the cornerstone of the energy management service. It 
is designed in order to act as a proxy between the Wide Area Network (WAN) and Local 
Area Network (LAN) to which it provides support. This device provides a container in 
which different agents and applications ensure that the service can be executed. 



Energy Management 






f 

Network 
Element 








Network 
Element 








Network 
Element 






— 


Network 
Element 



Fig. 2. Organization of functional elements of the EMS service. 



In the proposal implementation, the device interface with the system administrators and 
with other management devices or management equipments is provided by agents acting as 
embedded Web Services (see interface agent in figure 2). From a functional point of view, this 
is the reason why an eEMS device can be to taken into account, simply, as if it were a Web 
Service. In this way, an eEMS device is responsible for collecting the management request 
from the WAN. These requests are based on EMSP protocol and encapsulated in SOAP 
(Simple Object Access Protocol) messages when they are sent to the Web Service Interface. 
The Network Components are the goal of the network monitoring service and comprise all 
those devices connected to the TCP/IP network. This include PC's, servers, printers, routers 
and, in general, any device susceptive to power on or power off in a remote manner. 
The Discovery Service comprises a standard Universal Description, Discovery and 
Integration (UDDI) registration service. It is responsible for maintaining the pages 
describing the EMS services in Web Service Description Language (WSDL) format, as well 
as facilitating that information to the clients wishing to access the service. 
EMS Centers usually act as automated control panels for the eEMS devices distributed 
through Internet. This control is implemented through the planning agents who carry out, 
execute and verify all the previously established tasks on the eEMS devices. EMS Centres 
are also responsible for managing the repository of monitoring and management agents with 
the know-how of each device management. Although in large installations it is 
recommended that management and scheduling services are included, the existence of an 
EMS centre is not essential. Likewise, although each EMS centre can manage around a 
thousand eEMS devices, it is possible to use the number of EMS centers considered 
appropriate, and it is possible to create one hierarchy with these elements. 
EMS Clients, through the EMS agents, provide the user with access to the EMS Centre (in 
order to manage work plans or query log files) and to the eEMS Devices (in order to 
manage particular devices). These clients are not necessary for the normal operating system; 
however, they avoid physical movements of the system administration staff. 



Embedded Energy Management System for the ICT Saving Energy Consumption 7 

Software agents. System functionality has been defined as a distributed application based 
on software agents, because this approach intrinsically includes aspects such as: 
communications, synchronization, updates, etc. Among the agents that have been defined 
in the system, the most important are the agents placed in the eEMS device, and as a result, 
they comprise the system core. Of these last agents, the interface agents are of prime 
importance as they allow the device to provide its functionality to external elements (see 
section). 

The EMS protocol (EMSP) is a request-response application level protocol using SOAP 
messages. This protocol is used by the different system components in order to 
communicate between each other. In fact, as the application has been designed as a set of 
software agents, the protocol will be used by the software agents to communicate with each 
other (see section 5). 

4. Software Agents 

The software agents do not constitute a conventional multi-agent system because a generic 
context has not been defined for them, they do not use standard agent communication 
languages and they do not work collaborating to achieve a general target which is used by 
the agents to take its decisions. In fact, the set of software agents implement part of the 
functionality of a distributed application which has been designed to provide a network 
service; in this case, the monitoring service. The reason why agent approach is used lies in 
its simplicity to design distributed applications and to take into account aspects such as 
communication, mobility or software updates. 

Each eEMS device comprises a set of agents that implement its interface with the system 
administrators or with others system elements (EMS clients or EMS centers). In order to 
guarantee the system's compatibility with a large range of technologies, several interface 
agents have been implemented. In this way, the interface agent provides a matching interface 
with Web Services-based applications. The interface agent can identify commands based on 
EMSP protocol and, from these commands, schedule the eEMS device work plan. EMS 
agents, management agents and monitoring agents are another type of agent placed in the eEMS 
device and designed to perform the energy management service. The first type of agents 
ensures execution of the scheduling, delegating the specific monitoring task to a monitoring 
agent and the specific management task to a management agent. In addition to these core 
agents, other agents are included in each eEMS device in order to perform auxiliary tasks. 
Thus, the register agents undertake to check the monitoring service in a Discovery Service; 
and the employer agents are responsible for locating the management agents or monitoring 
agents required by the eEMS device to carry out its task. These agents are mobile agents that, 
initially, can reside in an agent farm located in an EMS Centre. 



Energy Management 



CMD 



ACTION ARG 



FUNCTION 



SET 



MODE 



RUN 



Reports the current operation mode. 



PASSIVE [port] 



Sets the passive mode and, optionally, the listening port 

number. 
ACTIVE <ip> Sets the active mode, specifying the EMS centerr's IP 
[:port] address and port number. 
Reports the current EMS service state. 







<STARTS 
STOP> 


| Starts or stops the EMS service. 


GET 


SCHDL 




Returns the list of scheduled tasks in the device. 




STATUS 


[<host>[:port] 
[<service>]] 


Returns the status of a specific service or a set of services. 


PUT 


SCHDL 


<schdl-table> 


Adds a task or a set of tasks to the scheduling. 



MONITOR 



ON <host>:<port> 

<time> 
<service> 
[arguments]* 

OFF <host>:<port> 
<service> 



Establishes a monitoring rule for the address 
<host>:<port>, establishing the poliing time in seconds 
and the monitor that will be utilized as well as the 
arguments that this require. 
Cancels a monitoring rule. 



ALERT 



Send an error alert. 



Table 1. Main instructions of the EMS protocol. 

Besides the agents located in each eEMS device, the distributed application is completed by 
other auxiliary agents located outside the device which, while not being crucial to the 
service, serve to make it more functional. As a result, the client agents reside in an EMS 
Client and are responsible for providing an appropriate interface for the administrators so 
that they can access the EMS Centre or an eEMS Device from any node connected to 
Internet. The planning agents reside in the EMS Centers and undertake the planning 
management of eEMS Devices. 



5. EMS Protocol 

The system agents, implemented in our prototype, communicate with each other by means 
of messages containing instructions capable of interpreting and executing. These 
instructions, together with their syntax and its pertinent response, come defined by the EMS 
Protocol or EMSP. When the agents specifically behave as Web Services, these commands 
will be incrusted inside the request and response SOAP messages. Web Services has been 
selected like communication protocol because it is an interoperable specification and that it 
permits to decouple totally the distinct actors of the system. 

The EMS Protocol (EMSP) is a request-response application level protocol which gathers all 
monitoring service functionality through a set of instructions. The protocol has been defined 
as a request-response text-based application protocol. This enables it be easily adapted to 
different models, such as client-server (over basic protocols like HTTP, SMTP or telnet) and 
SO A (over protocols like SOAP). 

The sequence diagram in figure 3 shows the basic service operation and the communication 
between the system software agents. The diagram comprises two blocks and is executed 
constantly in parallel mode. In the first block the device interface agents are on standby for 



Embedded Energy Management System for the ICT Saving Energy Consumption 9 

requests (from a Planning Agent or directly from a Client Agent). When the interface agents 
receive a monitoring request, they add the task to the Work Plan database of the eEMS 
device. The second diagram block corresponds to the execution of the programmed tasks. In 
this case the EMS Agent is constantly checking the Work Plan database and selecting the 
suitable Monitoring Agent and the Management Agent to carry out the requested tasks. 

EMS client EMS center eEMS device 



par J 



* I * II X B * * 

Client :; Planing I ; Interface Agent Work EMS Monitoring & 
...Agent M Agent j[ , .PJan Aggnt Management A. 



Network 
Elements 



DD 



loop I 



_a!L 
[passive mode] 



[active mode] 



loopj 



EMSP:PUTS€ HDL 
* P.l 



ONJT OR 



EMSP:MO!NITOR 



EMSP:GET $TATUS 



EMSP:GET SCHOL 

n \ 



EMSP:GET S TATUS 



t_work_pbn {) 



I mtjNorkjplan^ 



loopj 



;EMSP:ALERT; 



">. 



TCP/IP:mon i fo r() 



TCP/IP:marp e() 



Fig. 3. Sequence diagram of the EMS main functionality. 

Although it is not shown in this diagram, there is also a third block which concerns the 
contracting of the Monitoring Agents. When there is not a Monitoring or Management Agent 
able to deal with the service requested, the EMS Agent and the Interface Agents who have 
detected this lack may make a request to the Employer Agent programming it into its Work 
Plan. The Employer Agent then undertakes to obtain the Monitoring Agents required by the 
device. This agent is responsible for negotiating and validating the whole process. The 
Monitoring & Management Agents are mobile agents located in the agent repository in the 
EMS Centers. 



6. eEMS Device Implementation and Test Scenario 

In this section the implementation of an eEMS prototype device is presented (fig. 4). The 
hardware platform chosen for the prototype development is a Lantronix Xport® AR™ device 
which has a 16 bit DSTni-EX™ processor with 120MHz frequency reaching 30MIPS 
respectively (figure 4 shows an image of an eEMS device prototype connected to the service 



10 Energy Management 

network). The various memory modulates provided by this device undertake specific tasks 
according to their intrinsic features: the execution programmes and the dates handled by 
the device SRAM memory reside in the (1,25MB); the ROM memory (16KB) holds the 
system start up application and, finally, the flash memory, with 4MB, stores information 
which though non-volatile, is susceptible to change, such as the set up of the eEMS device 
or the system applications which may be updated. These capacities are sufficient for the 
memory requirements of the software developed for implementing the protocol. 
Among other I/O interfaces, the device has a Fast Ethernet network interface which allows 
suitable external communications ratios. In addition, in order to ensure the correct system 
operation, there are several auxiliary elements such as: a watchdog which monitors the CPU 
and prevents it from blocking; and a PLL frequency divider required to set up the frequency 
of the system clock, with an adjustable clock signal (CLK) to optimise consumption or 
performance according to needs. 

As a real time operating system, the device incorporates version 3 of the Lantronix OS, 
Evolution OS™. Through a confidentiality agreement with Lantronix, we have had access to 
the different modules of the system. Given the space restrictions, this has been crucial to 
develop a made-to-measure version of this OS. Salient elements of this version include, a 
TCP/IP stack together with several client-server application protocols (HTTP, TFTP, SNMP 
and telnet). 

In the service layer, the implementation process has been conditioned by the limited 
characteristics of XPort AR device. Three service blocks are implemented: the middleware 
that provides the communication mechanisms of the monitoring service, the EMS service 
kernel with the implementation of EMS instructions, and the middleware platform that 
provides the execution of software agents. 

The communication service middleware is upheld by standard protocols and technologies 
included in the Evolution OS. In the SOA based EMSP implementation (i.e., the Web Service 
interface), the cSOAP library was used for development, which is appropriate for these 
devices (cSOAP, 2009). However, some changes have been made to the original cSOAP 
library due to device limitations (restriction of memory use, proprietary libraries, etc.). 
These limitations have forced us to replace cSOAP XML parser, LibXML2 (over 1 MB in 
size), by another adapted XML parser with limited but sufficient functionalities to achieve 
our objective. Due to cSOAP limitations, only RPC style which uses the same protocol 
analyser used in the Client-Server version has been developed. 



Embedded Energy Management System for the ICT Saving Energy Consumption 



11 



OS Container 



Python Container 




TCP/IP Network 



Fig. 4. eEMS device prototype architecture (left) and picture (right). 



In addition, in order to register and to publish the services, an UDDI embedded version has 
been implemented based on UDDI version 2.0 which simply permits publishing the WSDL 
document associated with the monitoring service. 

The EMS service kernel has been implemented as a functions library written in C language 
and offered as API for the others eEMS device modules. By means of this library, the 
intrinsic functionalities of the monitoring service are achieved. 

In order to implement service agents, a division has been made in the implementation 
process between static and mobile agents. In the first case, an ad-hoc implementation for the 
XPort AR device has been developed in C language, using an operative system such as the 
agents' container. In the second case, in order to establish an execution framework for the 
mobile agents (the monitoring agents), a Python embedded engine (ePython version 2.5) has 
been adapted to the XPort AR features. These monitoring agents are implemented as Python 
text scripts. 

In order to validate the proposal described in this research work the system and ICT 
infrastructures that support the Web applications of the Polytechnic University College at 
the University of Alicante have been chosen like test scenario (Fig. 5.). It is a replicated 
scenario that includes features of high availability and fault tolerance. 



12 Energy Management 



Uni versi tat d'Alacaiti HBP ? 

f/—^ LJniversidad da- Alicante 







Becas y ayuaa& 



■ n-mm .in..V.i -. ^r win. tt*Ht«t MhhiIM 



■■- 



yfe^ *f*— >— MiMMUfc i i h — . 1*1 ^§t!^*?3 



Fig. 5. Polytechnic University College Web Site. 

The Web applications provide different services for the students around 9044, for the 
professors around 609, for the administration and services staff and for the external users. 
These applications are available during 24 hours per day and 7 days per week (inscription 
system, Web storage system, Web email system, management system, virtual classroom 
system, general information and others Web applications). 

In the table 2, the system components are enumerated, describing the main services 
included and its infrastructures. This scenario is composed by 10 machines that gives to the 
users all that them need. 

Service Type Server Model Number 

Apache Web Server Asus RS120-E4/PA2 3 
Apache Tomcat Application Server Asus RS120-E4/ P A2 3 
MySQL Database Asus RS120-E4/PA2 2 
OpenLDAP service directory Asus RS120-E4/PA2 2 

Table 2. The Polytechnic University College at the University of Alicante test scenario 

components. 

In figure 6 is showed the chart that include the accesses average of all users to the 
applications of the Polytechnic University College and the amount of Web traffic transferred 
in one day. Based on the information displayed in the chart the consumption optimization 
strategy of the resources has been defined. 



Embedded Energy Management System for the ICT Saving Energy Consumption 



13 




1 



k 



J_l 



jeP *P *P .# .oP .<$> .& 



S& .& *P .<P ^ .<? .cP .<£ .o Q 



.^ ,Q Q° 



3- v V ^- X <i <d V ^ #• *- *y j0 ;. ^. t*. <j t;. a- *- o,-- £■ vv -V- ^ 



^ N> V V -V" N? SP V *C? *v" ^ V -V" V 

Time of Day 
I Resource RequestflOOQx) ■ Tr aff i c A mo u nt (MB) 



Fig. 6. Average of user requests and amount traffic per day. 



In the eEMS device a scheduling has been established that define the time intervals in which 
all servers have to be power on, also we have considered the traffic by these, due to this 
variable offers what users needs, and therefore is possible to know when there is more or 
not information processing into the servers that causes an increment or a diminution of 
energy consumption. This scheduling has been realized according to the information 
obtained of the users' accesses to the different applications. In the critical periods the 
scheduling will obligate to maintain the systems at full performance. Out of the defined 
periods, the eEMS, in an automatic way, will be responsible of analyzing the information 
traffic, the request number and accesses to the different applications. In function of the 
analysis, the eEMS will send the adequate commands sequence in order to power on or 
power off different system nodes, that is, the system capacity level will be maintained in a 
dynamic way based on the petition. 

The eEMS is able to manage all of the machines that take part into the infrastructure; the 
number of machines that is power on depends of the traffic that is generated by the users at 
the time of day. In our scenario there is always 7 machines turn it on due to the system 
needs to give support to critical applications, however there is several time of day that the 
eEMS systems keep power off some machines. In a normal infrastructure, there is always 10 
machines that are power on and some machines are not been using by the users for that 
reason the energy consumption is higher. The eEMS allows to use the system in a more 
efficient way obtaining energy consumption saving. During one week several tests have 
been realized using the management service and as a result a 13,7% reduction of the energy 
consumption has been observed in relation to the system without the eEMS device (see table 
3 and 4). 



14 



Energy Management 





Service Type 


Server 
Model 


Energy Consumption 

Average with EMS (wh) 

Vlinimum Average Maximum 


Apache Web Server 

Apache Tomcat Application 

Server 

MySQL Database 

OpenLDAP service directory 


Asus RS120-E4/PA2 
Asus RS120-E4/PA2 

Asus RS120-E4/PA2 
Asus RS120-E4/PA2 


195,04 
195,04 

195,04 
97,52 


660,87 
603,79 

466,67 
359 


885 
885 

590 
590 


Table 3. Energy Consumption 


with the EMS system. 








Service Type 


Server 
Model 


Ener 
Averag< 
Minimum 


gy Consumption 
- without EMS (wh) 
Average Maximum 


Apache Web Server Asus RS120-E4/PA2 

Apache Tomcat Application Asus RS120-E4/PA2 

Server 

MySQL Database Asus RS120-E4/ P A2 

OpenLDAP service directory Asus RS120-E4/PA2 


292,56 
292,56 

195,04 
195,04 


700 
700 

466,67 
466,67 


885 
885 

590 
590 



Table 4. Energy Consumption without EMS system. 

The energetic saving has not been better (see figure 7) because in this scenario there was one 
requirement of faults tolerance that obligate to have, minim, two servers to support each 
service. Obviously, if the system is more complex and there are more replicated nodes for 
each service the energetic saving will be greater. 




■in .ii 



ri m rr 



<P J5P .<£ .<£> &JPjPj&jP fP *P ■<£ ^ & &<&,&,,& .& .& & & & & 

& v v ?>■ *■ V fa- -v %■ <y ^>- s v $,■ $>■ ,*■ $>• v fa' ,£■ $,• #• ^>- ^v ^y ^b- 

Time of day 
■ EMS with systemfwh) ■ Con sum without EMS(wh) 

Fig. 7. Relation between energy consumption with the EMS system and without it. 



Embedded Energy Management System for the ICT Saving Energy Consumption 15 

Also, we considerer to highlighted, that the embedded device chosen include the PoE 
technology, when the eEMS is included in the system its consumption is practically 
negligible. If the network infrastructures where the eEMS is connected do not support PoE 
technology, the consumption of XPort AR where the service EMS is included would be only 
0,957W. 

7. Conclusion 

In this paper we have presented an energy management system for the ICT infrastructures 
designed to saving the energy consumption. This system is totally complementary with 
others approaches oriented to the energy saving and is enough flexible to adapt to different 
scenarios. One of the most relevant aspects of this system consists of providing these 
embedded management services in network devices with small size, simple, low power 
consumption, adjusted costs, autonomous, designed with safety criteria and robustness, and 
compatible with the traditional network services through the standard protocols such as: 
SOAP, SMTP or HTTP. In order to validate the proposal, a functional prototype has been 
designed and implemented. The prototype has been used in a real scenario where we have 
obtained satisfied results. 

We are currently working with other embedded network services and integrating them all 
in a model based on Semantic Web Services, so that in future they will not only be 
compatible with existing services, but also with new services or setups which were not 
considered in the initial design. 

8. Acknowledgments 

This work was supported by the Spanish Ministry of Education and Science with Grant 
TIN2006-04081. 



9. References 

Beini, L; Boglio, A.; Cavalluci, S. & Ricco. B. (1998). Monitoring system activity for OS- 
directed dynamic power management. International Symposium on Low Power 
Electronics and Design. ISLPED'98 pp: 185 - 190, 1998 ISBN: 1-58113-059-7. 

Commission European Report: Addressing the challenge of energy efficiency through 
Information and Communication Technologies, COM (2008) 241 final, Available 
from http://ec.europa.eu 

cSOAP: http://csoap.sourceforge.net/ (URL). 

Deuty, S. (2004). Exploring the options for distributed and point of load power in telecomm 
and network applications. Telecommunications Energy Conference, 2004. INTELEC 
2004. 26th Annual International, pp 223- 229, ISBN: 0-7803-8458-X Chicago, 
September 2004, United States of America. 

Du, T.C.; Li, E.Y. & Chang, A.P. (2003). Mobile Agents in Distributed Network 
Management. In Communications at the ACM, 46(7), ppl27-132. ISSN:0001-0782, 
New York, July 2003, United Sates Of America. 

Energy Star: http://www.energystar.gov/ (URL) 



16 Energy Management 

European Union. (2008). Addressing the challenge of energy efficiency through Information 
and Communication Technologies. http://eur-lex.europa.eu/LexUriServ/ 
LexUriServ.do?uri=COM:2008:0241:FIN:EN:PDF(URL) 

Gartner press release: Gartner Estimates ICT Industry Accounts for 2 Percent of Global C02 
Emissions. Gartner Symposium/ ITxpo 2007 Emerging Trends, April 26, (2007) 
Available from http://www.gartner.com/ it/page.jsp?id=503867 

Guo, J.; Liao, Y. & Parviz, B. (2005). An Agent-Based Network management system. 
Presented at the 2005 Internet and Multimedia Applications. 

Jammes, F.; Smit, H.; Martinez-Lastra, J.L. & Delamer, I.M. (2005). Orchestration of Service- 
Oriented Manufacturing Processes. Proc. of the 10th IEEE International Conference on 
Emerging Technologies and Factory Automation, ETFA 2005, ISBN 0-7803-9401-1, 
Catania, September 19-22, 2005, Italy 

Lawton, G. (2007). Powering Down the Computing Infrastructure. Computer, vol. 40, no. 2, 
pp. 16-19, IEEE Computer Society, ISSN: 0018-9162. 

Lien, C.H.; Bai, Y.W.; Lin, M.B. & P.-A. Chen. (2004) The saving of energy in web server 
clusters by utilizing dynamic sever management. Proceedings. 12th IEEE 
International Conference on Networs. vol. 1, pp. 253-257. ISBN: 0-7803-8783-X. 
Hyderabad,December 2004,India 

Lien, C.H.; Bai, Y.W. & Lin, M. B. (2007). Estimation by Software for the Power 
Consumption of Streaming Media Servers. IEEE Transactions on Instrumentation and 
Measurement, vol.56 no.5, pp: 1859-1870 . ISSN: 0018-9456. Braunschweig, October 
2007, Germany 

Mines, C; Ferrusi, C; Brown, E.; Lee, C. & Van-Metre, E. (2008).: The dawn of green IT 
services. A market overview of sustainability consulting for IT organizations. 
Forrester Research Report. (2008) 

MON: http://www.kernel.org/software/mon/ (URL) 

MONIT: http://www.tildeslash.com/monit/ (URL) 

MUNIN: http://munin.projects.linpro.no/ (URL) 

NAGIOS: http://nagios.org (URL) 

Moshnyaga, G. V. & Tamaru, K. (1997). Energy Saving Techniques for Architecture Design 
of Portable Embedded Devices. lOTh annual IEEE International ASIC Conference and 
Exhibit. ISBN: 0-7803-4283-6, New York, September 1997, United States of America. 

nPULSE: http://www.horsburgh.com/h_npulse.html (URL) 

Pietilainen, J. (2003). Improved Building Energy Consumption with the Help of Modern 
ICT. ICEBO. International Conference for Enhanced Building operations. California, 
October 2003, United States of America. 

Ren, Z.; Krogh, B. H. & Marculescu, R. (2005). Hierarchical adaptive dynamic power 
management. IEEE Transactions on Computers, vol. 54, no. 4, pp. 409-420. ISSN:0018- 
9340. 

RFC Project: http://www.rfc.net (URL) 

The Green Grid: http://www.thegreengrid.org/ (URL) 

Topp, U.; Muller, P.; Konnertz, J. & Pick, A. (2002). Web based Service for Embedded 
Devices, LNCS vol. 2593, 2002, pp. 141-153. ISBN 978-3-540-00745-6 



Distributed Energy Management Using 
the Market-Oriented Programming 

Toshiyuki Miyamoto 

Osaka University 
Japan 



1. Introduction 

This chapter discusses energy planning in a small district composed of a set of corporate 
entities. Although the term " energy planning" has a number of different meanings, the energy 
planning in this chapter stands for finding a set of energy sources and conversion devices so 
as to meet the energy demands of all the tasks in an optimal manner. Since reduction of CO2 
emissions which are the main factor of global warming is one of the most important problems 
in the 21st century about preservation of the earth environment, recent researches on energy 
planning consider reducing impacts to the environment(Cormio et al., 2003; Dicorato et al., 
2008; Hiremath et al., 2007). 

On the other hand, corporate entities with energy conversion devices become possible to sale 
surplus energy by deregulation about energy trading. Normally conversion devices have non- 
linear characteristics; its efficiency depends on the operating point. By selling energy to other 
entities, one may have an opportunity to operate its devices at a more efficient point. 
We suppose a small district, referred to be a "group", that composed of independent plural 
corporate entities, referred to be "agents", and in the group trading of electricity and heat 
energies among agents are allowed. We also suppose that a cap on CO2 emissions is imposed 
on each agent. Each agent performs energy planning under the constraints on CO2 emissions 
and by considering energy trading in the group. 

An agent may take various actions for reduction: use of alternative and renewable energy 
sources, use of or replacement to highly-efficient conversion devices, purchase of emission 
credits, and so on. Use of alternative and renewable energy sources and purchase of emission 
credits are easier ways to reduce CO2 emissions. However, there is no guarantee to get suf- 
ficient amount of such energy or credit at an appropriate price, because the amount of such 
energy and credit is limited and their prices are resolved in the market. On the other hand, 
installing a highly-efficient conversion device comes expensive. 

Another way to reduce CO2 emissions is energy trading among agents. Suppose that one 
agent is equipped with an energy conversion device such as boilers, co-generation systems, 
etc. If he operates his device according to his energy demands only, the operating point of 
the device cannot be the most efficient one. Energy trading among agents makes it possible to 
seek efficient use of devices, and as a result to reduce CO2 emissions. 

When we attempt to minimize energy cost under the constraints on CO2 emissions in the 
group, it is not difficult by considering the entire group as one agent. But it is another matter 



18 Energy Management 



whether each agent will accept the centralized optimal solution because agents are indepen- 
dent. Therefore, we adopt a cooperative energy planning method instead of total optimiza- 
tion. By this method, we want to reduce energy consumption considering the amount of the 
CO2 emissions in the entire group without undermining the economic benefit to each agent. 
A software system in the control center in a power grid to control and optimize the perfor- 
mance of the generation and /or transmission system is known as an energy management 
system (EMS). We are considering a distributed software system that performs energy plan- 
ning in the group. We call such a energy planning system for the group a distributed energy 
management system (DEMS). 

Corresponding mathematical formulation of the energy planning is known as the unit com- 
mitment (UC) problem(Padhy, 2004; Sheble & Fahd, 1994). Although the goal of our research 
is solving the UC problem and deciding the allocation of traded energies in DEMSs, the main 
topic of this chapter is to discuss how to find an optimal energy allocation. In order to make 
the problem simple, we consider the UC problem with only one time period and all of the 
energy conversion devices are active. Most methods for the UC problem solve in centralized 
manner. But as mentioned before we cannot apply any centralized method. Nagata et al. 
(2002) proposed a multi-agent based method for the UC problem. But they did not consider 
energy trading among agents. 

The interest of this chapter is how to decide the allocation of traded energies through coordi- 
nation among agents. In DEMSs, an allocation that minimize the cost of a group is preferred; 
a sequential auction may be preferred. Therefore, we propose to apply the market-oriented 
programming (MOP)(Wellman, 1993) into DEMSs. 

The MOP is known as a multi-agent protocol for distributed problem solving, and an optimal 
resource allocation for a set of computational agents is derived by computing general equilib- 
rium of an artificial economy. Some researches, which uses the MOP, have been reported in 
the fields of the supply chain management(Kaihara, 2001), B2B commerce(Kaihara, 2005), and 
so on. Maiorano et al. (2003) discuss the oligopolistic aspects of an electricity market. 
This chapter is organized as follows. Section 2 introduces the DEMSs and an example group. 
An application of the MOP into DEMSs is described in Section 3. The bidding strategy of 
agents and an energy allocation method based on the MOP is described. In Section 4, com- 
putational evaluation of the MOP method is performed comparing with three other methods. 
The first comparative method is an multi-items and multi-attributes auction-based method. 
The second one is called the individual optimization method, and this method corresponds 
to a case where internal energy trading is not allowed. The last one is the whole optimization 
method. 

2. Distributed Energy Management Systems 

2.1 Introduction 

A software system in the control center in a power grid to control and optimize the perfor- 
mance of the generation and /or transmission system is known as an energy management 
system (EMS). This chapter addresses an operations planning problem of an EMS in indepen- 
dent corporate entities. Each of them demands electricity and heat energies, and he knows 
their expected demand curves. Moreover a cap on CO2 emissions is imposed on each en- 
tity, and it is not allowed to exhaust CO2 more than their caps. Some (or all) entities are 
equipped with energy conversion devices such as turbines; they perform optimal planning of 
purchasing primal energy and operating energy conversion devices in order to satisfy energy 
demands and constraints on CO2 emissions. 



Distributed Energy Management Using the Market-Oriented Programming 19 



We suppose a small district, referred to be a " group", that composed of independent plural 
corporate entities, referred to be "agents", and in the group trading of electricity and heat 
energies among agents is allowed. In the case of co-generation systems, demands should be 
balanced between electricity and heat in order to operate efficiently Even when demands 
from himself are not balanced, if an agent was possible to sell surplus energy in the group, 
efficiency of the co-generation system might be increased. Normally conversion devices have 
non-linear characteristics; its efficiency depends on the operating point. By selling energy to 
other entities, one may have an opportunity to operate its devices at a more efficient point. 
There is a merit for consumers that they are possible to obtain energies at a low price. 
It is possible to consider the whole group to be one agent, and to perform optimization by a 
centralized method, referred to be a "whole optimization". The whole optimization comes up 
with a solution which gives the lower bound of group cost; since each agent is independent, 
there exists another problem that each agent accepts the solution by the whole optimization 
or not. 

The DEMS is a software (multi-agent) system that seeks optimal planning of purchasing pri- 
mal energy and operating energy conversion devices in order to satisfy energy demands and 
constraints on CO2 emissions by considering energy trading in the group. The cost for each 
agent is defined by the difference between the total cost of purchased energy and the income 
of sold energy; the cost of the group is defined by the sum of agent's costs. We are expecting 
that the group cost is minimized as a result of profit-seeking activities of agents. 
Generally, energy demands are time varying and cost arises at starting conversion devices up. 
Although the goal of our research is solving the UC problem and deciding the allocation of 
traded energies in DEMSs, the main topic of this chapter is to discuss how to find an optimal 
energy allocation. In order to make the problem simple, we consider the UC problem with 
only one time period and all of the energy conversion devices are active. 
In DEMSs, since a cap on CO2 emissions is imposed on each agent, it is necessary that a pro- 
ducer is able to impute his overly-emitted CO2 to consumers in energy trading. Therefore, 
we employ not only the unit price but also the CO2 emission basic unit for energy trading. 
The CO2 emission basic unit means the amount of CO2 emitted by energy consumption of 
one unit. Power companies and gas companies calculate CO2 emission basic unit of their 
selling energies in consideration of relative proportions of their own energy conversion de- 
vices or constituents of products, and companies have been made them public. Consumers 
are possible to calculate their CO2 emissions came from their purchased energy. Note that 
CO2 emission basic unit is considered just as one of attributes of a energy in DEMSs, and its 
value could be decided independent of relative proportions of energy conversion devices or 
constituents of products. 

In a group, agents are connected by electricity grids and heat pipelines; they are able to trans- 
mit energies via these facilities. The electricity grid connects each pair of agents, but the heat 
pipeline is laid among a subset of agents. We do not take capacities of electricity grids and 
heat pipelines into account; also no wheeling charge is considered. 



20 



Energy Management 



2.2 Example Group 



-H — -i- 

I Factory 1 I (Factory2 



I Building J 

l --tP- 



electricity 



► h eat 

► gas 

f J agent 

I I group 



Fig. 1. An example group 



BE a 



^/electrici 



BE 


I 






BG 






► 


...... 


BA 


►• 




1 l PH ? 


BH 














£>#Aeat 

sdemancL 



electricity 



"► heat 



■► gas 



Fig. 2. A building model 



Figure 1 depicts an example group that is a subject of this chapter. This group is composed 
of three agents: Factoryl, Factory2, and Building. The arrows indicate energy flows; two 
factories purchase electricity and gas from outside of the group and sell electricity and heat in 
the group, and Building purchases electricity, gas and heat from both of inside and outside of 
the group. 

Composition of each agent is shown in Fig. 2 and Fig. 3. BA is a boiler and GT is a gas-turbine. 
BE e and BE express electricity purchased from outside and inside of the group, respectively. 
BG expresses gas purchased from outside of the group; BH expresses heat purchased from 



Distributed Energy Management Using the Market-Oriented Programming 



21 




electricity ► heat ► gas 



Fig. 3. A factory model 



inside of the group. PH is the produced heat and PE is the generated electricity. DE,DH, and 
WH express electricity demand, heat demand, and waste heat, respectively. Building tries to 
meet his electricity demand by purchasing electricity from inside and outside of the group, 
and he tries to meet his heat demand by producing heat with his boiler and by purchasing 
heat in the group. Factories tries to meed his electricity demand by generating electricity with 
his gas-turbine and by purchasing electricity from outside of the group, and he tried to meet 
his heat demand by producing heat with his boiler and /or gas- turbine. 



3. Application of the Market-Oriented Programming into DEMSs 

3.1 Market-Oriented Programming 

The Market-Oriented Programming (MOP)(Wellman, 1993) is a method for constructing a 
virtual perfect competitive market on computers, computing a competitive equilibrium as 
a result of the interaction between agents involved in the market, and deriving the Pareto 
optimum allocation of goods. For formulation of the MOP, it is necessary to define (1) goods, 
(2) agents, and (3) agent's bidding strategies. 

A market is opened for each good, and the value (unit price) of a good is managed by the 
market. Each agent cannot control the value, and he makes bids by the quantity of goods in 
order to maximize his own profit under the presented values. Each market updates the value 
in compliance with market principles (Fig. 4). Namely, when the demand exceeds the supply, 
the market raises the unit price; when the supply exceeds the demand, the market lowers the 
unit price. The change of unit price is iterated until the demand is equal to the supply in all 
markets; the state is called an equilibrium. 



22 



Energy Management 



price iL 



equilibrium 
price 




supply curve 

oversupply 
update price lower 

i \ update price higher 
overdemand 



amount 



Fig. 4. Price updating in the market 



3.2 Formulation of Markets 

For the formulation of MOP, we define (1) goods (2) agents, and (3) agent's bidding strategies 
as follows: 

(1) goods 

Electricity and heat traded in the group are goods. 

(2) agents 

A corporate entity in the group is an agent, and an agent that has energy converters 
such as turbines can become a producer or a consumer, but it cannot be a producer and 
a consumer at the same time. 

(3) agent's bidding strategies 

Bidding strategies will be described in Section 3.3. 

3.3 Bidding Strategies 

Let V = {pi, • • • , p n } be a set of agents. The set 8 of electricity energies is defined as follows: 



£ = {E ij \p i ,p j £V}U{E ei \p i eV}, 



(1) 



where Ejj denotes electricity supplied from agent pi to agent pj, and E ei denotes electricity 

that agent pi purchased from outside of the group. The electricity Eu is a pair («£,.., jSf,..); #£.. 

is the unit price, and /$£.. is the CO2 emissions basic unit of Ejj. The electricity E e j is also a pair 

(#£ e ., f$E ei )- There exists only one kind of electricity in outside of the group, i.e. \/i,j, oc-£ ei = &E e - 

andp Eet = p Eej . 

The set of heat energies is represented by % = {Hjj}, (i,j = 1, • • • , n, i ^ j), where Hjj denots 

heat that is supplied from agent pi to agent pj. Also the heat Hjj is a pair (och v , Phi)) ^h,- i s 

the unit price, and j6#.. is the CO2 emissions basic unit. 

/C = {K W i}, (i = 1, • • • ,ri) represents the set of other energies, such as gas, that are supplied 

to agent pi from outside of the group. K w { is a pair (ock w{/ ^K wi )) &K wi is the unit price, and [$k w . 

is the CO2 emissions basic unit. 



BHj 


= Y^R(Hji), and 


SH { 


= L R ( H ij)- 



Distributed Energy Management Using the Market-Oriented Programming 23 

The amount of traded electricity E £ 8 is expressed by a map Q : 8 —¥ IR + , where IR + is 
the set of non-negative real numbers. Here the following equations must hold for purchased 
electricity BEj and sold electricity SEj of agent pf. 

BE { = £ Q(E/i), and (2) 

SE { = £ Q(%)- (3) 

The amount of traded heat H e 7i is expressed by a map R : 1~L ^ IR + . The following 
equations must hold for purchased heat BHj and sold heat SHj of agent pf 

(4) 
(5) 

BK^i, DE Z -, DH if and WH Z - express the amount of purchased energy K wi , the demand, the head, 

and the waste heat of agent pi, respectively 

The cost Ji of agent pi is calculated by the following equation: 

Ji = E «E ii -Q(Eji) + L«H ji -R(Hji)+ E "K^-BKri 
tfivj=e fri K u ,,eK 

-£,*fy-Q(E i j)-'E*fy-R(H ij ). (6) 

The CO2 emissions CO2, of agent p, is calculated by the following equation: 

C0 2i = E PEt-Q(Eji) + Efa p -R(Hji)+ E pK mi -BK ai 

-Efe;-Q(%)-Efe r R(H«/)- (7) 

Let iC; be the cap on CO2 emissions for agent p,. Then the following equation must hold. 

C0 2i < Ki (8) 

Let Uf = [u\, • • • , Um) be the set of energy conversion devices of agent pf. Each device has 
input-output characteristic function: 

where IE k is the amount of input electricity, IH k is the amount of input heat, IK wik is the 
amount of input energy K w i, OE k is the amount of output electricity, and OH k is the amount 
of output heat for device u^. The form of a characteristic function depends on the conversion 
device; in the case of gas boiler it could be expressed by the following function: 

OH k = p{IK wik ) h + d f (10) 

where p, b, and d are parameters. For adding constraints on output range, inequality can be 
used: 

OH K < OH k < OlT k , (11) 



24 



Energy Management 



where OH^ and OH k are the minimum output and the maximum output, respectively. 
The following energy balance equations for each energy must hold in each agent. 



BE { + £ OE k 

k=l 
m 
BH { + £ OH k 
k=l 

VKjui e K : BK wi 



DEi + SE { + £ IE k 
k=i 

m 
DH f + SH f + WH Z - + ^ IH k 

k=i 
m 

J^ I K wik 
k=i 



(12) 
(13) 
(14) 



Agent pi will decide his bids for the markets by solving the following minimization problem. 

min Ji (15) 

s.t. (8), (12), (13), (14) 
Vw fc e U t : Y k 

Each agent finds the amount of purchased /sold energies and input energies for his conversion 

devices that minimize his own cost under the constraints of energy balance, the cap on CO2 

emissions, characteristics of devices. 

Bidding strategies of agents introduced in Section 2.2 could be expressed as follows. 

Building 



min oc BEe BE e +0c BE BE+0c BG BG-\-0c BH BH 

s.t. PH = p BA BG b ™ - d BA 

BE e + BE = DE 
BH + PH = DH 
^BE e SE e +^BES£+^ BG BG+^BHSH<i<C Building 



(16) 
(17) 
(18) 
(19) 
(20) 



Factory 



min u BEe BE e + a. BG BG - ot. SE SE - <x SH SH 


(21) 


s.t. PE GT = PgTe (BG GT ) bGT E - d GTE 


(22) 


PH GT = p G T H {BG GT ) bcT H -d GTf{ 


(23) 


PH BA = PBA(BG BA ) b ™ - d BA 


(24) 


BE e + PE GT = DE + SE 


(25) 


PH GT + PH BA = DH + SH+WH 


(26) 


BG = BG G j + BG BA 


(27) 


PBE e BE e + f5 BG BG — f5sESE — fisHSH< KF ac toriy 


(28) 



Distributed Energy Management Using the Market-Oriented Programming 



25 



3.4 Demand-Supply Curves 

It is know that one of necessary conditions for the convergence of the MOP is convexity of the 
production possibility set(Wellman, 1993). The characteristic function of energy conversion 
devices is important of the convexity For example, when the function is given by Equa- 
tion (10), the parameter b must hold that b < 1. A typical example of demand-supply curves 
in DEMSs is shown in Fig. 5. There exist two characteristics in DEMSs. 



price 



a 



equilibrium 
price 




supply curve 



a -/— 



o 



amount 



Fig. 5. Demand-supply curves in DEMSs 



The first characteristic is that the demand (resp. supply) curve has a gap in the amount be- 
tween and some positive value at the price oc (resp. a). This is caused by that agents tries to 
maximize their economic profits. Namely, oc and oc are marginal prices so that agents are able 
to make a profit. It is profitable for a consumer to purchase the energy in the group when the 
price is lower than oc, then he will bid a positive value. If the price is higher than oc, it is prof- 
itable to purchase the energy from outside of the group, then his bid will become 0. Similarly, 
a producer will not supply energy in the group when the price is lower than ex. 
The second characteristic is that there exists a upper limit of the amount for both of the de- 
mand and the supply curves. The upper limit for the demand curve comes from the energy 
demand of consumers, and the upper limit for the supply curve comes from capacities of 
energy conversion devices. 



3.5 Execution Procedure 

Due to the characteristics described in Section 3.4, a case may happen that no crossing exists, 
therefore a simple MOP procedure does not converge to the equilibrium. 
There exist two types for such a situation. 

1. Over-demand at oc (Fig. 6) 

When producers are not able to supply enough energy to meet the demand of consumer 
agents, the demand exceeds the supply even at (just below of) ~cc. At the next turn, the 
price becomes a little bit higher than oc, then the demand becomes 0. Therefore vibration 
of price may appear. 



26 



Energy Management 



price il 




supply curve 



amount 



Fig. 6. Over-demand at oc 



In this case, the supplied energy is shared among consumer agents and the shortage 
must be managed by other methods. By introducing a cap on the demand in the MOP 
procedure, we realize that. 

2. Over-supply at oc (Fig. 7) 

When suppliers produce an ample of energy, the amount of the supply may exceeds the 

demands at (just above of) oc. At the next turn, the price becomes a little bit lower than 

ex, then the supply becomes 0. Also in this case, vibration of price may appear. 

This kind of situation may occur when a supplier hold a co-generation system and his 

heat demand is not much. He operate the co-generation system in order to meet the 

electricity demand. But at the same time, plenty of heat will also produced. He may sell 

the heat even if the price is 0, but may not sell when the price becomes negative. 

In this case, the energy demand is shared among producer agents and the rest is 

dumped. By introducing a cap on the supply in the MOP procedure, we realize that. 

The idea described above 1. and 2. is realized by the following procedure, see Fig. 8. In the 

following the consumer is denoted by p C on, and the set of producers is denoted by S. 

At Stepl, one market is established for each energy and for each consumer. The initial value 

is a pair (ocq, j6q), where ocq is the initial unit price and /3q is the initial CO2 emissions basic unit. 

In each market, d = 00, and Sp { = 00 for each pi e S. 

At Step2, the market presents 3-tuple {oc,fi,d) to the consumer, and (oc,fi,s Vi ) to producer 

Pi £ S, where, oc is the unit price, /3 is the CO2 emissions basic unit, d is the upper bound of 

the demand, and Sp. is the upper bound of the supply. 

At Step3, the consumer and the producer decide the amount of the demand and the supply 

based on the condition that the market presents, respectively. The bidding strategy described 

in Section 3.3 is used for the decision. 

At Step4, the market updates the price or the upper bound according to the supply and the 

demand. The bid amount by the consumer is denoted by bidp con , and the bid amount by the 



Distributed Energy Management Using the Market-Oriented Programming 



27 



price l 




supply curve 



amount 



Fig. 7. Over-supply at oc 



producer pi is denoted by bid Pi . At Case 2.3 and Case 3.3, the value of oc is updated according 
to the equality (29): 



oc := oc + j(bid Cl 



J^bid : 



supi 



(29) 



where 7 > is a parameter. The equality (29) raises the unit price when over-demand, and 

lowers it when over-supply 

Steps from 2 to 4 are repeated until the condition of Step4-Case 1 holds in all markets. 

4. Computational Experiments 

4.1 Energy Trading Decision Methods 

This section introduces other energy allocation methods briefly. 

4.1.1 Individual Optimization 

Under the individual optimization method, each agent purchases energy only from outside 
of the group, and optimizes its running plan of conversion devices. By using this method, we 
can calculate group cost and cost for each agent under a condition that internal energy trading 
is not used. 



4.1.2 Whole Optimization 

The whole optimization method considers the group as one agent, and does optimization for 
the whole group. In this case the cap on emissions is imposed on the whole group. We can 
calculate lower bound cost for the group by using this method. This lower bound is optimal, 
and we cannot get better plan than that. With this method, we can get an energy purchase 
and running plan of devices, but we cannot get cost and CO2 emission for each agent. 



28 Energy Management 

Step 1 Establish Markets 
Step 2 Present Conditions 
Step 3 Bid 
Step 4 Update Condition 

Case 1 bid Pcon = Z p . eS bid pi 

If this condition holds in all markets, the MOP procedure finishes. 
Case 2 bid pcon < Z p . eS bid p! 
Case 2.1 d < Y. p . e< sbid pi 
The market raises d. 
Case 2.2 d > Y. p . e< sbid pi A oc < oc 

The market lowers s pi for each pi e S. The value of s pi is de- 
cided in proportion to bid pi and under the constraint of an equality 
^esty = bid pcon . 
Case 2.3 d > Y. p . e< sbid pi A oc > oc 
The market lowers oc. 
Case 3 bid com > H p . e ^bid pi 

Case 3.1 bid pcon > ^ p . eS s pi 

The market raises s pi for each pi e S. 
Case 3.2 bid Pcon < ^ Pi ^s s Vi A a: > a 7 

The market lowers d. The value of d is E^.^^s^.. 
Case 3.3 fo'd Pc0M < Z p . eS s pi A a: < oc 
The market raises a:. 
The MOP procedure goes back to Step2. 
Fig. 8. Execution procedure 



4.1.3 Multi-attribute and Multi-item Auction 

Miyamoto et al. (2007) proposed an energy trading decision method based on English auction 
protocol(David et al., 2002). This method is a multi-attribute auction because it uses two 
attributes: unit price and CO2 emission basic unit. Also it is a multi-item auction because 
energy demands could be divided into several demands with small energy amount. 
This method expresses energy value by 

v = \oc + ]if>, (30) 

where oc is unit price, /3 is CO2 emission basic unit, and A and ]i are parameters. A consumer 
shows three items: amount of energy demand, A and ]i. Producers bid three items: their 
amount of energy supply, oc, and /3. After some iterations, winning producers get rights to 
supply. 

When an agent holds a conversion device, such as a gas turbine, that is able to produce more 
than one types of energy, electricity trading and heat trading are inseparable for the agent. 
Therefore, in (Miyamoto et al., 2007) we adopted a sequential method; we decide electricity 
trading first and then decide heat trading. 

4.2 Configuration 

In the following experiments, we used parameters shown in Tables 1 and 2. 



Distributed Energy Management Using the Market-Oriented Programming 



29 



^BE e [y en AWh] 

/3 BEe [kg-C0 2 /kWh] 

&BG [yen/m 3 ] 

i 6 BG [kg-CQ 2 /m 3 ] 



10.39 
0.317 
28.6 
1.991 



Table 1. Unit price and CO2 emission basic unit of electricity and gas from outside of the 
group 





Building 


Factory 1 


Factory 2 


Vba 


35.03 


37.22 


37.02 


*ba 


0.85 


0.85 


0.85 


d BA 


5000 


8000 


8000 


PH BA 


10000 


10000 


5000 


Pgt e 


- 


17.91 


16.32 


b GT E 


- 


0.85 


0.85 


d GT E 


- 


6000 


6200 


PE GT 


- 


50000 


30000 


Pgt h 


- 


31.84 


25.87 


b GT H 


- 


0.85 


0.85 


d GT H 


- 


2200 


2200 



Table 2. Parameters of energy conversion devices 



Table 1 shows unit price and CO2 emission basic unit of electricity and gas purchased from 

outside of the group. These values are taken from Web pages of power and gas company in 

Japan. 

Table 2 shows parameters of conversion devices, where PH^a is the maximum output heat of 

the boiler, and PEq T is the maximum output electricity of the gas-turbine. 

4.3 Ex1 : Evaluation of Concurrent Evolution 

This experiment is done in order to evaluate the concurrent evolution of electricity and heat 
trading. Table 3 shows energy demands and the cap on CO2 emissions for each agent. 



Building 



Factory 1 



Factory 2 



DE[kWh] 
DH[Mcal] 
£[kg-CQ 2 ] 



12000 
10000 
7500 



40000 
30000 
20000 



20000 
15000 
15000 



Table 3. Exl: energy demands and caps on emissions 



Experimental results are shown in Tables 4, 5, 6, and 7. 

By the auction method (Table 5), the producer agent assumes that amount of heat trade is zero 
when the agent calculate a bid for electricity auction. The agent cannot allow for emissions 
reduction through heat trading, and electricity sales of Factory 2 resulted in only 4748.1 [kWh]. 
The agent cannot produce further electricity due to the caps. 



30 



Energy Management 





Factory 1 


Factory 2 


Building 


total 


BEJkWh] 


51.4 


0.0 


2000.0 


2051.4 


BG[m 3 ] 


10802.9 


9195.3 


342.5 


20340.7 


BE[kWh] 


- 


- 


10000.0 


10000.0 


BH[Mcal] 


- 


- 


10000.0 


10000.0 


SE[kWh] 


0.0 


10000.0 


- 


10000.0 


SH[Mcal] 


6747.2 


3252.8 


- 


10000.0 


C0 2 [kg-C0 2 ] 


20000.0 


14402.7 


6745.9 


41148.6 


cost[yen] 


309497.0 


159258.5 


134302.6 


603058.1 



Table 4. Exl: energy allocation by the MOP method 





Factory 1 


Factory 2 


Building 


total 


BEJkWh] 


2303.3 


1840.5 


6704.6 


10848.4 


BG[m 3 ] 


10357.1 


7240.9 


342.5 


17940.5 


BE[kWh] 


- 


- 


5295.4 


5295.4 


BH[Mcal] 


- 


- 


10000.0 


10000.0 


SE[kWh] 


547.3 


4748.1 


- 


5295.4 


SH[Mcal] 


9999.0 


1.0 


- 


10000.0 


C0 2 [kg-C0 2 ] 


20000.0 


15000.0 


4158.4 


39158.4 


cost[yen] 


320144.3 


184830.9 


120837.9 


625813.1 



Table 5. Exl: energy allocation by the auction method 





Factory 1 


Factory 2 


Building 


total 


BEJkWh] 


0.0 


0.0 


0.0 


0.0 


BG[m 3 ] 


13152.0 


7331.0 


342.5 


20825.5 


BE[kWh] 


- 


- 


12000.0 


12000.0 


BH[Mcal] 


- 


- 


10000.0 


10000.0 


SE[kWh] 


8760.0 


3240.0 


- 


12000.0 


SHpVIcal] 


10000.0 


0.0 


- 


10000.0 


C0 2 [kg-C0 2 ] 


- 


- 


- 


41463.6 


cost[yen] 


- 


- 


- 


595609.3 



Table 6. Exl: energy allocaiton by the whole optimization method 



On the other hand, Factory 2 succeeded to sell electricity of 10000[kWh] by the MOP method 
(Table 4), because the agent could take emissions reduction through heat trading into con- 
sideration. This trade could not be achieved through sequential method such as the auction 
method. The MOP method succeeded to obtain better solution by deciding electricity and 
heat trade concurrently. 

The whole optimization method worked out an optimal solution (Table 6), and Factory 1 
which has the most efficient gas turbine produced most electricity and heat for Building. As a 
result, the group does not buy any electricity from the outside. As for group costs, we can say 
that group cost by the MOP method is not so different from cost by the whole optimization. 
Note that this method cannot decide the cost and C0 2 emissions for each agent. 



Distributed Energy Management Using the Market-Oriented Programming 



31 





Factory 1 


Factory 2 


Building 


total 


BEJkWh] 


7780.0 


0.0 


12000.0 


19780.0 


BG[m 3 ] 


8806.0 


6463.0 


1247.0 


16516.0 


BE[kWh] 


- 


- 


0.0 


0.0 


BH[Mcal] 


- 


- 


0.0 


0.0 


SE[kWh] 


0.0 


0.0 


- 


0.0 


SH[Mcal] 


0.0 


0.0 


- 


0.0 


C0 2 [kg-C0 2 ] 


19999.0 


12867.8 


6286.8 


39153.6 


cost[yen] 


332685.8 


184841.8 


160344.2 


677871.8 



Table 7. Exl: energy allocation by the individual optimization method 

The resulting plan by the individual optimization was expensive because internal energy trad- 
ing was not used. The result (Table 7) shows effectiveness of the internal energy trading. 

4.4 Ex2: Evaluation for Consumer's Demand Change 

This experiment is done in order to evaluate efficiency of the methods under a change of con- 
sumer's demands. Energy demands and caps on CO2 emissions for each agent are shown in 
Table 8. We fixed electricity demand and increased head demand by 10000 [Meal] of Building 
who is a consumer in the group. In this case, factories begin to start their boiler as electricity 
demand increases. In order to exclude influences of emissions constraints, the cap on emis- 
sions for Building was set enough large as 35000 [kg-CC^]. 



Building 



Factory 1 



Factory 2 



DE[kWh] 
DH[Mcal] 
£[kg-CQ 2 ] 



12000 

10000-110000 

35000 



40000 
30000 
30000 



20000 
15000 
20000 



Table 8. Ex2: energy demands and caps on emissions 



4.4.1 Comparison on Group Cost 

Figure 9 shows transitions of group costs by each method when heat demand of Building 

changes. 

Costs by all methods except the individual optimization are constant until 90000 [Meal]. This 

is because heat was over produced in order to produce electricity and internal trading of heat 

does not effect the group costs. When heat demand exceeds 100000 [Meal], agents have to start 

their boiler to meet the heat demand, and then the group costs increases. 

In comparison to the individual optimization, which does not use internal trading, other three 

methods succeeded to reduce the group costs. This result shows that it is possible to reduce a 

group cost by introducing internal energy trading. For every heat demands, the MOP method 

obtains near optimal solutions, and they were better than the solutions by the auction method. 

This is an effect of the concurrent evolution. 



4.4.2 Comparison on Agent Costs 

Figure 10 shows transitions of CO2 emissions for each agent by the MOP method, and Fig. 11 
shows transitions by the auction method. 



32 



Energy Management 



75 



70 



o 

^ 65 

x 



60 



55 



group cost 



MOP^ 
auction — x- 
whole optimization -a... 
individual optimization e 




heat demand of building[x10 4 Mcal] 



Fig. 9. Ex2: transition of group cost 



10 



12 







CO2 emissions of each agent in MOP 


3 










.X 






Factory 1^^ 


o 




Factory2— x— 


O 2.5 




Building ■■■*■■ 


D) 






.*: 






o 




.♦** 


i— 






x 2 




^^^^ .-^'* 


w 






c 
o 




^^^ ..*" 


w 






w 






F 1b 




,/\ 


CD 




x** ^^^ 


o 


X-. 


"***-.. .•*'' ^v. 


o 






1 




*--X-... ^ h 


n r 


X** 


""■" x - * X 



2 4 6 8 10 

heat demand of Building[x10 4 Mcal] 
Fig. 10. Ex2: transition of CO2 emissions by the MOP method 



12 



As depicted in Fig. 10, by the MOP method emissions by Building increases linearly, and 
emissions of Factories 1 and 2 decease as heat demand increases. In this experiment, since 
CO2 emission basic unit of heat is fixed as a positive value 1 , emissions by consumers increases 
as heat demand increases, and producers can reduce their emissions by shifting emissions to 
the consumer. 



1 Actually the value is the same with a basic unit calculated by assuming that Building use its own boiler. 



Distributed Energy Management Using the Market-Oriented Programming 



33 



o 
o 



E 

CD 

<M 

o 
o 



2.5 



2 2 



1.5 



0.5 



CO2 emissions of each agent in auction 



Facto ry1 — ^ 
Facto ry2— x~ 
Building ■■■*■■ 






m ~yA ^iy ^ \iy nja \L£ ys .siz m/. . 



4 6 8 10 

heat demand of Building[x l0 4 Mcal] 
Fig. 11. Ex2: transition of CO2 emissions by the auction method 



12 



On the other hand, as depicted in Fig. 11, by the auction method emissions by each agent 
were constant. In the auction method, producers can decide CO2 emission basic unit for their 
bid. In this experiment, since caps on emissions for each agent was large enough, producers 
chose zero as CO2 emission basic unit for their bids in order to reduce costs. As a result, CO2 
emissions by Factory 1 and 2 stayed at high level, and emissions by Building stayed at low 
level. 

The MOP method at this point does not include a mechanism to change a value of CO2 emis- 
sion basic unit dynamically. This may cause a situation that results by the MOP becomes 
worse than the auction method when a cap on emissions for a producer is small. In order 
to confirm this prospect, the next experiment is done by changing caps on emissions for a 
producer. 

4.5 Ex3: Evaluation on Caps on Emissions Change 



DE[kWh] 
DH[Mcal] 
£[kg-CQ 2 ] 



Building 



12000 
10000 
7500 



Factory 1 



40000 
30000 
20000 



Factory 2 



20000 

15000 

11000-20000 



Table 9. Ex3: energy demands and caps on emissions 



Energy demands and caps on CO2 emissions for each agent are shown in Table 9. We fixed 
the cap on CO2 emissions for Factory 1 as 20000[kg-CO2], an d changed the cap for Factory 2. 



34 



Energy Management 



4.5.1 Comparison on Group Cost 



CD 
>> 

£> 66 



to 64 
o 



group cost 



1,_ 

'""s..„. 






MOP 
auction 
whole optimization 
individual optimization 


■■■*■■■ 

B 


*♦. Nil 


****** 






" 


**^.. 




~ X '- 




- 


- 


'''% 






X 







- 









1.1 1.2 1.3 1.4 1.5 1.6 1.7 1S 1.9 

maximum of CO2 emissions of Factory2[ x 1 4 kg-CO2] 
Fig. 12. Ex3: transition of group cost 



1.2 



^ 0.8 

o 

>< 0.6 



o 

g 0.4 



electricity trading amount 



- 






1 1 1 —} 




S MOP -h— _ 
/ auction — x— 






X'* 




v x % 


N/ 




- 



0.2 



1.1 12 1.3 1.4 15 1.6 1.7 1.8 19 

maximum of CO2 emissions of Factory2[x10 4 kg-CO2] 
Fig. 13. Ex3: transitions of electricity trade of Factory2 



Figure 12 shows transitions of group costs by each method when the cap on emissions for 
Factory 2 changes. 



Distributed Energy Management Using the Market-Oriented Programming 



35 



As depicted in Fig. 12, group costs by the MOP method are lower than the costs by the auction 
method when the caps on emissions for Factory 2 is larger than or equals to 12000 [kg-CC>2]. 
The group cost by the auction method, however, becomes low when the cap is 11000[kg-CC>2]. 
Figure 13 shows transitions of electricity trade of Factory 2 by the MOP and the auction meth- 
ods. When the cap was 11000[kg-CO2], electricity was not traded internally by the MOP 
method, but was traded by the auction method. Since the MOP method at this point does 
not include a mechanism to change a value of CO2 emission basic unit dynamically, Fac- 
tory 2 chose zero as its supply for electricity market when the cap was less than or equals to 
12000[kg-CO 2 ]. 

In the auction method, producers can decide CO2 emission basic unit for their bid. Table 10 
show combinations of unit price and CO2 emission basic unit of bids by Factory 2. The table 
shows that Factory 2 selected a scheme to reduce emissions by setting unit price as zero and 
emission basic unit as a positive value when the cap was less than or equals to 12000 [kg-C02]. 
As a result, the auction method succeeded to trade electricity internally for every cases. 





Factory 1 


Factory 2 


^Factory! 


oc 


P 


oc 


P 


20000 





0.9577 


8.7153 





15000 





0.9577 


8.7153 





13000 





0.9577 


8.7153 





12000 





0.9577 





1.1149 


11000 





0.9577 





0.9577 



Table 10. Ex3: change of unit price and CO2 emission basic unit 

As described above, we found that the MOP method at this point may lose an opportunity to 
deal internally in same special cases such as the cap on emissions for a producer is small. 

4.6 Ex4: Evaluation on CO2 Emissions Reduction 

This experiment is done in order to evaluate possibility of CO2 emissions reduction by the 
methods. Energy demands and caps on CO2 emissions for each agent are shown in Table 11. 





Building 


Factory 1 


Factory 2 


DE[kWh] 
DH[Mcal] 


12000 
10000 


40000 
30000 


20000 
15000 



Table 11. Ex4: energy demands and caps on emissions 



Table 12 shows caps on CO2 emissions for each agent, and CO2 emissions basic units which 
were used for the MOP method. At first, we calculated minimal CO2 emissions by using the 
individual optimization method for each agent. Values of this emissions were the caps at the 
first step, then the caps are decreased in the same rate r%. We evaluated whether each method 
is able to obtain a feasible solution. In case of the MOP method, we decreased also the CO2 
emissions basic unit in the same rate, so that Building meets the cap constraint. 



36 



Energy Management 



r[%] 


^Factoryl 


^Factory! 


^Building 


h 


Ph 





16999 


11000 


6286 


0.317 


0.226 


1 


16829 


10890 


6223 


0.313 


0.223 


2 


16659 


10780 


6161 


0.310 


0.221 


3 


16489 


10670 


6098 


0.307 


0.219 


4 


16319 


10560 


6035 


0.304 


0.216 


5 


16149 


10450 


5972 


0.301 


0.214 


6 


15979 


10340 


5909 


0.297 


0.212 


7 


15809 


10230 


5846 


0.294 


0.210 



Table 12. Ex4: caps on CO2 emissions and basic units 



r[%] 


MOP 


Auction 


Whole 


1 


- 


725400 


710533 


2 


- 


727623 


717715 


3 


- 


- 


725179 


4 


- 


- 


732999 


5 


- 


- 


741153 


6 


- 


- 


749876 


7 


- 


- 


- 



Table 13. Ex4: group costs when emissions basic units in Table 12 are used 



r[%] 


MOP 


Auction 


Whole 


1 


710927 


725400 


710533 


2 


718397 


727623 


717715 


3 


725862 


- 


725179 


4 


733687 


- 


732999 


5 


741854 


- 


741153 


6 


751673 


- 


749876 


7 


- 


- 


- 



Table 14. Ex4: group costs when fi E = 0.502, fi H = 0.020 



Group costs by each method when emissions basic units in Table 12 were used are shown in 

Table 13. The whole optimization method succeeded to reduce CO2 emissions of 6% from 

the individual optimization. This shows that by using internal energy trading it is possible to 

reduce CO2 of maximally 6% in this case. The auction method succeeded to reduce emissions 

in 2%, and the MOP method failed to reduce. 

In the case of this example, Factories have to operate their gas turbine further to produce 

electricity for internal trade, and then their emissions increases. On the other hand, since 

Factories have overly produced heat, internal trade of heat does not increase their emissions. 

Factories need to shift their emissions onto selling electricity. 

Therefore, we set CO2 emissions basic unit of electricity (resp. heat) as 0.502[kg-CO2/kWh] 

(resp. 0.020[kg-CO2/m 3 ]), and examined again. Results are shown in Table 14. In this case, 



Distributed Energy Management Using the Market-Oriented Programming 37 

the MOP method succeeded to reduce emissions in 6%, and the group cost was close to that of 
the optimal solution. The auction method is not able to reduce further since Factories cannot 
allow for heat trade. The result shows that the MOP method is effective also for CO2 emissions 
reduction. 

The above discussion suggests to develop CO2 emissions basic unit control mechanism in 
the MOP method. To do that, we have to develop the following two methods: 1) a method 
to sense a situation where basic unit should be adjusted, and 2) a method to adjust the ba- 
sic unit. Our resent research considers how to realize the CO2 emissions basic unit control 
mechanism(Sugimoto et al., 2008a;b). 

5. Conclusion 

This chapter considered energy management in a group which is composed of plural corpo- 
rate entities. Entities perform optimal planning of purchasing primal energy and operating 
energy conversion devices in order to satisfy energy demands. Moreover a cap on CO2 emis- 
sions is imposed on each entity, and it is not allowed to exhaust CO2 more than their caps. 
This chapter discussed effectiveness the energy trading in the group. 

In order to make the problem simple, we supposed the UC problem with only one time period 
and all of the energy conversion devices were active, and we discussed how to decide energy 
allocation among entities. So far, we had proposed an auction based method(Miyamoto et al., 
2007), but the method had a problem on efficiency. Therefore we proposed the MOP based 
method for deciding energy allocation. In order to decide energy allocation in DEMSs, we 
formulated the group, and showed the MOP based execution procedure. 
Next this chapter compared energy trading decision methods by computational experiments. 
The proposed MOP method succeeded to obtain better solutions than the previous auction 
method. We, however, found a necessity to develop CO2 emissions basic unit control mecha- 
nism in the MOP method. 

Directions of next research includes a) the CO2 emissions basic unit control mecha- 
nism(Sugimoto et al., 2008a), b) groups with plural consumers(Sugimoto et al., 2008b), and 
c) planning over plural periods. 

6. References 

Cormio, C, Dicorato, M., Minoia, A. & Trovato, M. (2003). A regional energy planning 
methodology including renewable energy sources and environmental constraints, 
Renewable and Sustainable Energy Reviews Vol.7: 99-130. 

David, E., Schwartz, R. & Kraus, S. (2002). An english auction protocol for multi-attribute 
items, Lecture Notes in Computer Science Vol.2531: 52-68. 

Dicorato, M., Forte, G. & Trovato, M. (2008). Environmental-constrained energy plan- 
ning using energy-efficiency and distributed-generation facilities, Renewable Energy 
Vol.33: 1297-1313. 

Hiremath, R., Shikha, S. & Ravindranath, N. (2007). Decentralized energy planning; modeling 
and application - a review, Renewable and Sustainable Energy Reviews Vol.11: 729-752. 

Kaihara, T. (2001). Supply chain management with market economics, Intl. J. of PRODUCTION 
ECONOMICS Vol.73(No.l): 5-14. 

Kaihara, T. (2005). A study on resource allocation with buying behavior in b to b commerce, 
Elec. Eng. in JAPAN Vol.l53(No.l): 63-72. 



38 Energy Management 



Maiorano, A., Song, Y. & Trovato, M. (2003). Modelling and analysis of electricity markets, 
Operation of Market-oriented Power Systems, Springer, pp. 13-49. 

Miyamoto, T., Kitayama, T., Kumagai, S., Mori, K., Kitamura, S. & Sindo, S. (2007). An energy 
trading system with consideration of CO2 emissions, Electrical Engineering in Japan 
Vol.l62(No.4): 1513-1521. 

Nagata, T., Ohono, M., Kubokawa, J., Sasaki, H. & Fujita, H. (2002). A multi-agent approach 
to unit commitment problems, Proceedings of the IEEE Power Engineering Society Trans- 
mission and Distribution Conference, pp. 64-69. 

Padhy, N. P. (2004). Unit commitment - a bibliographical survey, IEEE Transactions on Power 
Systems Vol.19: 1196-1205. 

Sheble, G. B. & Fahd, G. N. (1994). Unit commitment literature synopsis, IEEE Transactions on 
Power Systems Vol.9: 128-135. 

Sugimoto, Y., Miyamoto, T., Kumagai, S., Mori, K., Kitamura, S. & Yamamoto, T. (2008a). Co2 
emission basic unit control mechanism in a distributed energy management system 
using the market oriented programming, Proceedings oflCSET 2008, pp. 583-588. 

Sugimoto, Y, Miyamoto, T., Kumagai, S., Mori, K., Kitamura, S. & Yamamoto, T. (2008b). 
An energy distribution decision method in distributed energy management systems 
with several agents, Proceedings of the 17th IFAC World Congress, pp. 664-669. 

Wellman, M. P. (1993). A market-oriented programming environment and its application to 
distributed multi-commodity flow problems, Journal of Artificial Intelligence Research 
Vol.1: 1-23. 



Efficient Energy Management to Prolong 
Lifetime of Wireless Sensor Network 

Hung-Chin Jang and Hon-Chung Lee 

National Chengchi University 
Taiwan, R.O.C. 



1. Introduction 

Since the batteries in a wireless sensor network are either hard to charged or replaced, how 
to efficiently utilize limited energy in a wireless sensor network has become an important 
issue. Those operations for a sensor to consume energy are target detection, data 
transmission and reception, data processing, etc. Among others data transmission consumes 
most of the energy, and it heavily depends on the transmission distance and the transmitted 
data amount. In the literature those methods have been devoted to energy saving problems 
can be categorized into shortening transmission distance (Heinzelman et al., 2000), reducing 
transmitted data amount (Klein, 1993), scheduling radio transceivers (Busse et al., 2006), 
scheduling sensing components (Huang & Tseng, 2003), adjusting transmission range 
(Wang, 2004), and adjusting detection range (Cardei et al., 2006). Our approach focuses on 
adjusting the detection range of each sensor in order to reduce the overlaps among detection 
ranges while keep the detection ability above a predefined threshold. If we can largely 
reduce the overlaps among detection ranges and effectively decrease the amount of 
duplicate data then we will be able to save energy more efficiently. Meguerdichian et al. 
(2001) exploited the coverage problem in wireless ad-hoc sensor networks in terms of 
Voronoi diagram and Delaunay triangulation. In this paper we propose a Voronoi dEtection 
Range Adjustment (VERA) method that utilizes distributed Voronoi diagram to delimit the 
responsible detection range of each sensor. Then we use Genetic Algorithm to optimize the 
most suitable detection range of each sensor. Simulations show that VERA outperforms 
Maximum Detection Range, K-covered (Huang & Tseng, 2003), and Greedy (Cardei et al., 
2006) methods in reducing the overlaps among detection ranges, minimizing energy 
consumption, and prolonging network lifetime. 

This paper is organized as follows. Section 2 has a detailed survey on the related work. 
Section 3 introduces a five-step framework of our proposed methodology, which includes 
position determination, detection range partition, grid structure establishment, detection 
power minimization, and detection power adjustment. Section 4 presents system 
simulations and results. Finally, section 5 offers brief concluding remarks. 



40 Energy Management 

2. Related work 

In a wireless sensor network, wireless transmission consists of three major operations: (1) 
convert data into radio waves, (2) amplify radio waves until reaching the receiving sensors, 
(3) receiving sensors receive data. The amount of energy consumed in each of the three 
operations is proportional to the transmitted data amount. Furthermore, the amount of 
energy consumed in operation (2) is inversely proportional to the square of the distance 
between two communicating sensors. Both of them imply energy consumption can be 
effectively reduced by shortening the transmission distance and reducing the transmitted 
data amount. 

Much research has been devoted to energy saving problem in the literature. Those 
approaches can be classified into shortening transmission distance, reducing transmitted 
data amount, scheduling radio transceivers, scheduling sensing components, adjusting 
transmission range and adjusting detection range. 

Heinzelman's work (Heinzelman et al., 2000) focuses on shortening the transmission 
distance in order to reduce energy consumption. Given that sensor A has data to be 
forwarded to sensor C, if there exists a sensor B such that [dist(A,C)] 2 > [dist(A,B)] 2 + 
[dist(B,C)] 2 then the original routing path "sensor A -> sensor C" will be changed to "sensor 
A -> sensor B -> sensor C". Klein's work (Klein, 1993) is based on data fusion. Klein assumed 
the data collected by those sensors within the same area should be quite similar 
(redundant). For example, the collected temperatures from sensors of the same area are 
about the same. Once all these similar data forwarded to a responding sensor, it fuses these 
data before forwarding to the next stop. This may thus mitigate energy consumption by 
reducing transmitted data amount. Data fusion usually works with clustering. Sensors in a 
clustering structure are classified into different clusters according to their locations. Each 
cluster has a cluster head that is responsible for collecting, fusing and forwarding data. Due 
to overloaded workload of cluster head, it usually consumes the most energy than the other 
cluster members. To prolong the lifetime of the whole sensor network, all cluster members 
should take turns to serve as the cluster head. Energy saving can also be achieved through 
scheduling. Sensor is made of different components, e.g., sensing component, processor, 
transceiver, memory and battery. Each component can be individually enabled to operation. 
Those components of a sensor that are not in operations can be turned off temporarily for 
the sake of energy saving. This can be realized through scheduling of radio transceivers and 
sensing components. Scheduling of radio transceivers means to turn the transceivers on 
(operating mode) and off (sleep mode). Those transceivers that are not responsible for 
transmitting and relaying data could be turned off while other components, like sensing 
components and processors, function normally. Busse et al. (2006) proposed a Topology and 
Energy Control Algorithm (TEC A). In TECA, each sensor in a cluster, after functioning for a 
while, has to determine whether it should turn off its transceiver or not. This decision is 
made according to the role it plays in the cluster. If a sensor serves as a cluster head or 
bridge (the one connecting nodes between two clusters) then it keeps, otherwise, turns it off. 
Even if a sensor moves to sleep mode, it still listens to the messages from the cluster. Once, a 
sensor is called to serve as a cluster head (or bridge), it resumes itself from sleep mode and 
turns on its transceiver. Sensing components can be scheduled in a similar way. A sensor 
turns off those sensing components that are not on duty. Such sensor can still transmit and 
forward data. Huang & Tseng (2003) proposed a K-covered method that is able to cover a 
sensor field in a 2D or 3D space with least number of sensors. With scheduling, it may come 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 41 

to another energy saving problem. Each component of a sensor may be turned on and off 
frequently. Restarting sensor components from sleep mode frequently may consume more 
energy than that saved by staying in sleep mode. Some researchers proposed adjusting the 
communication range of each sensor to just enough short distance. This adjustment is 
usually based on optimization. Wang (2004) proposed adjusting the transmission power of 
each sensor in order to reduce the communication range of each sensor and thus save much 
energy. His method should work under the precondition of no broken connections. 
Detection range adjustment is an alternative approach without extra power consumption 
due to restarting sensors. In the recent years active sensors, like microwave sensors, are able 
to proactively detect moving objects by using microwave, laser, ultrasonic, etc. This also 
makes energy saving possible by simply adjusting sensing power and detection range. 
Cardei et al. (2006) proposed a Greedy algorithm to solve target coverage problem by 
adjusting detection range. Area coverage problem means how to use limited sensors to 
cover the whole area, while target coverage problem considers only how to cover all targets 
in that area. Cardei et al., first, randomly deployed several targets in a sensing field, then 
generated set covers to fully cover those targets. Each set cover is formed by several sensors, 
and each sensor is allowed to join different set covers. All these set covers are then used to 
monitor all targets in turn. 

3. Methodology 

We assume that there are n sensors, Si, S2,...,S n , randomly deployed to cover a detection 
field, F. Each sensor is able to adjust its detection power, Ki, and connect to all those 
neighbours within its transmission range. The detection power corresponds to a detection 
range, D;. The detection ability of each sensor must be greater than a threshold, a (0<a<l). 
The aim of this research is to minimize the overlaps of detection ranges in order to minimize 
the total detection power, ZK» of the whole network. 

The proposed methodology can be divided into five steps. The first step is position 
determination, which is used to determine the position of each sensor. The second step is 
detection range partition, where each sensor uses Voronoi diagram algorithm to delimit its 
responsible detection range. The third step is grid structure establishment, where each grid 
point corresponding to an area is used to calculate the detection probability of that area. The 
fourth step is detection (sensing) power minimization, where we use Genetic Algorithm to 
minimize the total detection power of the whole network. The final step is detection 
(sensing) power adjustment. This adjustment is based on the results of detection power 
minimization. Fig. 1 shows the framework of the five-step methodology. 



42 



Energy Management 

















Network deployment 














1™ ~ 












y 






f " "* 






fc 


Position determination 




Yes 






















Grid structure establishment 




changed ?^^> 














A 




Detection range partition 






















Detection power minimization 






f 








Detection power adjustment 



















Fig. 1. Framework of the five-step methodology 

Before proposing the framework of five-step methodology, we introduce some useful 
formulae. 



3.1 Related formulae 

Free space loss of radio wave 



Free space loss = 20 log 



Ajtd 



a) 



Where X is the wavelength and d is the transmitted distance. Free space loss is the 
attenuation rate of a transmitted radio wave. 

Detection power, Ei, of sensor Si to a target 



?r = Pt + Gain -20 log 



Sad 

k 



(2) 



Where Ft is the emitted detection power of a sensor, Gain is antenna gain, d is the distance 
between sensor and target, and Pr is the radio power received by the sensor from a target. 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 43 

In a wireless sensor network, a detection process consists of a sensor transmitting a 
detection radio wave and receiving bounced back radio wave. A larger Pr indicates higher 
detection ability of a sensor to a target. In addition to Pr, the detection energy of sensor Si to 
a target also includes the thermal noise,M, generated by electronic component of sensor Si. 
Thus the total detection energy, E z , to a target is the sum of Pr and N z . 

E. = Pr+ N t (3) 

Detection probability, Pi(u), of a node at position u by sensor Si 

P. (u) = prob[E. (u)>fi] = prob[?r(u) + N t > ft] (4) 

Pi(u) is the detection probability that an event occurs at position u detected by sensor Si. (3 is 
a threshold used to determine whether an event is triggered. As the detected energy is 
larger than /?, a corresponding event is triggered. Otherwise, the detected energy is thought 
to be a thermal noise. 

Conjunctive detection probability 

P(u) = l-[Yl(l-J>&m ( 5 ) 

On the other hand, a position u might be covered by more than one detection range of 
different sensors. Let an event occur at a position, u, the probability that all sensors do not 
detect is ]~r n-p( u \\- Therefore, the conjunctive detection probability, P(u), of all sensors 

is i-[[](i-«]- 

With all the related formulae, we introduce each step of the proposed methodology in the 
following subsections. 

3.2 Position determination 

The first step is to determine the position of each sensor. If each sensor is equipped with a 
GPS, the system could have the absolute position of each sensor. However, this kind of 
sensors will be limited to being placed in an outdoor environment. Besides, it makes sensor 
bigger and consumes more energy. In the proposed method, we consider the position of 
each sensor in terms of relative position. These positions can be calculated by either one of 
AOA (Angle of Arrival), TDOA (Time Difference of Arrival) and RSSI (Received Signal 
Strength Indicator) methods. If each sensor knows only the relative positions between itself 
and its neighbours, it will not be able to compute the Voronoi diagram of the whole 
network. On the other hand, if all sensors send their positions to base stations, it will 
consume huge bandwidth and transmission energy. This problem will be solved by 
improving the Voronoi diagram in the following subsection. 

3.3 Detection range partition 

After position determination, each sensor will be able to know the relative positions of its 1- 
hop neighbours. The next step is to determine the responsible detection range of each 
sensor. Meguerdichian et al. (2001) exploited the coverage problem in wireless ad-hoc 
sensor networks in terms of Voronoi diagram and Delaunay triangulation. In this research, 



44 



Energy Management 



we employ Voronoi diagram to delimit the responsible detection range of each sensor. 
Voronoi diagram can be used to divide an area into sub-areas. In a Voronoi diagram, it 
holds the property that the nearest site of any point x in a sub-area V(Pi) must be P; (site). 



Definition : Voronoi diagram 

Let P = {Pi, P2,...,P n }, n 2, P is a set of nodes in an area, and Pi, P2, .-.,P n are sites. 

V(Pi)={x: Pi-x P r x, Vjti] 

V(P)={V(Pi),V(P 2 ), ,V(P n )} 

V(P) is called a Voronoi diagram. 



Fig. 2. shows the Voronoi diagram formed by three sites Pi, P2, P3. The nearest site of a random 
point x in the sub-region V(Pi) must be Pi. The same principle applies to both V(P2) and V(P3). 
Fig. 3 shows the sub-regions of random deployed sensors using Voronoi diagram. 



vr/y 




© 



© 



V(P :t ) 

Fig. 2. The Voronoi diagram formed by three sites {Pi, Pi, P3) 



-r-r-:i 



\y w / /. ; 



- / ' U. 

\ 



r^ 






Fig. 3. Sub-regions of random deployed sensors using Voronoi diagram 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 



45 



Next, we determine the responsible detection range of each sensor. Fig. 4 shows part of the 
Voronoi diagram formed by sensor A and its neighbours, where the quadrangle is the sub- 
region of sensor A. Fig. 5 shows the case when the responsible detection range covers the 
sub-region of sensor A. Fig. 6 shows another case when the detection range does not fully 
cover the sub-region of sensor A due to its limited sensing power. In such case the 
responsible detection range is equal to its maximum detection range. 




Fig. 4. Sub-regions formed by sensor A and its neighbours 




Fig. 5. The responsible detection range covers the sub-region of sensor A 




Fig. 6. The sub-region of sensor A is larger than its maximum detection range 



Besides, it can be proved that if the maximum transmission distance between two sensors is 
greater than twice the maximum detection range of each sensor then the responsible 



46 



Energy Management 



detection ranges of the two sensors do not overlap. Fig. 7 shows that sensor A and B are not 
neighbours to each other. Though their sub-regions are overlapped, their responsible 
detection ranges do not overlap. 




Fig. 7. The sub-regions of sensors A and B overlap, but their responsible detection ranges do 
not overlap 

3.4 Grid structure establishment 

To make sure that the detection ability of each sensor is greater than a predefined threshold, 
, we create a grid structure for detection field, F. In a grid structure, each grid point 
represents a target. In Fig. 8, the solid circles are sensors and each vertex of a square is a grid 
point. 























































I 












h 








1 


1 






















i 










/ 








\ 










/ 


\, 






r\ 






















t 


■ 


























^ 


* 












i 


> 


















/ 









Fig. 8. Grid structure of a target detection area 

Assume that there are m grid points in the responsible detection range of sensor Si. Let P(u) 
be the conjunctive detection probability, F be the threshold of detection probability of the 
grid point u. We define G; to be the set of those u whose P(u) is smaller than T, that is 



Gi={uu ESt, P(u) 



, We also define , _ Ifi- 1 to be the detection ability of sensor Si. 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 



47 



The greater ^ I fi I , the higher detection ability of sensor Si. In addition, we set another 

m 
threshold, a, for Si. While reducing the overlaps of detection ranges, the system should keep 
the detection ability above the threshold a. 

Fig. 9 shows the detection ability of sensor Si. There are 29 grid points spread in distinct 
locations. We assume the threshold of the detection ability, T, is 0.7. Since the detection 
abilities of the grid points A, B, C, D and E are less then 0.7, all these five points belong to set 
Gi. We can thus compute the detection ability of Si, ^ I fi- 1 , is 24/29. 











0.71 




/ 










\ 








A, 


0.55 


B 

].52 


0.74 


0.77 


C.74 


















/ D 


n.fi? 


177 


O.fl 


n.R 


o.a \ 
















c 


'°- 55 


0.74 


" S L 


0.9 


0.B5 


0.85 


0.85 


i 


t 












i 


0.74 


D.B 


0.35 


O.B 


0.8 










/ 








\ 


0,77 


J.74 


0.77 


0.74 


D.77 


\. 






2 
















0.62 






g 


i 




\ 








Threshold (0 = 0.7 
















% 


* 




Grid point (m) = 29 






















1- 


-|G,|/m = 24/29 


m 


r 



























Fig. 9. Detection ability of sensor S; 



3.5 Detection power minimization 

After establishing the grid structure, our goal is to minimize the detection power, Ky or 
equivalently the, Pt. We use a Genetic Algorithm (GA) to do the minimization. GAs are the 
methods used to find exact or approximate solutions to optimization and search problems. 
GAs are often used to solve those problems of high-complexity, like NP-problem, in limited 
time. Fig. 10 shows the operation flow of genetic algorithms. 
Chromosome encoding: encode species into chromosome string according to the attributes of the 

problem domain. Each chromosome string is thought of as a problem solution. 
Objective function: used to evaluate a chromosome string, determine the adaptation degree 

(fitness) of a chromosome string. In general, the higher adaptation degree of a 

chromosome string, the better solution. 
Selection: select highly evaluated chromosome strings as parents of offersprings. A highly 

evaluated chromosome string usually has higher probability being selected. 
Genetic operations: can be either Crossover or Mutation. Crossover is used to produce better 

chromosome strings (offsprings) by exchanging sub-strings of parents. Mutation 

is different from crossover in that it changes (e.g. 0— >1, 1— >0) very few codes of 

parents to escape from local optimum. Mutation occurs much less frequent than 

crossover does. 
Replacement: replace old chromosome strings (parents) by new chromosome strings 

(offsprings). 



48 



Energy Management 




Fig. 10. Operation flow of genetic algorithms. 

Chromosome encoding 

First, we encode the detection powers of sensors, Si, S2,...,S n , into a chromosome string, 
Ki,K2,.. -,K n . Then we generate a set of initial solutions (chromosome strings) as shown in Fig. 
11. 



Solution 1 


*i 


*2 


f<3 




*n 










*i 


*2 


K 3 




Kn 


Solution 2 








Solution 3 


Ki 


*2 


K 3 




*n 








Solution 4 


*i 


«2 


Ki 




Kn 





Fig. 11. Encoded chromosome strings 



Evaluation 

Chromosome string encoding is followed by evaluation. The system objective is to minimize 
the Total Detection Power (TDP). In addition, there are two constraints. One (7) is to 
constrain the detection power, Ki, the other (8) is to make sure the detection ability of the 
sensor is greater than a predefined threshold, a. 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 



49 



Objective function 



Min 



in ^K t 



(6) 



Constraints 



Max_K t Ki 

1-!Sl1>« 
m 



(7) 
(8) 





K : 


K 2 


K 3 




K n 






Solution 1 






















K : 


*2 


* 3 




K 






Solution 2 




— best 
















*i 


K* 


l<3 




K n 






Solution 3 




















K; 


*2 


K* 




Kr, 






Solution 4 






















*i 


K 2 


«i 




K 






Solution 5 




— better 
















K : 


K 2 


** 




K, 






Solution 6 




















K : 


K 2 


K 3 




K n 






Solution m-2 






















*i 


fj 


** 




K n 






Solution ml 




wurbl 
















K : 


K 2 


K 2 




K 






Solution m 









Evaluation results Selected probability 



high 



low 



Fig. 12. The relation between chromosome strings categories and selected probabilities. 

Selection 

In selection, we classify all chromosome strings into different categories. All those 
chromosome strings belonging to the same category have similar evaluations. The categories 
of higher evaluations will have higher probability being selected. Fig. 12 shows the relation 
between chromosome strings categories and selected probabilities. 

Crossover 

We design the crossover operation to be two-point crossover. We first randomly choose two 
positions in a chromosome strings. The offsprings are then produced by exchanging the sub- 
strings that lie between the two positions. Fig. 13 shows an example of two-point crossover. 



50 



Energy Management 



















Parent 1 


fj 


«2 


K 3 


<c 


Ks 


Ks 


*7 












Parent 2 


K'l 


K'? 


K' 3 


K\ 


K', 


5 


f? 



^^ Offspring 2 



! 



! 



>• Offspring 1 ff 2 £_, (f^ /f' 4 K' s K 6 Jf 7 

















K'j 


«J 


^ 


*4 


K 5 


K'o 


K' 7 



Position 1 Position 2 Position 1 Position 2 

Fig. 13. Example of two-point crossover 

Mutation 

In mutation, we random choose very few K/s (low probability) by increasing or decreasing 
their sensing power. Fig. 14 is an example of mutation. In this example, we random choose 
elements K.2, Ks, K4 from parent. K2 and K3 become l^'and K3 by increasing their sensing 
powers. On the contrary, K4bec0m.es K4 by decreasing its sensing power. 



Parent Kj K 2 K^ K 4 K 5 K 6 K 7 



Offspring K t fC 2 r 3 K' 4 K s K 6 K 7 



K\ 



[*7| r^i 



HS — ► 
t t t 

increase decrease 

Fig. 14. Example of mutation. 

Replacement 

As new offsprings are produced, those chromosome string with low evaluation results will 
be replaced by the new offsprings with high evaluation results. 



3.6 Detection power adjustment 

Eventually, the optimum will be reached after several iterations of Genetic Algorithm. Each 
sensor then sets the corresponding value in the optimal chromosome string as its detection 
power. All these values of detection power will be propagated to each of their neighbours 
through message exchanges. Each sensor will then adjust its detection power according to 
both the received values and the value computed by its own. At the end of this step, all the 
detection powers of sensors are determined. Afterwards the optimization process won't be 
triggered only if some sensors are damaged or the network topology is changed. 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 51 

3.7 Procedure 

The procedure of the proposed methodology is illustrated as follows. 



1. Sensor S exchanges messageswith its neighbours and computesthe relative positions of its 
neighbours. 

2. Use Voronoi diagram algorithm to calculate the responsible detection ranges ofS. 

3. Establishgrid structure (m grid points) ofS. 

4. Encode chromosome, with Length = n, Element = detection power K of sensor Si , 
| chromosome \ = X. 

5. for all chromosomesdo 

6. Evaluate function (chromosome) 

7. end for 

8. while Evolution is not finisheddo 

9. operation = random(Crossover | | Mutation) 

10. if operation == Crossover then 

11. select two chromosomes asparents according to the evaluation resultsof TDP 
randomly exchange some elements to produce offsprings 

12. else 

13. select a chromosome as parent according to the evaluation result of TDP 
randomly change some elements to produce offspring(max_Ki Ki 0) 

14. end if 

15. Evaluate function(off spring) 

16. if (the TDP of evaluation result of offspring is better than their parents) andDetection ability 
of offspring > athen 

17. replace parents by offsprings 

18. else 

19. replace parents by offsprings with lower probability and give up offspring's with higher 
probability 

20. end if 

21. end while 



Evaluate function(chromosome) 

1. for all grid point u of sensor S 

2. for all detection power Ki in the chromosome 


3. 


Gain %jvd 
Pr = K . + 20 log 

/ 5 A 


4. 


P l (u) = prob[?r+N i > p] 


5. 


end for 


6. 


p(u) = i-iyi(i-p i (um 


7. 


G = {u\u<ES i ,P(u)<T} 


8. 


end for 


9. 


Detection ability = 1 _ J L 


10. 


TDP=^ Ki 



52 



Energy Management 



4. Simulations and results 



Simulations are based on the following parameters setting: there are 30 to 100 sensors with the 
same capability randomly deployed in a detection field of 100x100 m 2 . The detection power of 
each sensor is adjustable, the maximum detection power is 15dBm, the detection range is 
between to 20 meters, the transmission range is 40 meters, the frequency of detection radio 
wave is 10325MHz, the sensitivity is -85dBm, the antenna gain is 8dBm, the threshold of 
detection ability (a) is 0.8. In performance comparisons, VERA method is further separated 
into VERAl (VERA with T = 0.7) and VERA2 (VERA with F* 0). VERA1 and VERA2 are 
compared with MDR (Maximum Detection Range), K-covered (K = 1), and Greedy algorithm 
by simulations. MDR is an algorithm simply used to maximize detection range without any 
enhancements on detection range adjustment. K-covered and Greedy algorithms are those 
proposed by (Huang & Tseng, 2003) and (Cardei et al., 2006), respectively. Five simulations are 
conducted to verify the performances against overlaps of detection ranges, duplicate data 
amount, total energy consumption, network lifetime and average detection probability. 





-MDR 

- VERM 
-VERA2 

- K-covered 
Greedy 



Number of sensors 



Fig. 15. Comparisons of the ratios of overlapped detection range 

Fig. 15 shows the comparisons of the ratios of overlapped detection range of the five 
methods. As the number of sensors is increased between 30 and 70, the ratios of overlaps of 
each method increase constantly. This is because when the number of sensors is smaller than 
70, there is no sufficient number of sensors to cover the whole detection field. As the 
number goes beyond 70, the ratios of overlaps of MDR approximate 1.0 because MDR does 
nothing to detection range adjustment. Whereas the ratios of VERAl and K-covered stay 
around 0.6, and those of VERA2 and Greedy stay around 0.5, respectively. 
In the second simulation, we define the proportion of duplicate data to be the ratio of the 
duplicate data amount to the number of detected events. Fig. 16 shows the comparisons of 
the portions of duplicate data amount of the five methods. It shows that the proportions of 
VERAl, VERA2 and Greedy are very close to one other. VERAl has larger duplicate data 
amount and larger number of detected events. Since there is no detection ability limit on 
VERA2 and Greedy, it results in smaller duplicate data amount and smaller number of 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 



53 



detected events. K-covered has higher portion of duplicate data due to having more 
overlaps and smaller number of detected events. 



Q 



1 


l l l ^^ 1 


K-covered 


MDR 

— VERM 

— VERA2 

— K-covered 
| Greedy 


^^ 


VERM 


1 1 1 1 


VERA2 - 


1 


, 



60 70 

Number of sensors 



Fig. 16. Comparisons of the portions of duplicate data amount 



Fig. 17 shows the comparisons of total energy consumptions of the five methods per round. 
Since MDR is unable to adjust detection range, the total energy consumption is increased as 
the number of sensors is increased. As the number of sensors is below 63, the total energy 
consumption of K-covered is less than that of Greedy since K-covered has less information 
exchange than that of Greedy, and K-covered has less data needs to be relayed to base 
stations. As the number of sensors is larger than 63, K-cover increases the number of data 
relays quickly resulting in more energy consumption. Since VERA1 and VERA2 have less 
information exchange than that of the others, and VERA2 uses less detection power than 
that of VERA1, therefore VERA2 has the best energy consumption performance. 




60 70 

Number of sensors 



Fig. 17. Comparisons of total energy consumption per round 



54 



Energy Management 



Fig. 18 shows the comparisons of network lifetime of VERA, K-covered and Greedy 
methods. At the time the sensor network is deployed at its early stage, there must have 
many sensors using very high detection powers to reach the borders of detection field. It 
shows that there are many sensors died at the end of the first 220 rounds. Comparing the 
number of rounds that the last sensor died, we have VERA2 (940 rounds) > Greedy (890 
rounds) > K-covered (880 rounds) > VERAI (700 rounds). Comparing the number of rounds 
that the last ten sensors survived, we have VERA2 (700 rounds) > Greedy (680 rounds) > K- 
covered (670 rounds) > VERAI (650 rounds). 



in 70 
.8, 

| m 

I 5°' 

•^• : y-4ti 

.;;-^': : :-3o_" - 

••.'.•''••;;..;i - 



; "• 



I 




ADRA1 
ADRA2 
K-covered 
Greedy 



Fig. 18. Comparisons of network lifetime 



Fig. 19 shows the comparisons of average detection probability of the detection field of the five 
methods. As the number of sensors is greater than 70, the average detection probability of 
VERAI is very close to 0.7. It is 10% higher than that of X-covered, VERA2 and Greedy. The 
average detection probability of MDR is almost 0.9 due to its maximum detection power. 















0.9 

0.8 

■S 0.7 

1 0.6 

§ °- 5 

-E 0.4 

1 0.3 
1 
0.2 

0.1 


3 








MDR 


1 






VER/s 




K- cove red 


I I I 


Greedy 




I I 






MDR 

VERM 

— VERA2 

— K-covered 
Greedy 




I 




40 50 


60 70 80 
Number of sensors 


90 1E 


30 



Fig. 19. Comparisons of average detection probability of the detection field 



Efficient Energy Management to Prolong Lifetime of Wireless Sensor Network 55 

5. Conclusions 

In this paper we introduced a framework of five-step methodology to carry out detection 
range adjustment in a wireless sensor network. These steps are position determination, 
detection range partition, grid structure establishment, detection power minimization, and 
detection power adjustment. We proposed a Voronoi dEtection Range Adjustment (VERA) 
method that utilizes distributed Voronoi diagram to delimit the responsible detection range 
of each sensor. All these adjustments are under the guarantee that the detection abilities of 
sensors are above a predefined threshold. We then use Genetic Algorithm to optimize the 
optimal detection range of each sensor. 

Simulations show that the proposed VERA outperforms Maximum Detection Range, K- 
covered and Greedy methods in terms of reducing the overlaps of detection range, 
minimizing the total energy consumption, and prolonging network lifetime, etc. 

6. References 

Busse, M.; Haenselmann, T. & Effelsberg, W. (2006). TECA: a topology and energy control 

algorithm for wireless sensor networks, Proceedings of the 9th ACM International 

Symposium on Modeling Analysis and Simulation of Wireless and Mobile Systems 

(MSWiM '06), Oct. 2006. 
Cardei, M., Wu, J. & Lu, M. (200 Improving Network Lifetime using Sensors with 

Adjustable Sensing Ranges, International Journal of Sensor Networks (IJSNet), Vol. 1, 

No.1/2, (2006) 41-49. 
Heinzelman, W.R.; Chandrakasan, A.; & Balakrishnan, H. (2000). Energy-efficient 

communication protocol for wireless microsensor networks, Proceedings of the 33rd 

International Conference on System Sciences (HICSS ] 00), Jan. 2000. 
Huang, C.-F. & Tseng, Y.-C. (2003). The coverage problem in a wireless sensor network, 

ACM Int'l Workshop on Wireless Sensor Networks and Applications (WSNA), 2003. 
Klein, L. (1993). Sensor and data fusion concepts and applications, In: SPIE Optical 

Engineering Press. 
Meguerdichian, S.; Koushanfar, F.; Potkonjak, M. & Srivastava, M. B. (2001). Coverage 

problems in wireless ad-hoc sensor networks, IEEE INFOCOM, pp. 1380-1387, 

2001. 
Wang, S.C.; Wei, D.S.L.; & Kuo, S.Y. (2004). SPT-based power-efficient topology control for 

wireless ad hoc networks, Proceedings of the 2004 Military Communications Conference 

(MILCOM<04), Oct. 2004. 



56 Energy Management 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology 

and Wireless Sensor Networks 

Hu Jingtao 

Key Laboratory of Industrial Informatics 
Shenyang Institute of Automation, Chinese Academy of Sciences 

China 



1. Introduction 

Induction motors are widely used in industry as essential driving machines. There are many 
motor driven systems in plants, such as pumping systems, compressed air systems, and fan 
systems, etc. These motor driven systems use over 70% of the total electric energy consumed 
by industry. Because of the oversized installation or under-loaded conditions, motors 
generally operate at low efficiency which results in wasted energy. To improve the motor 
energy usage in industry, motor energy management should be done. 

The motor energy management is based on the motor energy usage evaluation and 
condition monitoring. Over the years, many methods have been proposed. But these 
methods are too intrusive for in-service motor monitoring, because they need either 
expensive speed and/ or torque transducers, or an accurate motor equivalent circuit. Non- 
intrusive methods should be developed. 

Another problem comes from the communication network. Energy usage evaluation and 
condition monitoring systems in industrial plants are usually implemented with wired 
communication networks. Because of the high cost of installation and maintenance of these 
cables, it is desired to look for a low-cost, robust, and reliable communication network. 
This paper presents a motor energy management system based on non-intrusive monitoring 
technologies and wireless sensor networks. In the following sections, some key technologies 
for motor energy management are discussed. At first, a three-layer system architecture is 
proposed to build a motor energy management system. And an in-service motor condition 
monitoring system based on non-intrusive monitoring technologies and wireless sensor 
networks is presented. Then wireless sensor networks and its application in motor energy 
management are discussed. The design and implementation of a WSN node are presented. 
Thirdly, non-intrusive motor current signature analysis technology is introduced to make 
motor energy usage evaluation. Applying the efficiency estimation method introduced, a 
front-end device used to monitor motors is developed. At last, the motor monitoring and 
energy management system is deployed in a laboratory and some tests are made to verify 
the design. The system is also applied in a plant to monitor four pumping motors. 



58 



Energy Management 



2. In-Service Motor Monitoring and Energy Management System 

2.1 Motor Energy Management Architecture 

Motor energy management is a complicated program which embodies optimal design, 
operation, and maintenance of motor driven systems to use energy efficiently. The system 
optimization is based on the motor condition monitoring, energy usage evaluation, and energy 
saving analysis. Such work is so complex that before developing a motor energy management 
system, we need to construct a system architecture to guide the system development. 
This paper presents a three-layer system architecture which is composed of a data 
acquisition platform, a condition monitoring platform, an energy consumption and saving 
analysis platform, a communication platform, and a motor energy data management 
platform, as illustrated in Fig. 1. 



£L Efficient Motor Selection Energy Saving Analysis Life Cycle Cost Analysis 



s 

o 

© 

3' 

era 






Prognosis & Health Management 




State Estimation 


Online Monitoring 


Signal Processing 















Energy Management Database 


© 

pa 

pa 

s 

pa 
S3 
pa 

<W 

fP 

3 

re 

S3 


Health Management Database 


Motor Monitoring Database 


Motor Asset Database 









Data Acquisition Cards 



Current & Voltage Sensors 



Industrial Ethernet 



Wireless Sensor Networks 



Motor Driven System 



Fig. 1. Motor energy management architecture 



The need of data acquisition comes first to monitor the operation of a motor driven system. 
We need data acquisition cards to collect raw signals coming from sensors, such as current 
and voltage sensors, and transmit them to the monitoring system over a communication 
network. There are many ways to build a network, such as field bus, industrial Ethernet, 
and wireless sensor networks. The data acquisition and communication platforms form the 
base of a motor energy management system. 

Upon the data acquisition is the motor condition monitoring platform. Based on the digital 
signal processing (DSP) technologies, the operation conditions of motors are monitored, and 
the health state and the energy usage of motors are evaluated. Such functions need data 
management abilities. So some databases are created and maintained, including motor asset 
database, motor monitoring database, health management database, and energy 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



59 



management database, etc. The condition monitoring platform and data management 
platform form the main body of a motor energy management system. 

At the top level are some applications to make motor energy management. To replace the 
inefficient motors currently used, motor selection can be made based on the energy usage 
evaluation of the motors. Energy saving analysis and life cycle cost analysis can be done for 
the replacement. That's the energy consumption and saving analysis platform. 

2.2 In-Service Motor Monitoring System 

An in-service motor monitoring and energy management system was developed based on 
the architecture presented in section 2.1. The system has two subsystems: a data acquiring 
and analysis subsystem deployed at the motor control centre (MCC), and a condition 
monitoring and energy management subsystem running at a central supervisory station 
(CSS), as illustrated in Fig. 2. 




IPC 



Receiver 



Sensors 



DSP 



Transmitter 




Motor Controller 




CSS MCC Motor Driven System 

Fig. 2. In-service motor monitoring and energy management system 

The data acquiring and analysis subsystem consists of some front-end devices which are used 
to acquire data and analyze the motors conditions. One front-end device is composed of three 
parts: a sensor unit, a processing unit and a communication unit. 

The sensor unit is used to detect the line current and line voltage signals from the power 
supplied to a motor. Only the current and voltage sensors are used. Without any other sensors, 
the motor system is disturbed minimally. 

The processing unit based on digital signal processing technologies gathers and analyzes those 
signals to determine the condition of motors. Some signal processing and inferential models 
are used to evaluate the energy and health conditions of the motors, as illustrated in Fig. 3. 
The communication unit is used to send the results to the condition monitoring and energy 
management subsystem running at a central supervisory station, which gathers and stores 
the analysis results, evaluates the energy usage, and analyzes the energy savings. Here the 
communication is based on the wireless sensor networks. 

The condition monitoring and energy management subsystem has a friendly graphic user 
interface (GUI). The condition of a motor is monitored on the main screen by 8 parameters, 
including the rotor speed, torque, current root-mean-square, voltage root-mean-square, 
power factor, input power, output power, and efficiency. They are displayed in two ways: 



60 



Energy Management 



instantaneous values and iscillograms, as illustrated in Fig. 4. For multi-motors monitored, 
one can selected which motor's condition is displayed by a drop-down box on the screen. 



Current 
Signals 



Voltage 
Signals 



Nameplate 
Information 



) 



Signal 
Processing 

and 

Inferential 

Models 

Rotor Speed 
Shaft Torque 



Energy Condition 



Energy 
Usage 



Air Gap 
Eccentricity 



Power 
Factor 



Broken Bar 



Motor 
Efficiency 



Winding 
Fault 



Health Condition 



Fig. 3. Functions of the processing unit 

All the data are stored in the database and can be restored to make further analysis. Furthermore, 
motor performance could be analyzed and six performance curves could be obtained. They are 
efficiency-rotor speed, torque-rotor speed, input power-rotor speed, output power-rotor speed, 
torque-output power, and efficiency-output power curves, as illustrated in Fig. 5. 



ID. 4 H 


^!L t\ 


. $ jul m 


* 


%t — l£i|/i!i*] 




«ms»i ' mm 


Sffiffiff 


1. 














\ 


tPv° ° 




•",-« 


o^ 


-?v*| 




" 




— 


*SW«ffi(A) 


°A 


tfV ■ 


A 


IS 4 


°\ 


^v 100 


*A W „, 




*a*W) 







& fr £ ^ ill >!'] & & — #LJ$jJ&.»| 







0.50 


'i.t.M, . 3T am 0i8 


^= 


:B:H 


EBffi«iSil 378.00 


l nr tt*as 0.27 




... 

Fig. 4. In-service motor condition monitoring (Left: Instant values, Right: Iscillograms) 





$L *t & $ J£ 8ti * ^ — ;s t £ ifij 




i 

2 „„ 8 - 3 - 27 ^ ^ooe-3-.e 


8* pim o m I 


***6 riot o m 




:: ^H 


>;^H 


* ffl | 


was* Plnt o m 


ttHBW pi„, o Q 


a* Plnt o m 




:: IW 




mm^MM pi„, ,-, e 


*ss*ffi pi„, o as 


rt *aa pi». o sa | 


^H 










■ 


«' 















<fe *l £ ^ ili. «'j $ &t — j± & ^> # 



Fig. 5. Motor condition analysis (Left: History data, Right: Performance analysis) 




Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 61 

3. Applying Wireless Sensor Networks in Motor Energy Management 

The energy evaluation system in industrial plants is usually implemented with wired 
communication networks so far. Because of the high cost of installation and maintenance of 
these cables, it is desired to look for a low-cost, robust, and reliable communication network. 
The wireless sensor networks (WSN) is a self-organized network of small sensor nodes with 
communication and calculation abilities. As an open architecture, self -configuring, robust, 
and low cost network, it is suitable to meet the requirement. 

Harish Ramanurthy et al. (2005) proposed a wireless smart sensor platform which is an 
attempt to develop a generic platform with 'plug-and-play' capability to support hardware 
interface, payload and communications needs of multiple inertial and position sensors, and 
actuators/ motors used in instrumentation systems and predictive maintence applications. 
James E. Hardy et al. (2005) discussed the robust, self-configuring wireless sensors networks 
for energy management and concluded that WSN can enable energy savings, diagnostics, 
prognostics, and waste reduction and improve the uptime of the entire plant. 
Nathan Ota and Paul Wright (2006) discussed the application trends in wireless sensor 
networks for manufacturing. WSNs can make an impact on many aspects of predictive 
maintenance (PdM) and condition-based monitoring. WSNs enable automation of manual 
data collection. PdM applications of WSNs enable increased frequency of sampling. 
Condition-based monitoring applications benefit from more sensing points and thus a 
higher degree of automation. 

Bin Lu et al. (2005) and Jose A Getierrze et al. (2006) applied wireless sensor networks in 
industrial plant energy management systems. A simplified prototype WSN system was 
developed using the prototype WSN sensors devices, which were composed of a sensor unit, 
an A/D conversion unit, and a radio unit. However, because the IEEE 802.15.4 standard is 
designed to provide relaxed data throughput, it is not acceptable in some real-time cases for 
the large amount of raw data to be transmitted from the motor control centre to the central 
supervisory station. 

3.1 Wireless sensor networks 

The WSN is a self-organized network with dynamic topology structure, which is broadly 
applied in the areas of military, environment monitoring, medical treatment, space 
exploration, business, and household automation (YU HAIBIN et al., 2006). 
The IEEE802.15.4 standard is the physical layer and MAC sub-layer protocol for WSN, 
which supports three frequency bands with 27 channels as shown in Fig. 6. The 2.4GHz 
band defines 16 channels with a data rate of 250KBps. It is available worldwide to provide 
communication with large data throughput, short delay, and short working cycle. The 
915MHz band in North America defines 10 channels with a data rate of 40Kbps. And the 
868MHz band in Europe defines only 1 channel with a data rate of 20Kbps. They provide 
communication with small data throughput, high sensitivity, and large scales. 
The IEEE 802.15.4 supports two network topologies as shown in Fig. 7. The star topology is 
simple and easy to implement. But it can only cover a small area. The peer-to-peer topology, 
on the other hand, can cover a large area with multiple links between nodes. But it is 
difficult to implement because of its network complexity. 

An IEEE 802.15.4 data packet, called physical layer protocol data unit (PPDU), consists of a 
five-byte synchronization header (SHR) which contains a preamble and a start of packet 



62 



Energy Management 



delimiter, a one-byte physical header (PHR) which contains a packer length, and a payload 
field, or physical layer service data unit (PSDU), which length varies from 2 to 127 bytes 
depending on the application demand, as shown in Fig. 8. 



Channel 
868MHz band 



Channel 1-10 
915MHz band 



Channel 11-26 
2.4GHz band 



Fig. 6. IEEE 802.15.4 frequency bands and channels 





Fig. 7. Star (L) and peer-to-peer (R) topologies 



Preamble 



4bytes- 



Start of 

packet 

delimiter 



1 byte- 



SHR- 



PSDU 

Length 



1 byte- 
-PHR- 



Fig. 8. IEEE 802.15.4 packet structure 



PHY layer payload 



-2-127 bytes- 
— PSDU— 



3.2 Design and implement of WSN nodes 

A WSN node is implemented with a Cirronet ZMN2400HP wireless module to build a 
communication network between MCC and CSS. The ZMN2400HP consists of an 8-bit 
Atmel Megal28 microcontroller, which has 128KB flash memory, 4KB EEPROM and 4KB 
internal SRAM, and a Chipcon CC2420 radio chip, which is compatible with the IEEE 
802.15.4 standard and works at 2.4 GHz band. A more detailed structure of the node is 
shown in Fig. 9. 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



63 



\/ 



ZMN2400HP 
Atmel 

Megal28 



CC2420 



Jump 
Switch 



SCIB TXD 

SCIB RXD To DSP 



TXD 



RXD 



MAX 322 IE 
(RS232) 



RS232 TXD 



RS232 RXD To PC 



Fig. 9. Design of WSN nodes 

Generally there are three kinds of nodes in a wireless sensor network: transmitter nodes, 
which have both sensing and wireless communicating capabilities, the receiver nodes, 
which have both wireless and wire communicating capability, and relay nodes which have 
only the wireless communicating capability to relay the data packets in the case that the 
distances between the transmitter and receiver nodes are beyond the communication range. 
In the in-service motor monitoring system, most of the WSN nodes are transmitter ones 
used as the communication unit of the front-end device in the MCC, to transmit the 
processing results to the CSS. As a few receiver and relay nodes are used in the system, all of 
the three kinds of nodes are implemented based on the same hardware structure to simplify 
the design. Those full-capability nodes can be configured to act as transmitter, receiver or 
relay nodes. This gives the reason why the communication unit is separated from the signal 
processing unit in the design of the front-end devices. 

Power consumption is the dominating factor in the design of WSN nodes. However in this 
specific application, the power consumption is no longer a problem to be considered 
because the WSN nodes are installed at such locations as a MCC or a CSS, where the power 
supply is available. So the WSN nodes are designed to be powered by AC/ DC converters. 
Additionally, as the WSN nodes are used either with the processing unit or individually, it 
is designed to be supplied either by the processing unit or an AC/ DC converter. 



3.3 Communication protocol 

Generally the data transmitting is initiated by the front-end devices. When the signal 
processing unit gets the results ready, it makes an interrupt request to the communication 
unit, which acknowledges the request and receives the data through the asynchronous serial 
ports and then transmits them to the CSS. There are nine kinds of communication packets, 
as illustrated in Table 1. 

There are two kinds of data transmitting which are initiated by the CSS. The first one is the 
raw data transmitting. When more detailed analysis needs to be made, the raw currents data 
must be sent to the CSS, where the raw data are processed and analyzed by the more 
powerful PC. When this situation occurs, a raw data request is sent by the CSS to a given 
front-end device, which then gathers some raw data and divides them into several packets 
to send to the CSS one by one. Each time, the front-end device waits for an acknowledge 
packet sent back by the CCS before continuing to send the next one. The raw data 
transmitting ends when the CSS gets the last packet and sends back an ending packet. 



64 



Energy Management 



Type 


Description 


Direction 


0x00 


Processing results request 


CSS -► Nodes 


0x11 


Raw data request 


CSS -► FED 


0x12 


Configuration 


CSS -► FED 


0x13 


Raw data acknowledge 


CSS -► FED 


0x14 


Raw data ending acknowledge 


CSS -► FED 


0x21 


Processing data 


FED -► CSS 


0x22 


Raw data 


FED -► CSS 


0x23 


Configuration acknowledge 


FED -► CSS 


0x2A 


Log data 


Nodes -► CSS 



Note: FED stands for " front-end devices" 
Table 1. Communication packet types 

The second data transmitting initiated by the CSS is the configuration. A configuration 
packet is sent to the front-end devices which guided them to configure the processing 
parameters, such as the motor poles, motor slots, current and/ or voltage sensors errors, etc. 
Additionally, some log data are transmitted, including the conditions of the nodes, repeaters 
(routers), and coordinators. When the network fails, the log data are stored in the EEPROM 
temporarily and sent to the CSS as soon as the connection is rebuilt. 

3.4 Motor monitoring network management 

The central WSN node used at CSS is called a coordinator, which manages all the nodes in 
the network by an ID table. A node registers to the coordinator by reporting its ID after it 
powers on or resets. The coordinator communicates with each node in the ID table in turn to 
get the processing results from the front-end devices. In this way, the communicating 
conflict can be avoided. If the coordinator couldn't receive any data from a node in a given 
period of time, it deletes its ID from the table. 
The ID table is defined as follows: 
typedef struct 

{ 

//node ID 

USIGN8 ucNodelD; 

// node address 

USIGN16 uNodeShortAddr; 

// request fail counter 

USIGN8 ucReqFailCounter; 
}NODE_ID; 



typedef struct 

i 

// node counter 
USIGN8 nodeNum; 

NODEJD nodeId[MAX_NODE_NUM]; 
}NODE_ID_TABLE; 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



65 



The ID table is updated according to the combination of three conditions as described in 
Table 2. Here condition 1 (CI) is that the node ID is in the table. Condition 2 (C2) is that the 
node address is in the table. Condition 3 (C3) is that the node address changed. 



CI 


C2 


C3 


Update 


N 


N 


- 


Add new node ID 


N 


Y 


- 


Set the node ID in the record 


Y 


N 


- 


Set the node address in the record 


Y 


Y 


Y 


Set new node address in the record 


Y 


Y 


N 


No action 



Table 2. ID table updating 

To maintain the network alive, some abnormal conditions are detected and handled. A 
communication unit of the front-end device, also called a front-end node, resets its main 
CPU and the CC2420 chip and searches for the network again in three cases. First, it can't 
connect to the network in a given period of time after it powered on. Second, it can't receive 
the acknowledgement when it tries to register its ID to the coordinator at CSS after 
connecting to the network. Last, it doesn't receive the processing results request in a given 
period of time during a connecting session. 

A repeater (router) transmits data between the front-end nodes and the coordinator. It's 
more complex to judge a repeater's condition because both the front-end nodes and the 
coordinator could reset in some cases. Some actions are made according to the combination 
of five conditions as described in Table 3. Here condition 1 (CI) is that the repeater has 
received data from the coordinator. Condition 2 (C2) is that the repeater has received data 
from front-end nodes. Condition 3 (C3) is that the repeater has got an overtime during 
transmitting data with the coordinator. Condition 4 (C4) is that the repeater has got an 
overtime during transmitting data with front-end nodes. And condition 5 (C5) is that the 
repeater has got an overtime during registering to the network. 

The coordinator handles abnormal situations in two cases. It resets its main CPU and 
CC2420 chip to rebuild the network if no nodes register to it in a given period of time when 
network initiating or all IDs are deleted from its records. 



CI 


C2 


C3 


C4 


C5 


Action 


N 


N 


- 


- 


N 


Wait for data 


Y 


Reset 


N 


Y 


- 


N 


- 


Wait for data 


Y 


Reset 


Y 


N 


N 


- 


- 


Wait for data 


Y 


Reset 


Y 


Y 


N 


N 


- 


No 


N 


Y 


Reset 


Y 


N 


Y 


Y 



Table 3. Repeater abnormal processing 



66 Energy Management 

4. Non-intrusive Motor Energy Usage Condition Monitoring 

The motor energy usage condition monitoring plays an important role in the motor energy 
management. And the efficiency estimation is the key for the motor energy usage 
monitoring and evaluation. 

The motor efficiency is defined as the ratio of the motor shaft output power Po to the input 
power Pi as (1), and the difference between them is the power losses which are classified as 
stator copper loss Ws, rotor copper loss Wr, core loss Wo friction and windage loss Wfw, 
and stray load loss Wll, as given by (2). 

77 = ^x100% (1) 

W L =P 1 -P =W S+ W R+ W C + W FW +W LL (2) 

Over the years, many methods have been proposed to determine the motor efficiency. 
Generally they can be divided into three groups: direct detection, indirect detection, and 
inference methods. The direct detection methods measure the motor input and output 
power with power meters and calculate the motor efficiency directly. The indirect detection 
methods, also known as segregated loss methods, measure losses by various tests, such as 
load test, no-load test, and locked-rotor test, etc. The motor efficiency is then obtained by 
loss analysis. Many direct and indirect methods have been adopted by some international 
standards such as IEEE 112-B, IEC 34-2, and JEC 37. The Chinese national standard for 
motor efficiency determination is GB1032-2005. The methods defined in the standards are 
agreement. The main difference of them is how to determine the stray load loss. 
The inference methods determine the motor efficiency with estimation models after some 
simple experiments. The slip method (John S. Hus, 1998) presumed that the percentage of 
the load is proportional to the ratio of the measured slip to the full-load slip. Thus the motor 
efficiency is approximated using (3). The current method (John S. Hus, 1998) assumed that 
the percentage of load is proportional to the ratio of the measured current to full-load 
current. The motor efficiency is approximated using (4). Both of the methods are simple and 
low-intrusive, but poor precise. Some improvements have been made to give a more 
accurate efficiency estimate. 

_ Slip Pp sated ,-. 

"=T-^f- ( 4 ) 



4.1 Non-intrusive Motor Efficiency Estimation 

The methods described above are bench testing which requires the motor to be tested in a 
laboratory environment that may be different from the original working site. Another 
disadvantage is that they require the motor to be removed from service. They cannot be 
directly used for the in-service motors. 

The motor current signature analysis (MCSA) method is a non-intrusive testing method to 
evaluate the condition of motors by processing the motor stator current and voltage signals 
collected at the power supply while a motor is running. The motor is tested in situ, that 
means motor's original working condition is maintained. As no sensors are need to place in 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 67 

motors, it's also called the sensorless method. The MCSA method can be used to estimate 

motor efficiency and diagnose motor faults. 

Bin Lu (2006) made a survey of efficiency estimation methods of in-service induction motors, 

and classified more than 20 of the most important methods into 9 categories according to 

their physical properties. Based on the survey results, he proposed the air gap torque 

method, one of the reference methods, as one of candidates for the nonintrusive in-service 

motor efficiency estimation. 

The motor efficiency can be defined as (5) in terms of the shaft torque and the rotor speed, 

since the output power is the product of them. This is the basic principle of torque methods. 

But it's difficult, even impossible in most cases, to measure the shaft torque while a motor is 

in service. 

T shaft • °>r ,-. 

* = H^— (5) 

r i 

J. Hsu & B.P. Scoggins (1995) proposed an air gap torque (AGT) method which takes the 
output shaft torque as the air gap torque less the torque losses associate with friction, 
windage, and stray load losses caused by rotor currents. The motor efficiency can be 
obtained by (6) where the air gap torque (Tag) is calculated using (7) from the motor 
instantaneous input line currents and voltages. 

T AG' (D r-{ L FW +L s) „v 



T = 



Poles 

2>/3 



{{h-h)-\[ U CA- R i i C-h)] dt -{ i C-h)-\[ U AB- R i i A-h)\ dt } (7) 



As the rotor speed ( r ) and stator resistance (R) measurements are required and a no-load 
test must be run to measure losses Lfw and Ls, the AGT method is still a highly intrusive 
method difficult to use in the in-service motor monitoring. To overcome these problems, a 
"nonintrusive" method is developed by making the following improvements to the original 
AGT method (Bin Lu, 2006). 

a) Without direct measurement, the rotor speed is estimated from motor current 
spectrum analysis extracting slot harmonics from stator currents. 

b) The stator resistance is estimated from the input line voltages and phase currents 
using an on-line DC signal injection method. 

c) The losses are estimated from empirical values using only motor nameplate data. The 
friction and windage loss is 1.2% of the rated output power; and the stray-load loss is 
estimated from the recommended values in IEEE standard 112. 



4.2 Rotor Speed estimation 

The main approach for speed estimation in induction motors uses the machine model to 
design observers (M.A. Gallegos et al., 2006). Luenberger observers, model reference 
adaptive systems, adaptive observers, Kalman filtering techniques, and estimation based on 
parasitic effects are some techniques to deal with the problem of speed estimation. 



68 



Energy Management 



Rotor slot harmonics spectrum estimation technique is a kind of sensorless speed detection 
method. The rotor slot produces harmonic components in the air gap field, which modulate 
the flux interlacing on the stator with a frequency proportional to the rotor speed. Thus the 
speed can be estimated using the slot harmonics frequency (f s h) by (8) (Azzeddine Ferrah at 
al.,1992). 



-~(f*±fr) 



8) 



We developed a rotor speed estimator based on slot harmonics spectrum estimation, as 
illustrated in Fig. 10. (X.Z. Che & J.T. Hu et al, 2008) 







A/D 








Pretreatment 




Feature 












Extraction 
























+/- 






Power 
spectrum 
estimation 














V 










Power 
spectrum 
estimation 


nD 60/Zr(fsh±fi)^ 


fi 

seeking 




I 






< yy* 

T 60 


S 


r 






— 






Zr 










fsh 


. 








' 





































Fig. 10. Rotor speed estimation based on slot harmonics spectrum estimation 

To extract feature more accurately, pretreatment is made before spectrum analysis. First, a 
band-pass filter is designed based on Chebyshev uniform approximation to filter out the 
fundamental component and upper and lower frequency noise signals. And then frequency 
aliasing is used to enhance the slot harmonics signal. The slot harmonics appear in the 
spectrum at 2fi intervals, so the raw signals are downsampled to 2fi. Here fi is the original 
sampling frequency. As the sampling frequency is lower than the slot harmonics frequency 
after the downsampling, the frequency aliasing occurs that enhances the paired slot 
harmonics and weakens noises. 

After the pretreatment, the frequency offset of the slot harmonics in the aliasing spectrum is 
detected with maximum entropy spectrum estimation, which is a modern power spectrum 
estimation method based in AR model. The frequency with the max amplitude in the 
aliasing spectrum is the frequency offset of the slot harmonics. Then the slot harmonics 
frequency is determined by matching the offset on the original spectrum. 



4.3 Design and implement of motor monitoring front-end devices 

Based on the non-intrusive efficiency estimation method mentioned above, the front-end 
device is developed with the digital signal processing (DSP) techniques. It is divided into 
three parts: sensing, signal processing and communication unit, as shown in Fig. 11 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



69 



Analog 

-5-+5V 



Current 
Sensors 



Voltage 
Sensors 

Sensing 



Scaling 



Radio Unit 
ZMN2400HP 



01 



Analog 
, r 0-3.3V 



A/D 

Convertor 



Digital 
(SPI) 



RS232 
Driver 



DSP 
TMS320F2812 

Signal processing 



Digital 



(SCI) 
Cmmunication 



Fig. 11. The design of the front-end device 

The three parts of the front-end devices are designed and implemented separately on 
individual PCB's. When constructing the front-end devices, the signal processing unit and 
the communication unit are mounted on the sensing unit and linked by cables with each 
other, as shown in Fig. 12. The flexible design could meet the requirement for different 
sensors while different motors are monitored. And moreover the sensing unit could be 
omitted in the case that the current and voltage sensors are already equipped in the MCC in 
industrial plants. In that case, the communication unit can be mounted on the signal 
processing unit. 

The sensing unit consists of two current sensors and two voltage sensors. Both of them are 
highly accurate Hall effect ones. In the prototype devices used in the laboratory, the current 
sensor is HNC025A with 0-36 amps RMS current range, 0.6% accuracy, and <0.2% 
linearity, and the voltage sensor is HNV025A with 1 00-2500 V volts RMS current range, 
0.6% accuracy, and <0.2% linearity. 




Fig. 12. Implementation of the sensing, processing and communication unit 

The signal processing unit contains three main subunits. The -5v - +5v analogue voltage 
signals coming from the sensing unit are firstly scaled into analogue signals in the range of 
0-3.3 volts to meet the requirement of the ADC chip. And then a 12-bit 8-channel ADC is 
used to sample the analogue waveforms at a certain frequency , which can be configured as 
2, 4 or 8 KHz in the prototype devices, and convert them into digital signals. 
The kernel of the signal processing unit is a 32-bit fixed-point DSP chip TMS320F2812, 
which has 128KB flash memory, 18KB internal SRAM. It controls the signal processing and 
spectrum estimation programs running in a ucOS/II system. 



70 



Energy Management 



In order to evaluate the energy usage, 8 motor condition parameters are estimated and/ or 
calculated, including the current root mean square (I rms )/ the voltage root mean square 
(Urms), the input power (Pi) , the power factor ( cos V), the rotor speed ( r ), the shaft torque 
(Tshaft), the output power (Po), and the efficiency ( 7 ), as shown in Fig. 13. 



Raw Data 



~ 



Pretreatment 



Irms and Urms 



Apparent power 



_ 



Torque 



Speed 



Input power 



_ 



Output power 



l 
Power factor 



Efficiency 



Fig. 13. Motor condition parameters calculation 

The output power is calculated from rotor speed and shaft torque. The rotor speed is 
estimated by the method described in section 4.2. The shaft torque is obtained by 
subtracting the torque losses associated with the friction and windage loss Lfw and rotor 
stray-load loss Ls from the calculated air-gap torque, as given by (9). In this implement, the 
combined losses of Lfw and Ls are assumed to be 3.5% of rated output power from empirical 
values. And the stator resistance is assumed to be the same as the resistance measured at 
cool state. Other parameters can be obtained by (10)-(13). At last, the motor efficiency is 
calculated by (1). 



T —T FW s 

1 shaft 1 AG 

G)„ CO, 



nW m 



u = -fv 

rms \n£a m 

i N 

Pr = / U i 



coscp- 



S 43-U'I 



(9) 
(10) 

(11) 
(12) 
(13) 



5. Laboratory Test and Plant Application 

The system are tested in the laboratory with four Y100L2-4 induction motors (4-pole, 3KW, 
380V, 6.8A) with four 4KW DC generators as their loads, and applied in a plant to monitor 
four pumping motors as illustrated in Fig. 14. 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



71 



In the CCS, a WSN receiver node is used as a coordinator of the network. Four front-end 
devices are installed in the MCC to acquire the current and voltage signals of the four test 
motors. When started, they search and connect to the coordinator automatically to setup a 
star wireless network. Then the coordinator sends a query packet to one of the 4 front-end 
nodes every second and receives a data packet sent back on the request. In this way, the 
motor monitoring results are successfully transmitted to the CSS constantly. 
The motors are tested from no load to full load with intervals of 12.5% load. And signals are 
sampled and analyzed for 120 seconds at each load point. That means totally 4 (motors) * 9 
(load point per motor) * 120 (seconds per load point) / 3 (seconds for one packet) = 1440 
packets are transmitted from 4 front-end devices to the CCS. As only one packet is sent to 
the coordinator from one of the 4 front-end monitoring devices every second, the data 
throughput is enough to transmit the data packets, and there is no packet lost in the 
laboratory test. 




Fig. 14. Laboratory testing system (L) and the pumping motors in a plant (R) 



5.1 Data throughput over the WSN 

As described in section 3.1, the PSDU length can vary from 2 to 127 bytes in a IEEE 802.15.4 
data packet. In the proposed system, the PSDU is totally 32 bytes long with 1-byte motor ID, 
1-byte frame type, 2-byte counting number, 4-byte voltage, 4-byte current, 4-byte speed, 4- 
byte torque, 4-byte input power, 4-byte output power, 2-byte efficiency, and 2-byte power 
factor. Apparently, one result can be transmitted in one data packet. 

To meet the requirement of signal processing, 4 channels of current and voltage signals are 
sampled synchronously at 4KHz frequency for 1 second to get 50 cycles of 50Hz waveforms. 
Another 2 seconds are spent on calculating and transmitting the results. So every 3 seconds, 
a data packet is sent to the CSS from one front-end device. 

That transmitting time and data throughput requirement is enough to be implemented in an 
IEEE 802.15.4 WSN with the standard latency 6-60 ms and data throughput 250KBps. 
To check the maximum communication abilities between the WSN nodes, a simple test is 
made in which real size data packets are continuously sent from a transmitter to a receiver 
in 300ms with each packet sent within an specified interval (Is). The packets sent from the 
transmitter (Ps) and the packets received by the receiver (Pr) are counted. Then the real 
receiving interval (Ir), average packets received per second (Pa), and the packets lost rate 
(Lr) are calculated. The test results are illustrated in Table 4. 



72 



Energy Management 



Is 


Ps 


Pr 


Ir 


Pa 


Lr 


0.100 


2976 


2976 


0.0101 


9.92 


0.0000% 


0.050 


5887 


5887 


0.0051 


19.62 


0.0000% 


0.030 


9691 


9691 


0.0031 


32.30 


0.0000% 


0.025 


11567 


11567 


0.0026 


38.56 


0.0000% 


0.020 


14310 


14310 


0.0021 


47.70 


0.0000% 


0.015 


18791 


18790 


0.0016 


62.63 


0.0053% 


0.010 


22577 


19537 


0.0015 


65.12 


13.4650% 


0.005 


29718 


18851 


0.0016 


62.84 


36.5671% 



Table 4. Communication abilities test 

From the test results, it can be seen that the minimum packets receiving interval is about 
0.015 seconds. In other words, maximum 66.7 packets can be received every second on 
average. If the transmitter sends packets faster than that, the communication becomes worse 
with packets lost rate getting higher. 

5.2 Motor efficiency estimation 

The test results on motor No. 3 and 4 are listed in Table 5 and 6 with estimated values and 

measured values. The estimated values vs. measured values of speed, torque, and efficiency 

of motor No. 3 are figured in Fig. 15 to 17. 

The detection errors are large when the loads are under 25%. That's because the electromagnetic 

characteristic of the motor ferromagnetic slope the power factor curve under no load or light 

loads conditions. Another reason is that the motor load-efficiency curve is sloping in that section 

and the speed estimation error is enlarged in efficiency calculation process. 

Generally the average loads of in-service motors are above 50%, so the larger errors under 

no load or light loads condition have little effects on the application of the monitoring 

system in plants. 



Loads 

% 


speed (r/min) 


torque (N.m) 


efficiency 


Estimation 


Measurement 


Estimation 


Measurement 


Estimation 


Measurement 





1498.75 


1495.80 


1.25 


1.16 


41.40% 


43.26% 


12.5 


1491.50 


1494.00 


2.75 


2.46 


62.50% 


62.58% 


25.0 


1482.00 


1483.80 


5.75 


5.34 


79.30% 


76.82% 


37.5 


1469.00 


1470.60 


8.72 


9.34 


80.10% 


85.61% 


50.0 


1459.50 


1460.40 


12.00 


11.94 


84.80% 


83.37% 


62.5 


1450.25 


1451.40 


14.50 


13.69 


85.20% 


79.72% 


75.0 


1443.25 


1443.00 


16.25 


16.43 


84.00% 


84.44% 


87.5 


1436.75 


1435.20 


17.50 


17.07 


82.80% 


79.92% 


100 


1428.50 


1428.60 


18.50 


19.49 


81.20% 


75.93% 



Table 5. Test results on motor No. 3 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 



73 





Loads 

% 


speed (r/min) 


torque (N.m) 


efficiency 


Estimation 


Measurement 


Estimation 


Measurement 


Estimation 


Measurement 





1499.50 


1496.40 


2.50 


1.30 


76.20% 


43.81% 


12.5 


1498.75 


1492.80 


3.25 


2.54 


72.70% 


61.56% 


25.0 


1478.50 


1485.00 


6.25 


5.61 


81.60% 


77.54% 


37.5 


1472.25 


1471.80 


9.00 


9.08 


82.80% 


84.05% 


50.0 


1460.75 


1462.20 


12.00 


11.83 


85.90% 


91.48% 


62.5 


1450.25 


1449.00 


14.00 


14.33 


82.00% 


84.27% 


75.0 


1439.50 


1441.00 


16.25 


16.41 


84.40% 


85.53% 


87.5 


1434.00 


1434.00 


17.75 


17.82 


84.00% 


84.14% 


100 


1426.75 


1427.40 


18.75 


19.08 


82.40% 


83.39% 



Table 6. Test results on motor No. 4 




Fig. 15. Estimated vs. Measured Speed Values of Motor No. 3 




Fig. 16. Estimated vs. Measured Torque Values of Motor No.3 



74 



Energy Management 




Fig. 17. Estimated vs. Measured Efficiency Values of Motor No.3 



6. Conclusion 

This paper proposes a motor energy management architecture, which is composed of a data 
acquisition platform, a condition monitoring platform, an energy consumption and saving 
analysis platform, a communication platform, and a motor energy data management 
platform. 

Under the guidance of the architecture, an in-service motor monitoring and energy 
management system is developed based on non intrusive monitoring technologies and 
wireless sensor networks. The system has two subsystems: a data acquiring and analysis 
subsystem, and a condition monitoring and energy management subsystem. 
To evaluate the in-service motor energy usage, motor efficiency estimation methods are 
discussed. And a motor monitoring front-end device is developed with the implement of the 
methods introduced. The device is designed as three separate units, including a sensing unit, 
a processing unit, and a communication unit. Such a flexible design could meet various 
requirements in the application. 

The wireless sensor network is a self-organized network with dynamic topology. As a low- 
cost, robust, and reliable communication network, it is used to connect the front-end devices 
with the central supervisory station. A WSN node is designed and implemented for the in- 
service motor monitoring system, which can also be used as a unit of the front-end device. 
The laboratory tests and plant application show that the system can help the plant managers 
to improve motor-driven systems. 



Motor Energy Management based on 

Non-Intrusive Monitoring Technology and Wireless Sensor Networks 75 



7. References 

U.S. Department of Energy (2007), Sensors & Automation 2007 Annual Portfolio Review, 

Rosemont, Illinois, June 2007. 
Electrical Industrial Association of China (2006), The New Trend of Motor Energy-saving, 

Electrical Industry, April 2006, pp. 50-52 
Ramamurthy, H.; Prabhu, B.S.; Gadh, R. & Madni, A.M., Smart sensor platform for 

industrial monitoring and control, Sensors, 2005 IEEE, Oct. 30 2005-Nov. 3 2005, 

pp.1116-1119 
James E. Hardy; Wayne W. Manges; Jose A. Guitierrez & Phani Teja V. Kuruganti (2005), 

Wireless Sensors and Networks for Advanced Energy Management, 2005 ACEEE 

Summer Study on Energy Efficiency in Industry, West Point, New York, July 2005 
Nathan Ota & Paul Wright (2006), Trends in wireless sensor networks for Manufacturing, 

Int. J. Manufacturing Research, Vol. 1, No. 1, (2006), pp. 3-17 
Bin LU; Long Wu; Thomas G. Habetler; Ronald G. Harley & Jose A. Gutierrez (2005), On the 

Application of Wireless Sensor Network in Condition Monitoring and Energy 

Evaluation for Electric Machines, Proceedings of the 31st Annual Conference of the 

IEEE Industrial Electronics Society (IECON'05), pp.2674-2679, Raleigh, NC, Nov. 

2005. 
Jose A. Gutierrez; David B. Durocher & Bin Lu (2006), Applying Wireless Sensor Networks 

in Industrial Plant Energy Evaluation and Planning Systems, Conference Record of the 

2006 IEEE IAS Pulp and Paper Conference, pp.1-7, Jun. 2006 
Yu Haibin; Zeng Peng & Liang Wei (2006), Intelligent Wireless Sensor Networks, Li Wei; Tian 

Shiying & Yao Qingshuang, (1st Ed), Science Press, ISBN 7-03-016453-9, Beijing 
John S. Hsu; John D. Kueck; Mitchell Olszewski; Don A. Casada; Pedro J. Otaduy & Leon M. 

Tolbert, Comparision of Induction Motor Field Efficiency Evaluation Methods, 

IEEE Transactions on Industry Applications, pp. 117-125, Vol. 34, No. 1, Jan./Feb. 1998. 
B. Lu; T. G. Habetler & R. G. Harley (2006), A Survey of Efficiency-Estimation Methods for 

In-Servce Induction Motors, IEEE Trans. Industry Applications, pp.924-933, vol. 42, 

no. 4, Jul/Aug. 2006. 
Bin Lu; Thomas G. Habetler & Ronald G. Harley (2006), A Nonintrusive and In-Service 

Motor Efficiency Estimation Method using Air-Gap Torque with Considerations of 

Condition Monitoring, Conference Record of the 2006 IEEE Industry Applications 

Conference, pp.1533 - 1540, Volume 3, Oct. 2006 
J. hsu & B.P. Scoggins (1995), Field Test of Motor Efficiency and Load Changes through Air- 
gap Torque, IEEE Transctions on Energy Convers, pp.477-483, vol. 10, no.3, Sep. 1995. 
M.A. Gallegos; R. Alvarez & C.A. Nunez (2006), A survey on speed estimtion for sensorless 

control of induction motors, 10th IEEE International Power Electronics Congress, pp.l- 

6, Oct. 2006. 
Azzeddine Ferrah; Kerth J. Bradley & Greg M. Asher (1992), an FFT-Based Novel Approach 

to Noninvasive Speed Measurement in Induction Motor Drives, IEEE Transaction on 

Instrumentation and Measurement, pp. 797-802, Vol. 41, No. 6, Dec. 1992 
X.Z. Che; J.T. Hu & Q.J. Guo (2008), An Slot Harmonics Detection-Based Approach to Speed 

Estimation in a Sensorless Induction Motor, Chinese Journal of Scientific Instrument, 

pp. 414-417, Vol.29, No.4S, 2008(4) 



76 Energy Management 



Home energy management problem: 
towards an optimal and robust solution 

Duy Long Ha, Stephane Ploix, Mireille Jacomino and Minh Hoang Le 

G-SCOP lab (Grenoble Institute of Technology) 

France 



1. Introduction 

A home automation system basically consists of household appliances linked via a communi- 
cation network allowing interactions for control purposes (Palensky & Posta, 1997). Thanks to 
this network, a load management mechanism can be carried out: it is called distributed control 
in (Wacks, 1993). Load management allows inhabitants to adjust power consumption accord- 
ing to expected comfort, energy price variation and CO2 equivalent rejection. For instance, 
during the consumption peak periods when power plants rejecting higher quantities of CO2 
are used and when energy price is high, it could be possible to decide to delay some services, 
to reduce some heater set points or to run requested services even so according to weather 
forecasts and inhabitant requests. Load management is all the more interesting that local stor- 
age and production means exist. Indeed, battery, photovoltaic panels or wind mills provide 
additional flexibilities. Combining all these elements lead to systems with many degrees of 
freedom that are very complex to manage by users. 

The objective of this study is to setup a general mathematical formulation that makes it pos- 
sible to design optimized building electric energy management systems able to determine the 
best energy assignment plan, according to given criteria. A building energy management 
system consists in two aspects: the load management and the local energy production man- 
agement. (House & Smith, 1995) and (Zhou & Krarti, 2005) have proposed optimal control 
strategies for HVAC (Home Ventilation and Air Conditioning) system taking into account the 
natural thermal storage capacity of buildings that shift the HVAC consumption from peak- 
period to off-peak period. Zhou & Krarti (2005) has shown that this control strategy can save 
up to 10% of the electricity cost of a building. However, these approaches do not take into 
account the energy resource constraints, which generally depend on the autonomy needs of 
off-grid systems (Muselli et al., 2000) or on the total power production limits of the suppliers 
in grid connected systems. 

The household load management problem can be formulated as a assignment problem where 
energy is considered as a resource shared by appliances, and tasks are energy consumptions 
of appliances. Ha et al. (2006a) presents a three-layers household energy control system that 
is both able to satisfy the maximum available electrical power constraint and to maximize 
user satisfaction criteria. This approach carries out more reactivity to adapt consumption 
to the energy provider requirements. Ha et al. (2006b) proposes a global solution for the 
household load management problem. In order to adapt the consumption to the available 
energy, the home automation system controls the appliances in housing by determining the 



78 



Energy Management 



starting time of services and also by computing the temperature set points of HVAC systems. 
This problem has been formulated as a multi-objective constraint satisfaction problem and 
has been solved by a dynamic Tabu Search. This approach can carry out the coordination of 
appliance consumptions of HVAC system and of services in making it possible to set up a 
compromise between the cost and the user comfort criteria. 

With an energy production management production point of view, Henze & Dodier (2003) 
has proposed an adaptive optimal control for an off-grid PV-hybrid system using a quadratic 
cost function and a Q-learning approach. It is more efficient than conventional control but 
it requires to be trained beforehand with actual data covering a long time period. Gener- 
ally speaking, studies in literature focus only on one aspect of the home energy management 
problem: the load management or the local energy production but not on the joined load and 
production management problem. 

This chapter formulates the global approach for the building energy management problem as 
a scheduling problem that takes into account the load consumption and local energy produc- 
tion points of view. The optimization problem of the building energy management is modeled 
using both continuous and discrete variables: it is modeled as a mixed integer linear problem. 

2. Problem description 

In this chapter, energy is restricted to electricity consumption and production. Each service 
is depicted by an amount of consumed /produced electrical power; it is supported by one or 
several appliances. 

2.1 The concept of service 

Housing with appliances aims at providing comfort to inhabitants thanks to services which 
can be decomposed into three kinds: the end-user services that produce directly comfort to 
inhabitants, the intermediate services that manage energy storage and the support services 
that produce electrical power to intermediate and end-user services. Support services deal 
with electric power supplying thanks to conversion from a primary energy to electricity. Fuel 
cells based generators, photovoltaic power suppliers, grid power suppliers such as EDF in France, 
belong to this class. Intermediate services are generally achieved by electrochemical batteries. 
Among the end-user services, well-known services such as clothe washing, water heating, specific 
room heating, cooking in oven and lighting can be found. 

A service with index i is denoted SRV(i). Appliances are just involved in services: they are 
not central from an inhabitant point of view. Consequently, they are not explicitly modelled. 

2.2 Caracterisation of services 

Let us assume a given time range for anticipating the energy needs (typically 24 hours). A 
service is qualified as permanent if its energetic consumption /production /storage covers the 
whole time range of energy assignment plan, otherwise, the service is named temporary service. 
The following table gives some examples of services according to this classification. 





temporary services 


permanent services 


support services 


photovoltaic panels 


power provider 


intermediate services 


- 


storage 


end-user services 


washing 


room heating 



The services can also be classified according to the way their behavior can be modified. 



Home energy management problem: towards an optimal and robust solution 



79 



Whatever the service is, an end-user, an intermediate or a support service can be modifiable 
or not. A service is qualified as modifiable by a home automation system if the home automation 
system is capable to modify its behavior (the starting time for example). 

There are different ways of modifying services. Sometimes, modifiable services can be con- 
sidered as continuously modifiable such as the temperature set points in room heating services 
or the shift of a washing. Some other services may be modified discretely such as the in- 
terruption of a washing service. The different ways of modifying services can be combined: 
for instance, a washing service can be considered both as interruptible and as continuously 
shiftable. A service modeled as discretely modifiable contains discrete decision variables in 
its model whereas a continuously modifiable service contains continuous decision variables. 
Of course, a service may contain both discrete and continuous decision variables. 
A service can also be characterized by the way it is known by a home automation system. The 
consumed or produced power may be observable or not. Moreover, for end-user services, the 
impact of a service on the inhabitant comfort may be known or not. 

Obviously, a service can be taken into account by a home automation system if it is at least ob- 
servable. Some services are indirectly observable. Indeed, all the not observable services can 
be gathered into a virtual non modifiable service whose consumption /production is deduced 
from a global power meter measurement and from the observable service consumptions and 
productions. In addition, a service can be taken into account for long term schedulings if it is 
predictable. In the same way as for observable services, all the unpredictable services can be 
gathered into a global no-modifiable predictable service. A service can be managed by a home 
automation system if it is observable and modifiable. Moreover, it can be long-term managed 
if it is predictable and modifiable. 



primary power resources 

V V ' V 



CD 

power flow 

► 

characteristics 

of primary power 

resources 





user satisfaction 
wrt a service 

o 




T 

o 

comfort to inhabitants 



Fig. 1. Structure of services in housing 



80 



Energy Management 




Fig. 2. Schema of the 3 layers control mechanism 



2.3 Principle of control mechanism 

An important issue in home automation problems is the uncertainties in the model data. For 
instance, solar radiation, outdoor temperature or services requested by inhabitants may not 
be predicted with accuracy. In order to solve this issue, a three-layer architecture is presented 
in this chapter: a local layer, a reactive layer and an anticipative layer (see figure 2). 
The anticipative layer is responsible for scheduling end-user, intermediate and support services 
taking into account predicted events and costs in order to avoid as much as possible the use of 
the reactive layer. The prediction procedure forecasts various informations about future user 
requests but also about available power resources and costs. Therefore, it uses information 
from predictable services and manage continuously modifiable and shiftable services. This 
layer has slow dynamics and includes predictive models with learning mechanisms, includ- 
ing models dealing with inhabitant behaviors. This layer also contains a predictive control 
mechanism that schedules energy consumption and production of end-user services several 
hours in advance. This layer computes plans according to available predictions. The sampling 
period of the anticipative layer is denoted A. This layer relies on the most abstract models. 
The reactive layer has been detailed in (Abras et al., 2006). Its objective is to manage adjust- 
ments of energy assignment in order to follow up a plan computed by the upper anticipative 
layer in spite of unpredicted events and perturbations. Therefore, this layer manages modi- 
fiable services and uses information from observable services (comfort for end-user services 
and power for others). This layer is responsible for decision-making in case of violation of 
predefined constraints dealing with energy and inhabitant comfort expectations: it performs 
arbitrations between services. The set-points determined by the plan computed by the upper 
anticipative layer axe dynamically adjusted in order to avoid user dissatisfaction. The con- 
trol actions may be dichotomic in enabling/ disabling services or more gradual in adjusting 



Home energy management problem: towards an optimal and robust solution 



81 



power supplier 



L cost/ 



constraint related to ^ 

i i /i characterics iof the resource i energy unit 




consumed power (permanent service) 



i r 



-f 



-f 



T 



x plan for 
consumed 
^^ "^^-constraint related to user satisfaction power 

consumed power (temporary service) 

rm — r^ 



s 



plan for 

c<pnsum^d 

power 

Fig. 3. Plans computed by the anticipative mechanism 



\ 



dec; 



constraint related to 
user satisfaction 



set-points such as reducing temperature set point in room heating services or delaying a tem- 
porary service. Actions of the reactive layer have to remain transparent for the plan computed 
by the anticipative layer: it can be considered as a fast dynamic unbalancing system taking 
into account actual housing state, including unpredicted disturbances, to satisfy energy, com- 
fort and cost constraints. If the current state is too far from the computed plan, the anticipative 
layer has to re-compute it. 

The local layer is composed of devices together with their existing local control systems gen- 
erally embedded into appliances by manufacturers. It is responsible for adjusting device con- 
trols in order to reach given set points in spite of perturbations. This layer abstracts devices 
and services for upper layers: fast dynamics are hidden by the controllers of this level. This 
layer is considered as embedded into devices: it is not detailed into this chapter. 
This chapter mainly deals with the scheduling mechanism of the anticipative layer, which 
computes anticipative plans as shown in figure 3. 

3. Modeling services 

Modeling services can be decomposed into two aspects: the modeling of the behaviors, which 
depends on the types of involved models, and the modeling of the quality of the execution of 
services, which depends on the types of service. Whatever the type of model it is, it has to be 



82 Energy Management 



defined all over a time horizon KA for anticipative problem solving composed of K sampling 
periods lasting A each. 

3.1 Modeling behavior of services 

In order to model the behavior of the different kinds of services in housing, three different 
types of models have been used: discrete events are modeled by finite state machines, con- 
tinuous behaviors are modeled by differential equations and mixed discrete and continuous 
evolutions are modeled by hybrid models that combine the two previous ones. 

Using finite state machines (FSM) 

A finite state machine dedicated to a service SRV is composed of a finite number of states 
{£ m ; m £ {1, ..., M}} and a set of transitions between those states {Tp,q £ {0, 1}; (p, q) € S C 
{1, ..., M} 2 }. Each state £ m of a service SRV is linked to a phase characterized by a maximal 
power production P m > or consumption P m < 0. 

A transition triggers a state change. It is described by a condition that has to be satisfied 
to be enabled. The condition can be a change of a state variable measured by a sensor, a 
decision of the antipative mechanism or an elapsed time for phase transition. If it exists a 
transition between the state £ m and C m > then T m>m i = 1, otherwise T m>m i = 0. An action can 
be associated to each state: it may be a modification of a set-point or an on /off switching. As 
an example, let's consider a washing service. 

The service provided by a washing machine may be modeled by a FSM with 4 states: the 
first state is the stand-by state C\ with a maximal power of P\ = —5W (it is negative because 
it deals with consumed power). The transition towards the next state is triggered by the 
anticipative mechanism. The second state is the water heating state £2 with P2 = — 2400W. 
The transition to the next state is triggered after T2 time units. The next state corresponds to 
the washing characterized by V3 = — 500 W. And finally, after a given duration T3 depending 
on the type of washing (i.e. the type of requested service), the spin-drying state is reached with 
-p 3 = — 1000 W. After a given duration T4, the stand-by state is finally recovered. Considering 
that the initial state is C\, this behavior can be formalized by: 

' {state = C\) A (t = t start) -> state = £2 

(state = C 2 ) A (t = t sta rt+T 2 ) -+ state = £3 

(state = £3) A(t = t s tart+T 2 +T 3 ) -+ state = £ 4 

k (state = £ 4 ) A(t = t st art+T 2 +T 3 +T 4 ) -* state = £1 

Using differential equations 

In buildings, thermal phenomena are continuous phenomena. In particular, the thermal be- 
havior of a HVAC system can be modeled by state space models: 

^ = A c x c (t) + B c u c (t) + F c p c (t) (2) 

y c (t) = Cx c (t) 

x c (t) contains state variables, usually temperature. u c (t) contains controlled input variables 
such as energy flows. p c (t) contains known but uncontrolled input variables such as outside 
temperature or solar radiance. A first order state space thermal model relevant for control 
purpose has been proposed in Nathan (2001) but the second order model based on an electric 



Home energy management problem: towards an optimal and robust solution 



83 



analogy proposed in Madsen (1995) has been preferred for our control purpose because it 
models the dynamic of indoor temperature. For a room heating service SRV(i), it yields: 



with A c 



1 


it 


~T in (i,t)~ 
J- envy-/ 1) 


= A C 


Ti„(i, 
J- envy- 




+ B c [p(i,t)]+F c 




T in (i,t) = C c 


T in (i,t) 
_T env (i,t)_ 




r _i 


1 


r n i r n ni 


TinCenv 
1 


fin Cenv 


,B C = 


1 

L —c in - 


,F C = 


1 W 


anc 


TinCin ^env^in^in 


\-r env c in c in \ 





T ut(i,t) 
Ps(i,t) 



(3) 



[1 0] 



This model allows a rather precise description of the dynamic variations of indoor tempera- 
ture with: 

• T in/ Tout, T e nv the respective indoor, outdoor and housing envelope temperatures 

• Cj n , c env the thermal capacities of first indoor environment and second the envelope of 
the housing 

• Tin/ r env thermal resistances 

• w the equivalent surface of the windows 

• P the power consumed by the thermal generator, P < 0. In this chapter, this flow is 
assumed to correspond to an electric energy flow. 

• (p s the energy flow generated by the solar radiance 

In order to solve the anticipative problem, continuous time models have to be discretized 
according to the anticipation period A. Equation (2) modelling service SRV(i) becomes: 



Vfce {l,...,K} 

J- envy- 1 /C + 1 



Ai 



T in (i,k) 

i-envy-i k) 



+ B i [E{i,k)]+F i 



T ut(i,k) 
<ps(i,k) 



(4) 



with A { = e A ^ r B { = (e AcA - I n )A- l £sr l B c , F t = (e A < A 
E(i,k)<0. 



I n )A- l F c , E(i,k) = P(i,k)A and 



Using hybrid models 

Some services cannot be modeled by a finite state machine nor by differential equations. Both 
approaches have to be combined: the resulting model is then based on a finite state machine 
where each state C m actually becomes a set of states which evolution is depicted by a differ- 
ential equation. 

An electro-chemical storage service supported by a battery may be modeled by a hybrid 
model (partially depicted in figure 4). x(t) stands for the quantity of energy inside the battery 
and u(t) the controlled electrical power exchanged with the grid network. 

Using static models 

Power sources are usually modelled by static constraints. Local intermittent power resources, 
such as photovoltaic power system or local electric windmill, and power suppliers are con- 
sidered here. Using weather forecasts, it is possible to predict the power production w(i,k) 



84 Energy Management 

during each sampling period \kA, (k + 1)A] of a support service SRV(i). The available energy 
for each sampling period k is then given by: 

E(i,k) = w(i,k)A\/k e {1, ...,#} (5) 

with. w(i,k) > 

According to the subscription between inhabitants and a power supplier, the maximum avail- 
able power is given. It may depends on time. For a service of power supply SRV(i), it can be 
modelled by the following constraint: 

E(i,k) < p m ax(i,k)AVke{l,...,K} (6) 

where p m ax(hk) stands for the maximum available power. 

3.2 Modeling quality of the execution of services 

Depending on the type of service, the quality of the service achievement may be assessed 
in different ways. End-user services provide comfort to inhabitants, intermediate services 
provide autonomy and support services provide power that can be assessed by its cost and its 
impact on the environment. In order to evaluate these qualities different types of criteria have 
been introduced. 

End-user services 

Generally speaking, modifiable permanent services use to control a physical variable: the user 
satisfaction depends on the difference between an expected value and an actual one. Let's 
consider for example the HVAC controlling a temperature. A flat can usually be split into 
several HVAC services related to rooms (or thermal zones) assumed to be independent. 
According to the comfort standard 7730 (AFNOR, 2006), three qualitative categories of ther- 
mal comfort can be distinguished: A, B and C. In each category, (AFNOR, 2006) proposes 
typical value ranges for temperature, air speed and humidity of a thermal zone that depends 
on the type of environment: office, room,. . . These categories are based on an aggregated cri- 
terion named Predictive Mean Vote (PMV) modelling the deviation from a neutral ambience. 
The absolute value of this PMV is an interesting index to evaluate the quality of a HVAC 
service. In order to simplify the evaluation of the PMV, typical values for humidity and air 
speed are used. Therefore, only the ambient temperature corresponding to the neutral value 
of PMV (PMV=0) is dynamically concerned. Under this assumption, an ideal temperature T p 
is obtained. Depending on the environment, an acceptable temperature range coming from 



u(t) > 




Fig. 4. Hybrid model of a battery 



Home energy management problem: towards an optimal and robust solution 85 

the standard leads to an interval [T m ; n , T max }. For instance, in an individual office in category 
A, with typical air speed and humidity conditions, the neutral temperature is T op t = 22° C and 
the acceptable range is [21°C,23°C]. 

Therefore, considering the HVAC service SRV(i), the discomfort criterion D(i,k), which is 
more usable than comfort criterion here, is modelled by the following formula where assump- 
tions are depicted by two parameters a\ and a^ 

(T op t — Tj n (i,k)) 

«i x —f — zTr if Tin ( l ' k ) - T °vt 

D{i,k) = \PMV{T in {i,k))\ - { l f l *f (7) 

ai x — _ if T in (i,k) > T opt 

t-Max J- opt 
The global comfort criterion is defined as following: 

D(i)=£D(i,k) (8) 

fc=i 

Generally speaking, modifiable temporary end-user services do not aim at controlling a phys- 
ical variable. Temporary services such as washing are expected by inhabitants to finished at 
a given time. Therefore, the quality of achievement of a temporary service depends on the 
amount of time it is shifted. Therefore, in the same way as for permanent services, a user 
dissatisfaction criterion for a service SRV(i) is defined by: 



f(i)-fopt(i) 
Jmax\}) ~ jopt\}) 



« fv)>ut(<) 



Jopty-) ~ Jmin\ l ) 

where f p stands for the requested end time and f m f n and f max stand respectively for the 
minimum and maximum acceptable end time. 

Intermediate services 

Intermediate services are composed of two kinds of services: the power storage services, which 

store energy to be able to face difficult situations such as off-grid periods, and then lead to the 

availability of the stored power supplier services (see figure 1). A power storage service SRV(i) 

and a stored power service SRV(j);j ^ i are associated to each storage system. 

The quality of a power storage service has to be evaluated: it is related to the amount of stored 

energy. This quality is called autonomy. 

Let us consider a electric storage system modelled by a power storage service SRV(i) and by 

a stored power supplier service SRV(j). The stock E stock (k) of the storage system is modelled 

by: 

E stock {k) = E °%g l - £(E(i, + E(j,Z)) (10) 

with E(i,Q < and £(/,£) > 0. 

Let V re j be the reference power taken into account for the computation of the autonomy dura- 
tion T au tonomy- The autonomy objective A(k) can be defined by: 

A{k) = £ E stock (k) (11) 

ke{i,...,K} 



86 Energy Management 

Depending on the inhabitant expectations, autonomy can also be formulated by constraints to 
be satisfied at any sample time: P re f T autonomy — E stock (k) = 0, \/k <G {1, . . . ,K}. 
Let's now focus on stored power supplier service. What is the quality for this service i.e. the 
service that provides stored energy to the housing. It is not a matter of economy nor of ecology 
because costs is already taken into account when power production services provide power 
to the storage system. It is not also a matter of stored energy: there is no quality of service 
defined for stored power supplier service. 

Support services 

Support services dealing with power resources do not interact directly with inhabitants. How- 
ever, inhabitants do care about their cost and their environmental impact. These two aspects 
have to be assessed. 

In most cases, the economical criterion corresponds to the cost of the provided, stored or sold 
energy. This cost may contain depreciation of the device used to produce power. 
Let SKV(O) be a photovoltaic support service and SRV(1) be a power supplier service. Let's 
examine the case of power provider such as EDF in France. Energy is sold at a given price 
C(l,k) to the customer for each consumed kWh at time k. In order to promote photovoltaic 
production, power coming from photovoltaic plants is bought by the supplier at higher price 
C(0,k) > C(l,k). 

Different power metering principles can be subscribed with a French power supplier. Only 
the most widespread principle is addressed. The energy cost is thus given by the following 
equation: 

C{k) = C(l,k)E(l / k)-C{0,k)E(0,k), Vfc e {\,...,K} (12) 

The equivalent mass of carbon dioxide rejected in the atmosphere has been used as ecological 
criterion for a support service. This criterion is easy to establish for most power devices: 
photovoltaic cells, generator and even for energy coming from power suppliers. Powernext 
energy exchange institution publishes the equivalent mass of carbon dioxide rejected in the 
atmosphere per power unit in function of time (see http://www.powernext.fr). For instance, 
in France, electricity coming from the grid network produces 66g/kWh of CO2 during off-peak 
periods and 383g/kWh during peak period (Angioletti & Despretz, 2003). Energy coming 
from photovoltaic panels is considered as free of CO2 rejection (grey energy is not taken into 
account). For each support service SRV(i), a CO2 rejection rate Tcoi{h k) can be defined as the 
equivalent volume of CO2 rejected per kWh. Therefore, the total rejection for a support service 
SRV(i) during the sampling period k is given by Tcoi{h k)E(i, k) where E(i, k) corresponds to 
the energy provided by the support service SRV(i) during the sampling period k. 

4. Formulation of the anticipative problem as a linear problem 

The formulation of the energy management problem contains both behavioral models with 
discrete and continuous variables, differential equation and finite state models, and quality 
models with nonlinearities such as in the PMV model. In order to get mixed linear problems 
which can be solved by well known efficient algorithms, transformations have to be done. The 
ones that have been used are summarized in the next section. 

4.1 Transformation tools 

Basically, a proposition denoted X is either true or false. It can result from the combination of 
propositions thanks to connecting operators such as "A"(and), "V"(or), "0" (exclusive or), " n " 



n x 


<-> 


<S = 


X 1 AX 2 


<-> 


<*l + S 2 = 2 


x 1 w x 2 


o 


Si + h > 1 


Xi@X 2 


f-» 


<$1 + ^2 = 1 


X\ — y X 2 


«-» 


Ji - S 2 < 


X 1 <-> x 2 


o 


<?i - S 2 = 



Home energy management problem: towards an optimal and robust solution 87 



(not), "— >" (implies), "o" (if and only if),... Whatever the proposition X is, it can be associated 
to a binary variable 5 <G {0, 1} such as: X = (5 = 1). 

Therefore, (Williams, 1993) has shown that, in integer programming, connecting operators 
may be modelled by: 



(13) 



According to (Bemporad & Morari, 1998), the transformation into a standard linear problem 
can be achieved using lower and upper bounds of dom(f(x); x £ dom(x)) = dom(ax — b; x £ 
dom(x)) C [m, M]. Then, Binary variables can be connected to linear conditions as follows: 

5 = (ax - b < 0) 4-> < ~ r v ' (14) 

v ~ J \ ax-b > mS v y 

Consider for instance the statement a\X <b\ ^ a 2 x' < b 2 . Using the previous transformation, 
it can be formulated as: 

aix-bi < M(l-S) 
a\x — b\<md 
a 2 x' -b 2 < M(l - S) 
a 2 x' — b 2 < mS 

with dom(aix — b\',x e dom(x)) U dom(a 2 x f — b 2 ;x f <G dom(x f )) C [m,M]. 

In many cases, such as in presence of absolute values like in PMV evaluation, products of 

discrete and continuous variables appear. They have to be reformulated in order to get mixed 

linear problems. Auxiliary variables may be used for this purpose. First consider the product 

of 2 binary variables 8\ and S 2 : £3 = Si x S 2 . It can be transformed into a discrete linear 

problem: 

r -5 1 +s 3 < 

* x x J ~h + h < ,._, 

^^^ h+h-h < 1 (15) 

{ h,h, <%e{o,i} 

Consider now the product of a binary variable with a continuous variable: z = 5 x x where 
5 e {0, 1} and x <G [m,M]. It means that 3 = -» z = and J = 1 — )> z = x. Therefore, the 
semi-continuous variable z can be transformed into a mixed linear problem: 



S x x ^ < 



z < MxS 

z > mS 

z <x-m(l-<S) l ; 

z >x-M(l-S) 



These transformations can now be used to remove nonlinearities from the PMV computations, 
time shifting of services and power storage. 



88 



Energy Management 



4.2 Linearization of PMV 

Generally speaking, behavioral models of HVAC systems is given by Eq. (2) and an example is 
given by (3). Model (4) is already linear but nonlinearities come up with the absolute value of 
the PMV evaluation. Let's introduce a binary variable 8 a (k) satisfying S a (k) = 1 *-> T in (k) < 
T op t V7c. Then, the PMV function (7) can be reformulated into a mixed linear form for every 
service SRV(i): 



\PMV(T ia (k))\ 



s.(k) x ai x fryny + (1 _ Mk)) x ai x (^gg) 

F^k) + F 2 T a (k) + F 3 z a (k) + F 4 



(17) 



Using eq. (14) to transform the absolute value, the equivalent form of the condition that con- 
tains T a (k) < T p t is given by: 



T a (k) - T opt < (T max - T opt )(l - 5 a (k)) 



T a {k) - T opt >e+(T m 



L opt 



e)5 a {k) 



(18) 



A semi-continuous variable z a (k) is added to take place of the product S a (k) x T in (k) in eq. 
(17). According to eq. (16), the transformation of z a (k) = S a (k) x T in (k) leads to: 



Z a (k) < (T maX - T opt )8 a {k) 

z a (k) > {T min -T opt )5 a (k) 

z a (k) < T in (k) - (T min - T opt )(l-S a (k)) 

{ z a (k) >T in (k)-(T max -T opt )(l-S a (k)) 



(19) 



After the linearization of PMV, let's now consider the linearization of the time shifting of 
services. 

4.3 Formalizing time shifting 



Jduratio(i DUR&j) 



Jmin\1"> -V Jmax\1") J- J 




1 2 3 I 4 \5 6, 7 

□ I" ^~ I r~ n I 1 consumed 

I I I I U energy 

E(i,l,2) E(i,l,3) £?(*, 1,4) ^(z, 1,5) 
Fig. 5. Shift of temporary services 



Temporary services are modelled by finite state machines. The consumption of a state can be 
shifted such as task in scheduling problems. The starting and ending times of services can be 
synchronized to an anticipative period such as in (Duy Ha, 2007). It leads to a discrete-time 
formulation of the problem. However, this approach is both a restriction of the solution space 
and an approximation because the length of a time service has to be a multiple of A. The 
general case has been considered here. 



Home energy management problem: towards an optimal and robust solution 89 

In the scientific literature, continuous time formulations of scheduling problems exist (Cas- 
tro & Grossmann, 2006; Pinto & Grossmann, 1995; 1998). However, these results concerns 
scheduling problems with disjunctive resource constraints. Instead of computing the starting 
time of tasks, the aim is to determine the execution sequence of tasks on shared resources. 
In energy management problems, the matter is not restricted to determine such sequence be- 
cause several services can be achieved at the same time. 

An alternative formulation based on transformations (14) and (16), suitable for the energy 
management in housings, is introduced. 

Temporary services can be continuously shifted. Let DUR(i,i), f(i,j) and p(i,j) be respec- 
tively the duration of the state j of service SRV(i), the ending time and the power related to 
the service SRV(i) during the state ;'. /(/,;) is defined according to inhabitant comfort models: 
they correspond to extrema in the comfort models presented in section 3.2. 
According to (Esquirol & Lopez, 1999), the potential consumption /production duration (ef- 
fective duration if positive) d(i,j,k) of a service SRV(i) in state ; during a sampling period 
[kA, (k + 1)A] is given by (see figure 5): 

d{i,j,k) = min(/(i,;), (it + 1) A) - max (/(/,;) - DUR{i,j),kA) (20) 

Therefore, the consumption /production energy E(i,j, k) of the service SRV(i) in state ; during 
a sampling period [kA, (k + 1) A] is given by: 

EMK) = l dUk)Pii,i) iid{i ' j ' k)> ° (21) 

I otherwise 

E(i,j,k) can be modelled using a binary variable: Sto(i,j,k) = (d(i,j,k) > 0) and a semi- 
continuous variable zt (i,j,k) = S t o(i,j,k)d(i,j,k) such as in (14) and in (16). It leads to the 
following inequalities: 

(22) 
(23) 
(24) 
(25) 
(26) 
(27) 
(28) 

But the model still contains nonlinear functions min and max in the expression of d(i,j,k). 
Therefore, equation (20) has to be transformed into a mixed-linear form. Let's introduce 2 
binary variables 5 t \ (i, j, k) and S t 2(h j, k) defined by: 



d(i,j,k) 


< 


S t0 (i,j,k)KA 


d(i,j,k) 


> 


(S t0 (i,j,k)-1)KA 


E{i,j,k) 


= 


zt (i,j,k)p(i,j) 


zt (i,j,k) 


< 


S t0 (i,j,k)KA 


zt (i,j,k) 


> 


-S t0 {i,j,k)KA 


zt (i,j,k) 


< 


dfr;Vfc) + (l-MW/*))*A 


zt (i,j,k) 


> 


dfr;Vfc)-(l-MwV*))KA 



Using (14), it yields: 



5n(i, 


■/,*) = (f(i<i) 


- kA > 0) 


Stiih 


■i,V = (J {Ui) 


- DUR{i,j) - kA > 0) 




f(i,j)-kA 


< S a (i,j,k)KA 




/(»,;) -kA 


> (S n (i,j,k)-1)KA 


f(i,j) 


-DUR{i,j)-kA 


< 8 a {i,j,k)KA 


f(i,j) 


-DUR{i,j)-kA 


< (6 t2 (i,j,k)-l)KA 



(29) 
(30) 
(31) 
(32) 



90 Energy Management 

Therefore, min and max of equation (20) become: 

f min (i,j,k)=5 tl (i,j,k + l)(k + l)A+(l-5 tl (i,j,k + l))f(i,j) (33) 

s m ax{i,j,k) = S t2 (i,j,k)(f(i,j) - DUR(i,j)) + (1 -5f2(i,j,k))kA (34) 

with min (/(*,/), (k+ 1)A) = f m i n (i,j,k) and max (/(*,;) - DUR(i,j),kA) = s max (i,j,k). 
The duration d(i,j, k) can then be evaluated: 

d(i,j,k) = f m in(i,j,k) - s max (i,j,k) (35) 

Equations (22) to (35) model the time shifting of a temporary service. 

Let's now consider nonlinearities inherent to power storage services modelled by hybrid mod- 
els. 

4.4 Linearization of power storage 

A storage service SRV(i) with a maximum capacity of E™"* k can be modelled at time k by: 

E s tock(i,k) = max(min(Ef™ k ,E stock (i,k - 1) + E(i,k - 1)),0) 

Let's define the following binary variables: 5\(i,k) = {E stock {i,k) < E™^ k ) and $2(1, k) = 
(E stock (i, k) > 0) . Using (14), it yields: 

E stock {i,k)-E™ * k < (1 -*(,',*)) £*£ (36) 

Estock(i,k)-E™ > Sl(i,k)E™ k (37) 

Estockihk) < S 2 (i,k)E2* k (38) 

Estockihk) > p 2 (U)-l)ES (39) 

The stored energy can then be written: 

Estock(i,k) = S 1 (i,k- l)S 2 (i,k- 1) (E stock (i,k- 1) + E(i,k- 1)) . . . 
... + {l-8 1 {i,k))Ef^ k 

With variables £3 (i,k) = Si(i,k)52(i,k), z\(i,k) = S^(i / k)E stock (i / k) andz2(i,k) = 5^(i,k)E(i,k) 
and using transformations (15) and (16), the energy E stock {i,k) can be rewritten into a linear 
form: 

E stock {i,k)=z l {i,k-\)+z 2 {i,k-l) + (\-5 l (i,k))Ef t f ck (40) 

The following constraints must be satisfied: 



-*1 (»,*)+ *»(»,*) 


< 





(41) 


-S 2 (i,k) + S 3 (i,k) 


< 





(42) 


Si(i,k) + 8 2 {i,k) - S 3 (i,k) 


< 


1 


(43) 


Zl (i,k) 


< 


<%(U)EX 


(44) 


Zl (i,k) 


> 


-53(U)ES 


(45) 


Zl (i,k) 


< 


E stock (i,k) + (l-5 3 (i,k))E™Z k 


(46) 


Zl (i,k) 


> 


E 5tock (i,k)-(l-5 3 (i,k))EZ x ck 


(47) 


z 2 {i,k) 


< 


hihWTck 


(48) 


z 2 (i,k) 


> 


-h{i,k)E7o X ok 


(49) 


z 2 (i,k) 


< 


E(i,k) + (l-6 3 (i,k))E™ 


(50) 


z 2 (i,k) 


> 


E(i,k)-(l-S 3 (i,k))E2? k 


(51) 



Home energy management problem: towards an optimal and robust solution 91 



Equations (40) to (51) are a linear model of a power storage service. 

Main services have been modelled by mixed integer linear form. Other services can be mod- 
elled in the same way. Let's now focus on how to solve the resulting mixed integer linear 
problem. 

5. Solving approach 

Anticipative control in home energy management can be formulated as an multicriteria 
mixed-linear programming problem represented by a set of constraints and optimization cri- 
teria. 

5.1 Problem summary 

In a actual problem, the number of constraints is so large they cannot be detailed in this chap- 
ter. Nevertheless, the fundamental modelling and transformation principles have been pre- 
sented in sections 3 and 4. 

HVAC services are representative examples of permanent services. They have been modelled 
by equations like (4) and (19). The decision variables are heating powers <J> S (z, k). 
Temporary services, such as clothe washing, are modelled by equations like (22) to (35). The 
decision variables are the ending times: f(i,j). 

Storage services are modelled by equations like (40) to (51). The decision variables are energy 
exchange with the storage systems: E(i,j). 

Power supplier services are modelled by equations like (5). There is no decision variable for 
these services. 

These results can be adapted to fit most situations. If necessary, more details about modelling 
can be found in (Duy Ha, 2007). As a summary, the following constraints may be encountered: 

• linearized behavioral models of services 

• linearized comfort models related to end-user services 

In addition, a constraint modelling the production /consumption balance has to be added. 
Generally speaking, this constraint can be written: 

V/cG {1,...,X}, ^E(i,k) =0 (52) 

iez 

where X contains the indexes of available predictable services. 

If there is a grid power supplier modelled by a support service SRV(0), the imported en- 
ergy can be adjusted to effective needs (it is also true for fuel cells based support services). 
Therefore, E(0,k) has to be set to the maximum available energy for a sampling period: 
£(0, k) = p mflX (0, k) A where P max (0, k) stands for the maximum available power during sam- 
pling period k. Consequently, (52) becomes: 

V/cG {1,...,X}, ^E(i,k) >0 (53) 

iez 

All the predictable but not modifiable services provide data to the optimization problem. 
Their indexes are contained in x modi f iable C X. Decision variables are all related to predictable 
and modifiable services: they may be binary or continuous decision variables. The problem to 
be solved is thus a mixed-linear programming problem. Moreover, the optimization problem 
is a multi-criteria problem using the following criteria: economy, dissatisfaction, C02eq and 
autonomy criteria. 



92 Energy Management 

Economy criterion is given by (12) when there is only a grid power supplier and a photo- 
voltaic power supplier. Depending of the predictable support services Z su W ort * excluding 
photovoltaic power supplier and on the existence of photovoltaic power supplier SRV(0), 

jautonomy = W £ C(i,k)E(i,k) - C(0, k)E(0, k) j (54) 

k=l \i£Z su PP° rt * J 

where C(i, k) stands for the kWh cost of the support service i. 

Dissatisfaction criterion comes from expressions like (7) and (9). Let X end ~ user C X be the 

indexes of predictable end-user services. The comfort criteria may be given by: 

fscomfort = £ ^^ ^^ (55) 

i€lend-user 

The autonomy criterion comes from (11). It is given by: 

jautonomy = ^ ^ ^ }A(fc) (56) 

If there are several storage systems, the respective A(k) have to be summed up in the criterion 

jautonomy 

Finally, the C02 equivalent rejection can be computed like the autonomy criteria: 

jC02e q= <£ £ rco2 (i,k)E(i,k) (57) 

fc=l ielsupport 

where tqoi (h ^) stands for the C02 equivalent volume rejection for 1 kWh consummed by the 

support service i and Z su W ort gathers the indexes of predictable support services. 

All these criteria can be aggregated into a global criterion, a: -criterion approaches can also be 

used. 

5.2 Decomposition into subproblems 

In section 2.2, services have been split into permanent and temporary services. Let X tem ^ orar ^ 
be the indexes of modifiable and predictable temporary services. It is quite usual in hous- 
ing that some modifiable and predictable temporary services cannot occur at the same time, 
whatever the solution is. Using this property, the search space can be reduced. 
Let's defined the horizon of a service. 

Definition 1. The horizon of a service SRV(i), denoted H(SRV(i)), is a time interval in which 
SRV(i) may consume or produce energy. 

The horizon of a service SRV(i) is denoted: \H(SRV(i)),H(SRV(i))] C [0,K A]. A permanent 
service has an horizon equal to [0,KA]. A temporary service SRV(i) has an horizon given by 
H(SRV(i)) = s m i n (i) (the earliest starting of the service) and H(SRV(i)) = fmax(i) (the latest 
ending of the service). 

Only predictable and modifiable services are considered in the following because they contain 
decision variables. Two predictable and modifiable services may interact if and only if there 
is a non empty intersection between their horizons. 

Definition 2. Two predictable and modifiable services SRV(i) and SRV(j) are in direct temporal 
relation ifH(SRV(i)) fl H(SRV(j)) ^ 0. The direct temporal relation between SRV(i) and SRV(j) 

is denoted SRV(i), SRV(j) = 1 if it exists, and SRV(i), SRV(j) = otherwise. 



Home energy management problem: towards an optimal and robust solution 



93 



If H(SRV(i))r\H(SRV(j)) = 0, SRV(i) and SRV(j) are said temporally independent. Even 
if two services SRV(i) and SRV(j) are not in direct temporal relation, it may exists an indirect 
relation that can be found by transitivity For instance, consider an additional service SRV(l). 

If SRV(z),S£V(0 = 1, SRV(i),SRV(l) = 1 and SRV(i),SRV(j) = 0, SRV(i) and SRV(j) are 
said to be indirect temporal relation. 

Direct temporal relations can be represented by a graph where nodes stands for predictable 
and modifiable services and edges for direct temporal relations. If the direct temporal relation 
graph of modifiable and predictable services is not connected, the optimization problem can 
be split into independent sub-problems. The global solution corresponds to the union of sub- 
problem solutions (Diestel, 2005). This property is interesting because it may lead to important 
reduction of the problem complexity. 

6. Application example of the mixed-linear programming 

After the decomposition into independent sub-problems, each sub-problem related to a spe- 
cific time horizon can be solved using Mixed-Linear programming. The open source solver 
GLKP (Makhorin, 2006) has been used to solve the problem but commercial solver such as 
CPLEX (ILOG, 2006) can also be used. Mixed-Linear programming solvers combined a branch 
and bound (Lawler & Wood, 1966) algorithm for binary variables with linear programming 
for continuous variables. 

Let's consider a simple example of allocation plan computation for a housing for the next 24h 
with an anticipative period A =lh. The plan starts at 0am. Energy coming from a grid power 
supplier has to be shared between 3 different end-user services: 

• SRV(1) is a room HVAC service whose model is given by (3). According to the in- 
habitant programming, the room is occupied from 6pm to 6am. Out of the occupation 
periods, the inhabitant dissatisfaction D(l,k) is not taken into account. Room HVAC 
service is thus considered here as a permanence service. The thermal behavior is given 
by: 



Tenvihk + l) 



0.299 0.686 
0.203 0.794 



T in (l,k) 
lenv\±/k) m 



+ 



1.264 
0.336 



The comfort model of service SRV(1) in period k is 

22 -T in (i,k) 

'-'' = <l W) -22 



E(l,k) + 



0.015 0.44 
0.004 0.116 



T ext (k) 



if T in (i,k) <22 
if T in (i,k) >22 



(58) 



(59) 



The global comfort of service SRV(1) is the sum of comfort model of the whole period: 



d(i)=£d(U) 



(60) 



Service SRV (2) corresponds to an electric water heater. It is considered as a temporary 
preemptive service. Its horizon is given by H(SRV(2)) = [3,22]. The maximal power 
consumption is 2kW and 3.5kWh can be stored within the heater. 



94 Energy Management 

• SRV (3) corresponds to a cooking in an oven that lasts lh. It is considered as a temporary 
and modifiable but not preemptive service. It just can be shifted providing that the 
following comfort constraints are satisfied: f m i n (3) = 9 : 30am, f ma x(3) = 5pm, f ov t = 
2pm where / mz - w , fmax and f pt stand respectively for the earliest acceptable ending time, 
the latest acceptable ending time and the preferred ending time. The cooking requires 
2kW. The global comfort of service SRV (2) is: 

°( 3 H 2(14- f (3)) (61) 

I ( 9 f{)) if /0) < 14 

• SRV (4) is a grid power supplier. There is 2 prices for the kWh depending on the time of 
day. The cost is defined by a function C(4,fc). The energy used is modelled by E(4,k). 
The maximum subscribed power is E mflX (4) = 4/cW. 

The consumption /production balance leads to: 

3 

^E(i,k)<E max (4) (62) 

z'=l 

The objective here is to minimize the economy criterion while keeping a good level of comfort 
for end-user services. The decision variables correspond to: 

• the power consumed by SRV(1) that correspond to a room temperature 

• the interruption SRV(2) 

• the shifting of service SRV (3) 

The chosen global criterion to be minimized is: 

/ = £ (E(4,fc)C(4,fc)) + D(l) + D(3) (63) 

fc=l 

The analysis of temporal relations points out a strongly connected direct temporal relation 
graph: the problem cannot be decomposed. The problem covering 24h yields a mixed-linear 
program with 470 constraints with 40 binary variables and 450 continuous variables. The 
solving with GLPK led to the result drawn in figure 6 after 1.2s of computation with a 3.2Ghz 
Pentium IV computer. Figure 6 points out that the power consumption is higher when energy 
is cheaper and that the temperature in the room is increased before the period where energy 
is costly in order to avoid excessive inhabitant dissatisfaction where the room is occupied. 
In this case of study, a basic energy management is also simulated. In assuming that: the 
service SVR(1) is managed by the user; the heater is turned on when the room is occupied 
and turned off in otherwise. The set point temperature is set to 22fC. The the water heating 
service SVR(2) is turned on by the signal of off-peak period (when energy is cheaper). The 
cooking service SVR(3) is programmed by user and the ending of service is 2pm. The result 
of this simulation is presented in figure 8. 

The advanced management reaches the objective of reducing the total cost of power consump- 
tion (-22%). The dissatisfactions of the services SVR(1) and SVR(3) reach a good level in com- 
parison with the basic management strategy. Indeed, a If C shift from the desired temperature 
during one period leads to a dissatisfaction of 0.2 and a dissatisfaction of 0.22 corresponds to 



Home energy management problem: towards an optimal and robust solution 



95 




solar radiance 



$ 0,050 



prediction of ourdoor temperature 




2 3 4 5 6 7 



15 16 17 18 



time in hours 

20 21 22 23 24 



Fig. 6. Considered weather and energy cost forecasts 





Heater 








24,0 








23,5 








o 23 '° 
























1- 21,5 




21,0 












-c 1,5 

* I0 








0,5 


J-. 








LU 


.ill 








,— <— 1 



10 12 14 16 18 20 22 24 

Time (h) 







Widrawal Power from Grid Network 


3,5 














3,0 








2,5 








5 












^ 2 '° 

2 1,5 
LU 












1,0 












0,5 






n 

















10 12 14 16 18 20 22 24 

Time (h) 



T indoor — Twall — Energy Consumption 



— Produced Energy 





Oven 




1,0 








0,5 
0,0 










2,0 








xT 1,5 








< 
























u> 1,0 
















CD 








C 








^ 0,5 









10 12 14 16 

Time (h) 



20 22 24 



— Operation — Energy Consumption 





Water Heating 


2,00 

1,75 

1,50 

| 1,25 

E? 1,00 

CD 

lS 0,75 

0,50 

0,25 

0,00 
( 
















































































































































































2 4 


6 8 10 12 14 1 

Time (h) 


6 18 20 22 24 










— Energy Consumption 







Fig. 7. Results of the advanced energy management strategy computed by GLPK 



96 



Energy Management 





Heater 






22,5 

s 22 '° 

E 21,5 


















CD 

h- 

21,0 








■E -i n 






E? 0,5 










LU 


1 



10 12 14 16 

Time (h) 



20 22 24 



- Energy Consumption 









Oven 










1,0 

0,5 
0,0 
































2,0 

I 1 ' 5 

p 1,0 
£ 0,5 



















































8 10 12 14 16 

Time (h) 



20 22 24 



2,25 

2,00 

1,75 

"I 1,50 

2 1,00 
LU 

0,75 

0,50 

0,25 

0,00 



2,00 
1,75 ' 
1,50 
| 1,25 

E? 1,00 

CD 

W 0,75 
0,50 
0,25 
0,00 





Widrawal Power from Grid Network 




























































^u 

















8 10 12 14 16 18 20 22 24 

Time (h) 



— Produced Energy 
Water Heating 



10 12 14 16 18 20 22 24 

Time (h) 



— Operation — Energy Consumption 



- Energy Consumption 



Fig. 8. Results of the basic energy management strategy 



a 1 hour delay for the cooking service. The basic management lead to an important dissatis- 
faction regarding the service SVR(1), the heater is turned on only when the room is occupied. 
It lead to a dissatisfaction in period [6pm,7pm\. The cooking service SVR(3) is shifted one 
hour sooner by the advanced management strategy for getting the off-peak tariff. The total 
energy consumption of advanced management is slightly higher than the one of basic man- 
agement strategy(+3%) but in terms of carbon dioxid emission, an important reduction (-65%) 
is observed. Thanks to an intelligent energy management strategy, economical cost and envi- 
ronmental impact of the power consumption have been reduced. 

In addition, different random situations have been generated to get a better idea of the per- 
formance (see table 1). The computation time highly increases with the number of binary 
variables. Examples 3 and 4 show that the computation time does not only depend on the 



Strategy of 

energy management 


Total 
cost 


Energy 
consumption 


C02 

emission 


D(l) 


D(3) 


Basic management 


1.22euros 


13.51kWh 


3452.2g 


0.16 


0.00 


Advanced management 


0.95euros 


13.92kWh 


1216.2g 


0.20 


0.22 



Table 1. Comparison between the two strategies of energy management 



Home energy management problem: towards an optimal and robust solution 



97 



number of constraints and of variables. Example 5 fails after one full computation day with 
an out of memory message (there are 12 services in this example). 

Mixed-linear programming manages small size problems but is not very efficient otherwise. 
The hybrid meta-heuristic has to be preferred in such situations. 



Example 


Number of 


Number of 


Computation 


number 


variables 


constraints 


time 


1 


201 continuous, 12 binary 


204 


1.2s 


2 


316 continuous, 20 binary 


318 


22s 


3 


474 continuous, 24 binary 


479 


144s 


4 


474 continuous, 24 binary 


479 


32m 


5 


1792 continuous, 91 binary 


1711 


>24h 



Table 2. Results of random problems computed using GLPK 



7. Taking into account uncertainties 

Many model parameters used for prediction, such as predicting the weather information, are 
uncertain. The uncertainties are also present in the optimization criterion. For example, the 
criterion corresponding to thermal sensation depends on air speed, the metabolism of the 
human body that are not known precisely. 

7.1 Sources of uncertainties in the home energy management problem 

There are two main kinds of uncertainties. The first one comes from the outside like the 
one related to weather prediction or to the availability of energy resources. The second one 
corresponds to the uncertainty which come from inside the building. Reactive layer of the 
control mechanism manages uncertainties but some of them can be taken into account during 
the computation of robust anticipative plans. 

The weather prediction naturally contains uncertainties. It is difficult to predict precisely the 
weather but the outside temperature or the level of sunshine can be predicted with confident 
intervals. The weather prediction has a significant impact on the local production of energy 
in buildings. In literature, effective methods to predict solar radiation during the day are 
proposed. Nevertheless, the resulting predictions may be very different from the measured 
values. It is indeed difficult to predict in advance the cloud in the sky. Uncertainties about the 
prediction of solar radiation have a direct influence on the consumption of services such as 
heating or air conditioning systems. Moreover, it can also influence the total available energy 
resource if the building is equipped with photovoltaic panels. 

The disturbances exist not only outside the building but also in the building itself. A home 
energy management system requires sensors to get information on the status of the system. 
But some variables must be estimated without sensor: for example metabolism of the body of 
the inhabitants or the air speed in a thermal zone. More radically, there are energy activities 
that occur without being planned and change the structure of the problem. In the building, 
the user is free to act without necessarily preventing the energy management system. The 
consumption of certain services such as cooking, lighting, specifying the duration and date of 
execution remain difficult to predict. The occupation period of the building, which a strong 
energy impact, also varies a lot. 
Through a brief analysis, sources of uncertainties are numerous, but the integration of all 



98 Energy Management 

sources of uncertainties in the resolution may lead to very complex problem. All the uncer- 
tainties cannot be taken into account at the same time in the anticipative mechanism: it is 
better to deal firstly with disturbances that has a strong energy impact. The sources of uncer- 
tainty have been classified according to two types of disturbances: 

• The first type of uncertainty corresponds to those who change the information on the 
variables of the problem of energy allocation. The consequence of such disturbances is 
generally a deterioration of the actual result compared to the computed optimal solu- 
tion. 

• The second type corresponds to the uncertainties that cause the most important dis- 
turbances. They change the structure of the problem by adding and removing strong 
constraints. The consequence in the worst case is that the current solution is no longer 
relevant. 

In both cases, the reactive mechanism will manage the situations in decreasing user satisfac- 
tion. If the anticipative plan is robust, it will be easier for the reactive mechanism to keep user 
satisfaction high. 

7.2 Modelling uncertainty 

A trail of research for the management of uncertainties is stochastic optimization, which 
amounts to represent the uncertainties by random variables. These studies are summarized in 
Greenberg & Woodruf (1998). Billaut et al. (2005b) showed three weak points of these stochas- 
tic methods in the general case: 

• The adequate knowledge of most problems is not sufficient to infer the law of probabil- 
ity, especially during initialization. 

• The source of disturbances generally leads to uncertainty on several types of data at 
once. The assumption that the disturbances are independent of each other is difficult to 
satisfy. 

• Even if you come to deduce a stochastic model, it is often too complex to be used or 
integrated in a optimization process. 

An alternative approach to modelling uncertainty is the method of intervals for continuous 
variables: it is possible to determine an interval pillar of their real value. You can find this 
approach to the problem of scheduling presented in Dubois et al. (2003; 2001). Aubry et al. 
(2006); Rossi (2003) have used the all scenarios-method to model uncertainty in a problem of 
load-balancing of parallel machines. The combination of three types of models (stochastic 
model, scenario model, interval model) is also possible according to Billaut et al. (2005b). 
In the context of the home energy management problem, stochastic methods have not been 
used because ensuring an average performance of the solution is not the target. For example, 
an average performance of user's comfort can lead to a solution which is very unpleasant 
at a time and very comfortable at another time. The methods based on intervals appear to 
be an appropriate method to this problem because it is a min-max approach. For example, 
uncertainty about weather prediction as the outside temperature T ext can be modelled by 
an interval T ex t £ [Text, T e xt\ • The modelling of an unpredictable cooking whose duration 
is p £ [0.5/z,3/z] and the execution date is in the interval s (i) £ [18h,22h]. Similarly, the 
uncertainty of the period of occupation of the building or other types of disturbances can be 
modelled. 



Home energy management problem: towards an optimal and robust solution 



99 



7.3 Introduction to multi-parametric programming 

The approach taking into account uncertainties is to adopt a three-step procedure like schedul- 
ing problems presented in Billaut et al. (2005a): 

• Step 0: Solving the problem in which the parameters are set to predict their most likely 
value. 

• Step 1: Solving the problem, where uncertainties are modelled by intervals, to get a 
family of solutions. 

• Step 2: Choosing a robust solution from among those which have been computed at 
step 1. 

The main objective is to seek a solving method for step 1. A parametric approach may be 
chosen for calculating a family of solutions that will be used by step 2. 

The parametric programming is a method for solving optimization problem that character- 
izes the solution according to a parameter. In this case, the problem depends on a vector of 
parameters and is referred to as a Multi-Parametric programming (MP). The first method 
for solving parametric programming was proposed in Gass & Saaty (1955), then a method 
for solving muti-parametric has been presented in Gal & J.Nedoma (1972). Borrelli (2002); 
Borrelli et al. (2000) have introduced an extension of the multi-parametric programming for 
the multi-parametric mixed-integer programming: a geometric method programming. The 
multi-parametric programming is used to define the variables to be optimized according to 
uncertainty variables. 

Formally, a MP-MILP is defined as follows: let x c be the set of continuous variables, and x d be 
the set of discrete variables to be optimized. The criterion to be minimized can be written as: 



J(x c ,x d ) = Ax c + Bx d 
subject to 

[ F G H ] 6 

I X d . 



(64) 



< W 



where 6 is a vector of uncertain parameters. 

Definition 1 A polytope is defined by the intersection of a finite number of bounded 

~ X c 



half-spaces. An admissible region P is a polytope of 



on which each point can generate 



an admissible solution to the problem 64. 
the values of x d e dom(x d ): 



Xc 



belongs to a family of polytopes defined by 



p(*d) 



(x c ,0)\ [F G H 



x,i 



< W 



(65) 



In this family of polytopes, the optimal regions are defined as follows: 



Definition 2 The optimal region P* (x d ) C P is the subset of P(x^), in which the problem 64 
admits at least one optimal solution. P* (x d ) is necessarily a polytope because: 

• a polytope is bounded by hyperplans which can lead to edges that are polytopes 

• a polytope is a convex hypervolume 



100 



Energy Management 



The family of the optimal region P* (x d ): 



F*(x d )={{x c ,0)\ 



[ F G H } 



x d 



< W 



(66) 



J(x* = min(Ax c + Bx d ) 



This family of spaces P*(x d ) with x d e dom(x d ) can be described by an optimal function 

Z(x c ,x d ). 

To determine this function Z, different spaces are defined, some of which correspond to the 

space of definition of this function Z. 

Definition 3 The family of the admissible regions for 9 is defined by: 



S a (x d )= le\3x c sbj.to [F G H } 



Xd 



< W 



(67) 



Definition 4 The family of the optimal regions for 6 is a subset of the family S a (x d ) 

X C 



®*aM 



6\3x* sbj. to< 



[ F G H 



x d 



< W 



(68) 



J(x*) = min(Ax c + Bx d ) 

x c 

Definition 5 The family of the admissible regions for x c is defined by: 



Xa(*d)= \ x c\3e sbj.to [ F G H } 



x d 



< W 



(69) 



Definition 6 The family of the optimal regions for x c is a subset of the family X a (x d ): 

X C 



KM 



x*\36 sbj. to 



[ F G H ] 



Xd 



< W 



J(x* = mm(Ax c + Bx d ) 



(70) 



Definition 7 The objective function represents the family of optimal regions P* (x d ) which was 
defined in 65. It is defined by X* (x d ) to 0* (x d ), which were defined in 70 and 68 respectively: 



Z(x c ,x d ):X;(x d )^®* a (x d ) 



(71) 



Definition 8 The critical region RC m (x d ) is a subset of the space P* (x d ) where the local con- 
ditions of optimality for the optimization criterion remain immutable, i.e, that the function 
optimizer Z m (x C/ x d ) : X*(x d ) \-^ ©l(x d ) is unique. RC m ( x d) is determined by doing the 
union of different optimal regions P* (x d ) which has the same optimizer function. 
The purpose of the linear multi-paramatric mixed-integer programming is to characterize the 
variables to optimize x C/ x d and the objective function according to 6. The principle for solving 
the MP-MILP is summarized by two next steps: 



Home energy management problem: towards an optimal and robust solution 



101 



• First step: search in the region of parameters the smallest sub-space of P which con- 
tains the optimal region P*(x^). Then, determine the system of linear inequalities ac- 
cording to 6 which defines F. 

• Second step: determine the set of all critical regions: the region P is divided into 
sub-spaces RC m (x^) <G P*(x^). In the critical region RC m (xd), the objective function 
Z^ l (x C/ x ( f) remains a unique function. After determining the family of critical regions 
RC m (xd), the piecewise affine functions of Z^(x c ,x rf ) that characterize x C/ x^ according 
to is found. After refining the critical regions by grouping sub-spaces RC m ,we can get 
minimal facades which characterize the critical region. 

7.4 Application to the home energy management problem 

After having introduced multi-parametric programming, the purpose of this section is to 
adapt this method to the problem of energy management. As shown before, the problem 
of energy management in the building can be written as: 



J= (A1.Z + B1.J + D1) 
A 2 .z + B 2 .S + C 2 .x < C 



(72) 



where z £ Z is the set of continuous variables and S £ A is the set of binary variables resulting 
from the logic transformation see section 4. Uncertainties can be modelled by intervals G 0. 
Assuming that the uncertainties are bounded, so 

< 6 < 6 (73) 

The family of solutions of the problem taking into account the uncertainties is generated by 
parametric programming. To illustrate this method, two examples are proposed. 
Example 1. Consider a thermal service supported by an electric heater with a maximum 
power of 1.5 kW. T a is the indoor temperature and T m is the temperature of the building 
envelope with an initial temperatures T a (0) =22fC and T m (0) = 22fC. A simplified thermal 
model of a room equipped with a window and a heater has been introduced in Eq. (3). 
The initial temperatures are set to T fl (0) = 21°C, T w (0) = 22°C. The thermal model of the 
room after discretion with a sampling time equal to 1 hour is: 



T a (k + 1) 




0.364 0.6055 




" T a (k) 






T m (k+1) 




0.359 0.625 




T m (k) 








" 0.0275 1.1966 0.4193 " 




Text 
(pr 
(ps 




+ 


0.016 0.7 




0.2434 





(74) 



Supposing that the function of thermal satisfaction is written in the form: 



U(k)=6 a (k).a 1 . 



L o-pt 



T a (k) 



I- opt 



+ {l-8 a {k)).a 2 . 



*-opt 



Uk) 



L o-pt 



L Max 



where: 



S a (k): binary variable verifying [5 a (k) = 1] O [T a (k) < T pt] ,V7c 

T pt: 'ideal' room's temperature for the user. 

iTmin/ Th/iaxY tne area of the value of room's temperature. 



(75) 



102 Energy Management 

• a\, ai'> are two constant that reflect the different between the sensations of cold or hot. 
with T opt = 22° C, T min = 20° C, T Max = 24° C and a\ = a 2 = 1. 

It is assumed that there was not a precise estimate of the outdoor temperature T but it is 
possible to set that the outdoor temperature varies within a range: [—5°C, -\-5°C] . The average 
energy assigned to the heater over a period of 4 hours to minimize the objective function is: 

J=rtu(k)j (76) 

The parametric programming takes into account uncertainties on the outdoor temperature. 
An implementation of multi-parametric solving may be done using a toolbox called Multi 
Parametric Toolbox MPT with the programming interface named YALMIP solver developed 
by Lofberg (2004). The resolution of the example 1 takes 3.31 seconds on using a computer 
Pentium IV 3.4 GHz. The average energy assigned to the heater according to the temperature 
outside is: 

f 1.5 if - 5 < T ext < -0.875 
fr{ } \ -0.097 x T ext + 1.415 if - 0.875 < T ext < 5 { } 

The parametric programming divided the uncertain region into two critical regions. The first 
region corresponds to the zone: — 5 < T ex t < —0.875. The optimal solution is to put the heater 
to the maximum level in order to approach the desired temperature. In the second critical 
region, —0.875 < T ex t < 5, the energy assigned to the heater is proportional to the outdoor 
temperature. The higher the outside temperature is, the less energy is assigned to the radiator. 
In fact, T ext = —0.875 is the point of the system where the maximum power generated by the 
radiator can compensate the thermal flow lost through the building envelope. 
Example 2. This example is based on example 1 but with additional uncertainties on sources. 
In this example, the disturbance caused by the user have been simulated. It is assumed that in 
the 3rd and 4th periods of the resource assignment plan, it is likely that a consumption may 
occur. Accordingly, the available energy during the periods 3 and 4 is between and 2k Wh. 
A parametric variable E m ax € [0, 2] and a constraint are added as follows: 

(f r (3) + tf> r (4) <E max (78) 



-'max] 



The optimal solution of the problem must be computed based on two variables [T ex ^, E n 
This example has still been solved using the MPT tool. This time, the solver takes 5.2 seconds. 
The average energy assigned for the period 1, (priX), is independent of the variable E max . It 
means that whatever happens on the energy available during periods 3 and 4, the decision to 
the period 1 can not improve the situation: 

1 , - f [-5 < Text < -0.875" 
L < E max < 2 

-0.097 x T ext + 1,415 if 



PrW 



-0.875 < T ext < 5] (7y) 

0<E max <2 



The energy assigned to the heater in the second period (p r {2) is a piecewise function which 
consists of five different critical areas. Among these five regions (fig.9), we see that the opti- 
mal solution assigns the maximum energy to the heater in three regions. By anticipating the 
availability of resources in periods 3 and 4, the comfort is improved in the heating zone. This 
result corresponds to the conclusion found in Ha et al. (2006a). During periods 3 and 4, the 



Home energy management problem: towards an optimal and robust solution 



103 



Fig. 9. Piecewise function of (p r (k) following 




consumption of radiator is less important than for the periods 1 and 2. A robust solution is 
obtained despite the disturbance of the resource and the outside temperature. However, in 
the critical region 5 (Fig.9), there is an extreme case in which it is very cold outside and there 
is simultaneously a large disturbance on the availability of the resource. The only solution is 
to put (p r (k) to the maximum value although there is a deterioration in the comfort of user. 
After generating the family of solutions at step 1, an effective solution must be chosen dur- 
ing step 2. Knowing that the optimal solutions of step 1 are piecewise functions limited by 
critical regions, therefore the procedure of selecting a solution now is to select a piecewise 
function. The area of research is therefore reduced and the algorithm of step 2 requires few 
computations. A min-max approach is used to find a robust solution among the family of so- 
lutions. A polynomial algorithm that comes in the different critical regions to find a solution 
that optimizes the criterion is used: 



/* = (Max(J(6))\eeV*) 



(80) 



8. Conclusion 

This chapter presents a formulation of the global home electricity management problem, 
which consists in adjusting the electric energy consumption /production for habitations. A 
service oriented point of view has been justified: housing can be seen as a set of services. A 
3-layer control mechanism has been presented. The chapter focuses on the anticipative layer, 
which computes optimal plannings to control appliances according to inhabitant request and 
weather forecasts. These plannings are computed using service models that include behav- 
ioral, comfort and cost models. 

The computation of the optimal plannings has been formulated as a mixed integer linear pro- 
gramming problem thanks to a linearization of nonlinear models. A method to decompose 
the whole problem into sub-problems has been presented. Then, an illustrative application 
example has been presented. Computation times are acceptable for small problems but it in- 
creases up to more than 24h for an example with 91 binary variables and 1792 continuous 
ones. Heuristics has to be developed to reduce the computation time required to get a good 
solution. 



104 Energy Management 



Even if uncertainties can be managed by the reactive layer, an approach that takes into account 
uncertainties model by intervals from the anticipative step has been presented. It is an adap- 
tation of the multi-parametric programming. It leads to robust anticipative plans. But this 
approach is useful of biggest uncertainties because it is difficult to apprehend a large number 
of uncertainties because of the induced complexities. 

9. References 

Abras, S., Ploix, S., Pesty, S. & Jacomino, M. (2006). A multi-agent home automation sys- 
tem for power management, The 3rd International Conference on Informatics in Control, 
Automation and Robotics, Setubal, Portugal. 

AFNOR (2006). Ergonomie des amniances thermiques , determination analytique et interpre- 
tation du confort thermique par le calcul des indices PMV et PDD et par des critere 
de confort thermique local, Norme europeenne, norme francaise . 

Angioletti, R. & Despretz, H. (2003). Maitrise de l'energie dans les batiments -techniques, 
Techniques de Vingenieurs . 

Aubry, A., Rossi, A., Espinouse, M.-L. & Jacomino, M. (2006). Minimizing setup costs for 
parallel multi-purpose machines under load-balancing constraint, European Journal 
of Operational Research, in press, doi:10.1016/j.ejor.2006.05.050 . 

Bemporad, A. & Morari, M. (1998). Control of systems integrating logic, dynamics and con- 
straints, Automatica 35: 407-427. 

Billaut, J.-C, Moukrim, A. & Sanlaville, E. (2005a). Flexibilite et Robustesse en Ordonnancement, 
Hermes Science, Paris, France. 

Billaut, J.-C, Moukrim, A. & Sanlaville, E. (2005b). Flexibilite et Robustesse en Ordonnancement, 
Hermes Science, Paris, France, chapter 1. 

Borrelli, F. (2002). Discrete Time Constrained Optimal Control, PhD thesis, Swiss Federal Institute 
of technilogy (EHT) Zurich. 

Borrelli, E, Bemporat, A. & Morari, M. (2000). A geometric algorithme for multi-parametric 
linear programming, Technical report, Automatic Control Laboratory ETH Zurich, 
Switzerland. 

Castro, P. M. & Grossmann, I. E. (2006). An efficient mipl model for the short-term scheduling 
of single stage batch plants, Computers and Chemical Engineering 30: 1003-1018. 

Diestel, R. (2005). Graph Theory Third Edition, Springer Verlag, Heidelberg. 

Dubois, D., Fargier, H. & Fortemps, P. (2003). Fuzzy scheduling: Modeling flexible con- 
straints vs. coping with incomplete knowledge, Euroupean Journal of Operational Re- 
search 147: 231-252. 

Dubois, D., Fortemps, P., Pirlot, M. & Prade, H. (2001). Leximin optimality and fuzzy set- 
theoretic operations, European Journal of Operational Research 130: 20-28. 

Duy Ha, L. (2007). Un systeme avance de gestion d'energie dans le batiment pour coordonner produc- 
tion et consommation, PhD thesis, Grenoble Institute of Technology, Grenoble, France. 

Esquirol, P. & Lopez, P. (1999). E 'Ordonnancement, Economica, chapter 5 Ordonnancement 
sous contraintes de ressources cummulatives, p. 87. 

Gal, T. & J.Nedoma (1972). Multiparametric linear programming, Management Science 18: 406- 
442. 

Gass, S. & Saaty, T. (1955). The computatinal alogorithm for the parametric objective function, 
Naval Reseach Eogistices Quarterly 2: 39-45. 



Home energy management problem: towards an optimal and robust solution 105 

Greenberg, H. & Woodruf, D. (1998). Advances in Computational and Stochastic Optimization, 
Logic Programming and Heuristic Search: Interfaces in Computer Science and Operations 
Research, Kluwer Academic Publishers, Norwell, MA, USA, chapter 4. 

Ha, D. L., Ploix, S., Zamai, E. & Jacomino, M. (2006a). A home automation system to improve 
the household energy control, INCOM2006 12th IFAC Symposium on Information Con- 
trol Problems in Manufacturing. 

Ha, D. L., Ploix, S., Zamai, E. & Jacomino, M. (2006b). Tabu search for the optimization of 
household energy consumption, The 2006 IEEE International Conference on Information 
Reuse and Integration IEEE IRI 2006: Heuristic Systems Engineering September 16-18, 
2006, Waikoloa, Hawaii, USA. 

Henze, G. P. & Dodier, R. H. (2003). Adaptive optimal control of a grid-independent photo- 
voltaic system, Transactions of the ASME 125: 34-42. 

House, J. M. & Smith, T. F. (1995). Optimal control of building and hvac systems, Proceddings 
of the American Control Conference, Seattle, Washington. 

ILOG (2006). CPLEX tutorial handout, Technical report, ILOG. 

Lawler, E. & Wood, D. (1966). Branch-and-bound methods: a survey, Operations Research 
14: 699-719. 

Lofberg, J. (2004). YALMIP : A toolbox for modeling and optimization in MAT- 
LAB, Proceedings of the CACSD Conference, Taipei, Taiwan. Available from 
http : //control . ee . ethz . ch/~ joloef /yalmip . php. 

Madsen, H. (1995). Estimation of continuous-time models for the heat dynamics of a building, 
Energy and Building . 

Makhorin, A. (2006). GNU linear programming kit reference manual version 4.11, Technical 
report, GNU Project. 

Muselli, M., Notton, G., Poggi, P. & Louche, A. (2000). Pv-hybrid power system sizing incor- 
porating battery storage: an analysis via simulation calculations, Renewable Energy 
20:1-7. 

Nathan, M. (2001). Building thermal performance analysis by using matlab/simulink, Seventh 
International IBPSA Conference, Rio de Janeiro, Brazil. 

Palensky, P. & Posta, R. (1997). Demand side management in private home using lonworks, 
Proceedings. 1997 IEEE International Workshop on Factory Communication Systems. 

Pinto, J. M. & Grossmann, I. (1995). A continuous time mixed integer linear programming 
model for short term scheduling of multistage batch plants, Industrial and Engineering 
Chemistry Research 35: 338-342. 

Pinto, J. M. & Grossmann, I. E. (1998). Assignment and sequencing models for the scheduling 
of process systems, Annals of Operations Research 81: 433-466. 

Rossi, A. (2003). Ordonnancement en milieu incertain, mise en oeuvre d'une demarche robuste, 
PhD thesis, Ecole Doctorale EEATS " Electronique, Electrotechnique, Automatique 
& Traitement du Signal", INPGrenoble. 

Wacks, K. (1993). The impact of home automation on power electronics, Applied Power Elec- 
tronics Conference and Exposition, pp. 3 - 9. 

Williams, H. P. (1993). Model building in mathematical programming, New York: Wiley. 

Zhou, G. & Krarti, M. (2005). Parametric analysis of active and passive building thermal 
storage utilization, Journal of Solar Energy Engineering 127: 37-46. 



106 Energy Management 



Passivity-Based Control and Sliding Mode 

Control applied to Electric Vehicles based on 

Fuel Cells, Supercapacitors and Batteries 

on the DC Link 

M. Becherif 1 ' 2 , M. Y. Ayad 1 , A. Henni 3 , M. Wack 1 , A. Aboubou 4 , 

A. Allag 4 and M. Sebai 4 

1 SeT Laboratory, UTBM University, France 

2 FC-Labfuel Cell Laboratory, UTBM University, France 

3 Alstom Power System, Energy Management Business, France 

4 LMSE Laboratory, Biskra University, Algeria 



1. Introduction 

Fuel Cells (FC) produce electrical energy from an electrochemical reaction between a 
hydrogen-rich fuel gas and an oxidant (air or oxygen) (Kishinevsky & Zelingher, 2003) 
(Larminie & Dicks, 2000). They are high-current, and low-voltage sources. Their use in 
embedded systems becomes more interesting when using storage energy elements, like 
batteries, with high specific energy, and supercapacitors (SC), with high specific power. In 
embedded systems, the permanent source which can either be FCs or batteries must 
produce the limited permanent energy to ensure the system autonomy (Pischinger et al., 
2006) (Moore et al., 2006) (Correa et al., 2003). In the transient phase, the storage devices 
produce the lacking power (to compensate for deficit in power required) in acceleration 
function, and absorbs excess power in braking function. FCs, and due to its auxiliaries, have 
a large time constant (several seconds) to respond to an increase or decrease in power 
output. The SCs are sized for the peak load requirements and are used for short duration 
load levelling events such as fuel starting, acceleration and braking (Rufer et al, 2004) 
(Thounthong et al., 2007). These short durations, events are experienced thousands of times 
throughout the life of the hybrid source, require relatively little energy but substantial 
power (Granovskii et al.,2006) (Benziger et al., 2006). 

Three operating modes are defined in order to manage energy exchanges between the 
different power sources. In the first mode, the main source supplies energy to the storage 
device. In the second mode, the primary and secondary sources are required to supply 
energy to the load. In the third, the load supplies energy to the storage device. 
In this work, we present a new concept of a hybrid DC power source using SCs as auxiliary 
storage device, a Proton Exchange Membrane Fuel Cell (PEMFC) as the main energy source. 
The source is also composed of batteries on a DC link. The general structure of the studied 
system is presented and a dynamic model of the overall system is given. Two control 



108 



Energy Management 



techniques are presented. The first is based on passivity based control (PBC) (Ortega et al. 
2002). The system is written in a Port Controlled Hamiltonian (PCH) form where important 
structural properties are exhibited (Becherif et al., 2005). Then a PBC of the system is 
presented which proves the global stability of the equilibrium with the proposed control 
laws. The second is based on nonlinear sliding mode control for the DC-DC supercapacitors 
converter and a linear regulation for the FC converter (Ayad et al. 2007). Finally, simulation 
results using Matlab are given 

2. State of the art and potential application 
2.1. Fuel Cells 
A. Principle 

The developments leading to an operational FC can be traced back to the early 1800's with 

Sir William Grove recognized as the discoverer in 1839. 

A FC is an energy conversion device that converts the chemical energy of a fuel directly into 

electricity. Energy is released whenever a fuel (hydrogen) reacts chemically with the oxygen 

of air. The reaction occurs electrochemically and the energy is released as a combination of 

low-voltage DC electrical energy and heat. 

Types of FCs differ principally by the type of electrolyte they utilize (Fig. 1). The type of 

electrolyte, which is a substance that conducts ions, determines the operating temperature, 

which varies widely between types. 

Hydrogen 

I 



H,H>2H + +2e~ 



Acid Electrolyte 



Cathode -0 2 +2e~ + 2H + ->H 2 



Oxygen 
(air) 
Hydrogen 



Anode H 2 +20H _ -> 2H 2 + 2e~ 



Alkaline Electrolyte 



Cathode -0 2 +2e+H 2 -> 2 OH" 



! I 

Oxygen 
(air) 

Fig. 1. Principle of acid (top) and alkaline (bottom) electrolytes fuel cells 

Proton Exchange Membrane (or " solid polymer") Fuel Cells (PEMFCs) are presently the 
most promising type of FCs for automotive use and have been used in the majority of 
prototypes built to date. 

The structure of a cell is represented in Fig. 2. The gases flowing along the x direction come 
from channels designed in the bipolar plates (thickness 1-10 mm). Vapour water is added to 
the gases to humidify the membrane. The diffusion layers (100-500 urn) ensure a good 
distribution of the gases to the reaction layers (5-50 urn). These layers constitute the 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



109 



electrodes of the cell made of platinum particles, which play the role of catalyst, deposited 
within a carbon support on the membrane. 



Reaction layers. 



Membrane 



Hydrogen and 
vapor water 



c. 



: :3 — 
'a 

'■—I <u 

■.J -a 

a I 
a 5 
a 
a 



Air and 
vapor water 



Bipolar plates \ / Bipolar plates 

Diffusion layer 



Fig. 2. Different layers of an elementary cell 
Hydrogen oxidation and oxygen reduction: 



H 



2H + +2e" 
1 



2H + +2e"+-0 



H 2 



anode 



cathode 



a) 



The two electrodes are separated by the membrane (20-200 jim) which carries protons from 
the anode to the cathode and is impermeable to electrons. This flow of protons drags water 
molecules as a gradient of humidity leads to the diffusion of water according to the local 
humidity of the membrane. Water molecules can then go in both directions inside the 
membrane according to the side where the gases are humidified and to the current density 
which is directly linked to the proton flow through the membrane and to the water produced 
on the cathode side. 

Electrons which appear on the anode side cannot cross the membrane and are used in the 
external circuit before returning to the cathode. Proton flow is directly linked to the current 
density: 



J H .=- 



(2) 



where F is the Faraday's constant. 

The value of the output voltage of the cell is given by Gibb's free energy AG and is: 



V =■ 



AG 
2.F 



(3) 



This theoretical value is never reached, even at no load condition. For the rated current 
(around 0.5 A.cnv 2 ), the voltage of an elementary cell is about 0.6-0.7 V. 

As the gases are supplied in excess to ensure a good operating of the cell, the non-consumed 
gases have to leave the FC, carrying with them the produced water. 



110 



Energy Management 



Cooling liquid (water) 



2 (air) 




2 (air) 



Cooling liquid (water) 
^^ Electrode-Membrane-Electrode assembly (EME) 
^^ Bipolar plate 
^^H End plate 

Fig. 3. External and internal connections of a PEMFC stack 

Generally, a water circuit is used to impose the operating temperature of the FC (around 60- 
70 °C). At start up, the FC is warmed and later cooled as at the rated current nearly the same 
amount of energy is produced under heat form than under electrical form. 

B. Modeling Fuel Cell 

The output voltage of a single cell Vfc can be defined as the result of the following static and 
nonlinear expression (Larminie & Dicks, 2000): 



V =E-V -V -V 

FC act ohm concent 



(4) 



where E is the thermodynamic potential of the cell and it represents its reversible voltage, 
Vact is the voltage drop due to the activation of the anode and of the cathode, V hm is the 
ohmic voltage drop, a measure of the ohmic voltage drop associated with the conduction of 
the protons through the solid electrolyte and electrons through the internal electronic 
resistances, and V CO ncent represents the voltage drop resulting from the concentration or mass 
transportation of the reacting gases. 



r_ - 



rs.'iitffr 

5 

- 

I 
1 



i 


Activation 






Region 


Cinni c 
Region 


Corcevratior 








Re-ginn 


1 


. . ._„ -J r 

l\ 

1 \ 

1 

i 

i 

1 

! 

1 

1 
1 

1 h. 



h VtS Cell Current (A) 

Fig. 4. A typical polarization curve for a PEMFC 



/.., 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



111 



In (4), the first term represents the FC open circuit voltage, while the three last terms 
represent reductions in this voltage to supply the useful voltage of the cell Vfo for a certain 
operating condition. Each one of the terms can be calculated by the following equations, 



f • 



V act =Alog 

V ohm =R m (i FC -iJ 



(5) 



V„ 



:blOg 



1 1 FC 1 n 



Hence, iFc is the delivered current, io is the exchange current, A is the slope of the Tafel line, 
iiim is the limiting current, B is the constant in the mass transfer, i n is the internal current and 
R m is the membrane and contact resistances. 

2.2. Electric Double-layer supercapacitors 
A. Principle 

The basic principle of electric double-layer capacitors lies in capacitive properties of the 
interface between a solid electronic conductor and a liquid ionic conductor. These properties 
discovered by Helmholtz in 1853 lead to the possibility to store energy at solid/ liquid 
interface. This effect is called electric double-layer, and its thickness is limited to some 
nanometers (Belhachemi et al., 2000). 

Energy storage is of electrostatic origin, and not of electrochemical origin as in the case of 
accumulators. So, supercapacitors are therefore capacities, for most of marketed devices. 
This gives them a potentially high specific power, which is typically only one order of 
magnitude lower than that of classical electrolytic capacitors. 



collector 



1 




















:::::::::: : porous electrode :::::::::: 
















1 porous insulating membrane I 










porous electrode 










1 1 







collector 
Fig. 5. Principle of assembly of the supercapacitors 

In SCs, the dielectric function is performed by the electric double-layer, which is constituted 
of solvent molecules. They are different from the classical electrolytic capacitors mainly 
because they have a high surface capacitance (10-30 |uF.cm- 2 ) and a low rated voltage limited 
by solvent decomposition (2.5 V for organic solvent). Therefore, to take advantage of electric 
double-layer potentialities, it is necessary to increase the contact surface area between 
electrode and electrolyte, without increasing the total volume of the whole. 



112 Energy Management 

The most widespread technology is based on activated carbons to obtain porous electrodes 
with high specific surface areas (1000-3000 m^g- 1 ). This allows obtaining several hundred of 
farads by using an elementary cell. 

SCs are then constituted, as schematically presented below in Fig. 5, of: 

- two porous carbon electrodes impregnated with electrolyte, 

- a porous insulating membrane, ensuring electronic insulation and ionic conduction 
between electrodes, 

- metallic collectors, usually in aluminium. 

B. Modeling and sizing of suparcpacitors 

Many applications require that capacitors be connected together, in series and/ or parallel 

combinations, to form a "bank" with a specific voltage and capacitance rating. The most 

critical parameter for all capacitors is voltage rating. So they must be protected from over 

voltage conditions. The realities of manufacturing result in minor variations from cell to cell. 

Variations in capacitance and leakage current, both on initial manufacture and over the life 

of the product, affect the voltage distribution. Capacitance variations affect the voltage 

distribution during cycling, and voltage distribution during sustained operation at a fixed 

voltage is influenced by leakage current variations. For this reason, an active voltage 

balancing circuit is employed to regulate the cell voltage. 

It is common to choose a specific voltage and thus calculating the required capacitance. In 

analyzing any application, one first needs to determine the following system variables 

affecting the choice of SC, 

-the maximum voltage, Vscmax 

-the working (nominal) voltage, Vscnom 

-the minimum allowable voltage, Vscmin 

-the current requirement, Iso or the power requirement, Psc 

-the time of discharge, td 

-the time constant 

-the capacitance per cell, Cscceii 

-the cell voltage, Vscceii 

-the number of cell needs, n 

To predict the behavior of SC voltage and current during transient state, physics-based 

dynamic models (a very complex charge/ discharge characteristic having multiple time 

constants) are needed to account for the time constant due to the double-layer effects in SC. 

The reduced order model for a SC cell is represented in Fig. 6. It is comprised of four ideal 

circuit elements: a capacitor Cscceii, a series resistor Rs called the equivalent series resistance 

(ESR), a parallel resistor Rp and a series stray inductor L of ~nH. The parallel resistor Rp 

models the leakage current found in all capacitors. 

This leakage current varies starting from a few milliamps in a big SC under a constant 

current as shown in Fig. 7. 

A constant discharging current is particularly useful when determining the parameters of 

theSC. 

Nevertheless, Fig. 7 should not be used to consider sizing SCs for constant power 

applications, such as common power profile used in hybrid source. 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 113 



• — (M — MAAr 




Fig. 6. Simple model of a supercapacitor cell 

To estimate the minimum capacitance Cscmin, one can write an energy equation without 
losses (Resr neglected) as, 



— C (V 2 -V 2 )=P t 

^ SCMIN V SCNOM v SCMIN / x SC L 



(6) 



with 



Then, 



Psc(t)=V sc (t)i sc (t) 



(7) 



2P t 



-SCMIN V 2 _ T72 



v SCNOM v SCMIN 



(8) 



From (6) and (7), the instantaneous capacitor voltage and current are described as, 



v sc (t)=v SCNOM Ji- 



:W = 



/ 17 \ 



V, 



2A 



V SCMIN J 



(9) 



1- 



^T7 A 



1- 



V, 



2 A 



V * SCMIN J 



Since the power being delivered is constant, the minimum voltage and maximum current 
can be determined based on the current conducting capabilities of the SC. (6) and (7) can 
then be rewritten as, 



v - iv 2 - 2Fsctd 

v SCMIN J v SCNOM 



C„ 



(10) 



\T2 ^Sctd 

V SCNOM 



Q 



114 



Energy Management 



V sc 
~7 


*SCNOM 








%v R 






- ▼ - K ESR 




^SCMIN 


'« * 




he 








--U 






Fig. 7. Discharge profile for a SC under constant current. 

The variables Vscmax and Csc are indeed related by the number of cells n. The assumption is 
that the capacitors will never be charged above the combined maximum voltage rating of all 
the cells. Thus, we can introduce this relationship with the following equations, 



Vscmax — n V SCcell 



(ii) 



Generally, Vscmin is chosen as Vscmax /2, from (6), resulting in 75% of the energy being 
utilized from the full-of-charge (SOC 1 = 100%). In applications where high currents are 
drawn, the effect of the Resr has to be taken into account. The energy dissipated Wi oss in the 
Resr, as well as in the cabling, and connectors could result in an under-sizing of the number 
of capacitors required. For this reason, knowing SC current from (6), one can theoretically 
calculate these losses as, 



W l„ ss = |ic WResr 1 ^ = PscResrCmin In 



v„ 



V ^SCMIN J 



(12) 



To calculate the required capacitance Csc, one can rewrite (6) as, 



— C (V 2 -V 2 )=P t + W 

n ^SCMIN V V SCMAX v SCMIN / 1 SC L T v v lo 



(13) 



From (6) and (13), one obtains 



C =C 

^SC ^ SCMIN 

w 

v loss 



(1 + X) 



P«-t 



(14) 



where X is the energy ratio. 

From the equations above, an iterative method is needed in order to get the desired 

optimum value. 



1 State Of Charge 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



115 



C. State of the art and potential application 

Developed at the end of the seventies for signal applications (for memory back-up for 
example), SCs had at that time a capacitance of some farads and a specific energy of about 
0.5Wh.kg-i. 



1 000,00 




1.E+Q0 1.E+Q1 1.E+G2 1.E+Q3 1.E+04 1.E+05 1.E+06 1.E+Q7 



Fig. 8. 



Power density [W/kg] 
Comparison between capacitors, supercapacitors, batteries and Fuel cell 



High power SCs appear during the nineties and bring high power applications components 

with capacitance of thousand of farads and specific energy and power of several Wh.kg 1 

and kW.kg- 1 . 

In the energy-power plan, electric double layers SCs are situated between accumulators and 

traditional capacitors. 

Then these components can carry out two main functions: 

- the function "source of energy", where SCs replace electrochemical accumulators, the 
main interest being an increase in reliability, 

- the function "source of power", for which SCs come in complement with accumulators 
(or any other source limited in power), for a decrease in volume and weight of the whole 
system. 



2.3. State of the art of battery in electric vehicles 

An electric vehicle (EV) is a vehicle that runs on electricity, unlike the conventional vehicles 
on road today which are major consumers of fossil fuels like gasoline. This electricity can be 
either produced outside the vehicle and stored in a battery or produced on board with the 
help of FCs. 

The development of EV's started as early as 183(7 s when the first electric carriage was 
invented by Robert Andersen of Scotland, which appears to be appalling, as it even precedes 
the invention of the internal combustion engine (ICE) based on gasoline or diesel which is 
prevalent today. The development of EV's was discontinued as they were not very 
convenient and efficient to use as they were very heavy and took a long time to recharge. 
This led to the development of gasoline based vehicles as the one pound of gasoline gave 
equal energy as a hundred pounds of batteries and it was relatively much easier to refuel 
and use gazoline. However, we today face a rapid depletion of fossil fuel and a major 
concern over the noxious green house gases their combustion releases into the atmosphere 
causing long term global crisis like climatic changes and global warming. These concerns 



116 



Energy Management 



are shifting the focus back to development of automotive vehicles which use alternative 
fuels for operations. The development of such vehicles has become imperative not only for 
the scientists but also for the governments around the globe as can be substantiated by the 
Kyoto Protocol which has a total of 183 countries ratifying it (As on January 2009). 



A. Batteries technologies 

A battery is a device which converts chemical energy directly into electricity. It is an 
electrochemical galvanic cell or a combination of such cells which is capable of storing 
chemical energy. The first battery was invented by Alessandro Volta in the form of a voltaic 
pile in the 1800's. Batteries can be classified as primary batteries, which once used, cannot 
be recharged again, and secondary batteries, which can be subjected to repeated use as they 
are capable of recharging by providing external electric current. Secondary batteries are 
more desirable for the use in vehicles, and in particular traction batteries are most 
commonly used by EV manufacturers. Traction batteries include Lead Acid type, Nickel and 
Cadmium, Lithium ion/ polymer , Sodium and Nickel Chloride, Nickel and Zinc. 





Lead 
Acid 


Ni-Cd 


Ni- MH 


Li - Ion 


Li- 
polymer 


Na- 
NiCl 2 


Objectives 


Specific 

Energy 

(Wh/Kg) 


35-40 


55 


70-90 


125 


155 


80 


200 


Specific 
Power 
(W/Kg) 


80 


120 


200 


260 


315 


145 


400 


Energy 
Density 
(Wh/m 3 ) 


25-35 


90 


90 


200 


165 


130 


300 


Cycle Life 
(No. of 

charging 
cycles) 


300 


1000 


600 


+ 600 


+ 600 


600 


1000 



Table 1. Comparison between different baterries technologies. 

The battery for electrical vehicles should ideally provide a high autonomy (i.e. the distance 
covered by the vehicle for one complete discharge of the battery starting from its potential) 
to the vehicle and have a high specific energy, specific power and energy density (i.e. light 
weight, compact and capable of storing and supplying high amounts of energy and power 
respectively). These batteries should also have a long life cycle (i.e. they should be able to 
discharge to as near as it can be to being empty and recharge to full potential as many 
number of times as possible) without showing any significant deterioration in the 
performance and should recharge in minimum possible time. They should be able to operate 
over a considerable range of temperature and should be safe to handle, recyclable with low 
costs. Some of the commonly used batteries and their properties are summarized in the 
Table 1. 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 117 

B. Principle 

A battery consists of one or more voltaic cell, each voltaic cell consists of two half-cells 
which are connected in series by a conductive electrolyte containing anions (negatively 
charged ions) and cations (positively charged ions). Each half-cell includes the electrolyte 
and an electrode (anode or cathode). The electrode to which the anions migrate is called the 
anode and the electrode to which cations migrate is called the cathode. The electrolyte 
connecting these electrodes can be either a liquid or a solid allowing the mobility of ions. 
In the redox reaction that powers the battery, reduction (addition of electrons) occurs to 
cations at the cathode, while oxidation (removal of electrons) occurs to anions at the anode. 
Many cells use two half-cells with different electrolytes. In that case each half-cell is 
enclosed in a container, and a separator that is porous to ions but not the bulk of the 
electrolytes prevents mixing. The figure 10 shows the structure of the structure of Lithium- 
Ion battery using a separator to differentiate between compartments of the same cell 
utilizing two respectively different electrolytes 

Each half cell has an electromotive force (or emf), determined by its ability to drive electric 
current from the interior to the exterior of the cell. The net emf of the battery is the 
difference between the emfs of its half-cells. Thus, if the electrodes have emfs Ei and E2, then 
the net emf is E ce ii = E2- E\. Therefore, the net emf is the difference between the reduction 
potentials of the half-cell reactions. 

The electrical driving force or A Vfiat across the terminals of a battery is known as the terminal 
voltage and is measured in volts. The terminal voltage of a battery that is neither charging 
nor discharging is called the open circuit voltage and equals the emf of the battery. 
An ideal battery has negligible internal resistance, so it would maintain a constant terminal 
voltage until exhausted, then dropping to zero. If such a battery maintained 1.5 volts and 
stored a charge of one Coulomb then on complete discharge it would perform 1.5 Joule of 
work. 

Work done by battery (W) = - Charge X Potential Difference (15) 

Charge = Moles Electrons ^ ' 

Mole Electrons 

W = -nFEcell (17) 

Where n is the number of moles of electrons taking part in redox, F = 96485 coulomb/ mole 

is the Faraday's constant i.e. the charge carried by one mole of electrons. 

The open circuit voltage, E ce ii can be assumed to be equal to the maximum voltage that can 

be maintained across the battery terminals. This leads us to equating this work done to the 

Gibb's free energy of the system (which is the maximum work that can be done by the 

system) 

AG = W max = -nFEcell (18) 



118 



Energy Management 



A simple voltaic 
or galvanic cell 

(battery) 



©i 



RFntifTCIlM 

else Iron 

gain 



c«f>fMir salt 




f^J OXIDATION 

F hr,'. 



^n fl _ J1 h solution 



Fig 



«■ reacts Zh W + CU^ ^CL^j + Zh (#q) ^ E^MOV 

9. Showing the apparatus and reactions for a simple galvanic Electrochemical Cell 
Structure of Lithium-ion Battery 



Cathode cover 



Cathode lead 
— Safety vent 
PTC 4 Seperator 




/Cathode 
Anode Anode lead 

container 

Fig. 10. Structure of Lithium-Ion Battery 



Anode 



C. Model of Battery 

Non Idealities in Batteries: Electrochemical batteries are of great importance in many 
electrical systems because the chemical energy stored inside them can be converted into 
electrical energy and delivered to electrical systems, whenever and wherever energy is 
needed. A battery cell is characterized by the open-circuit potential (Voc), i.e. the initial 
potential of a fully charged cell under no-load conditions, and the cut-off potential (V cut ) at 
which the cell is considered discharged. The electrical current obtained from a cell results 
from electrochemical reactions occurring at the electrode-electrolyte interface. There are two 
important effects which make battery performance more sensitive to the discharge profile: 

- Rate Capacity Effect: At zero current, the concentration of active species in the cell is 
uniform at the electrode-electrolyte interface. As the current density increases the 
concentration deviates from the concentration exhibited at zero current and state of charge 
as well as voltage decrease (Rao et al., 2005) 

- Recovery Effect: If the cell is allowed to relax intermittently while discharging, the voltage 
gets replenished due to the diffusion of active species thereby giving it more life (Rao et al., 
2005) 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



119 



D. Equivalent Electrical Circuit of Battery 

Many electrical equivalent circuits of battery are found in literature. (Chen at aL, 2006) 
presents an overview of some much utilized circuits to model the steady and transient 
behavior of a battery. The Thevenin's circuit is one of the most basic circuits used to study 
the transient behavior of battery is shown in figure 11. 



R 



Series 



R 




Wt- -r— 

Self -Discharge 



-^vw^- 



-0 



-0 



Fig. 11. Thevenin's model 

It uses a series resistor (R se ries) and an RC parallel network (Rtransient and C tra nsient) to predict 
the response of the battery to transient load events at a particular state of charge by 
assuming a constant open circuit voltage [V oc (SOC)] is maintained. This assumption 
unfortunately does not help us analyze the steady-state as well as runtime variations in the 
battery voltage. The improvements in this model are done by adding more components in 
this circuit to predict the steady-state and runtime response. For example, (Salameh at aL, 
1992) uses a variable capacitor instead of V oc (SOC) to represent nonlinear open circuit 
voltage and SOC, which complicates the capacitor parameter. 



-"- internal 
^Wlr 



-o 



e 



emf 



O 

Fig. 12. Circuit showing battery emf and internal resistance R internal 

However, in our study we are mainly concerned with the recharging of this battery which 
occurs while breaking. The SC coupled with the battery accumulates high amount of charge 
when breaks are applied and this charge is then utilized to recharge the battery. Therefore, 
the design of the battery is kept to a simple linear model which takes into account the 
internal resistance (R internal) of the battery and assumes the emf to be constant throughout 
the process (Figure. 12). 



120 



Energy Management 



3. Control of the Electric Vehicles based on FC, SCs 
and Batteries on the DC Link 

3.1 Structure of the hybrid source 

As shown in Fig. 13 the studied system comprises a DC link directly supplied by batteries, a 
PEMFC connected to the DC link by means of a Boost converter, and a supercapacitive 
storage device connected to the DC link through a current reversible DC-DC converter. The 
function of FC and the batteries is to supply mean power to the load, whereas the storage 
device is used as a power source: it manages load power peaks during acceleration and 
braking. 

The aim is to have a constant DC voltage and the challenge is to maintain a constant power 
working mode for the main sources (batteries and FC). 

3.2. Problem formulation 

The main objectives of the proposed study are: 

- To compare two control techniques of the hybrid source by controlling the two DC-DC 
converters. The first is based on passivity control by using voltage control (on FC and 
current control for SC), and the second is based on sliding mode control by using current 
controller. 

- To maintain a constant mean energy delivered by the FC, without a significant power 
peak, and to ensure the transient power is supplied by the SCs. 

- To recover energy through the charge of the SC. 

After system modelling, equilibrium points are computed in order to ensure the desired 
behaviour of the system. When steady state is reached, the load has to be supplied only by 
the FC source. So the controller has to maintain the DC bus voltage to a constant value and 
the SCs current has to be cancelled. During transient, the power delivered by the DC source 
has to be the more constant as possible (without a significant power peak), so the SCs 
deliver the transient power to the load. If the load provides current, the SCs recover its 
energy. 
At equilibrium, the SC has to be charged and the current has to be equal to zero. 



I DL Ml 

►mm- 



A 






fpc: 



v t 



FC 



FC 



v. 



V 



v n 



^s 



\ 



^Ql 



-cmr^ 



V 



K^LX v., 



=a 



SC 



Fig. 13. Structure of the hybrid source 



Load 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 121 

3.3 Port Controlled Hamiltonian System 

PCH systems were introduced by van der Schaft and Maschke in the early nineties, and 
have since grown to become a large field of interest in the research of electrical, mechanical 
and electro-mechanical systems. A recent and very interesting approach in PBC is the 
Interconnection and Damping Assignment (IDA-PBC) method, which is a general way of 
stabilizing a large class of physical systems) (Ortega et al. 2002) (Becherif et al., 2005). 

A. Equations of the system 

The overall model of the hybrid system is written in a state space equation by choosing the 
following state space vector: 

X = L X 1 X 2 X 3 X 4 X 5 X 6 X 7 \ 

= fviviviil T 

L V S ± FC V DL X DL V SC X SC 1 L J 

The output voltage of a single cell Vfc can be defined as the result of the following expression: 



V FC =E -Ak>£ 



f ■ ■ \ 



R m (i FC -i n ) + Blog 



he "In 



(20) 



where E is the thermodynamic potential of the cell representing its reversible voltage, iFc is 

the delivered current, i D is the exchange current, A is the slope of the Tafel line, ium is the 

limiting current, B is the constant in the mass transfer, i n is the internal current and R m is the 

membrane and contact resistances. Hence Vfc = f(iFc)- 

The fourth term represents the voltage drop resulting from the concentration or mass 

transportation of the reacting gases. 

In equation (20), the first term represents the FC open circuit voltage, while the three last 

terms represent reductions in this voltage to supply the useful voltage of the cell Vfc, for a 

certain operating condition. Each of the terms can be calculated by the following equations, 

The control vector is: 

n = k, n 2 ] T = [(i-u FC ), (i-u sc )] T 

or u=[u FC , Usc r (21) 

With Vfc = Vfc(x2) given in (Larminie & Dicks, 2000). In the sequel, Vfc will be considered as 
a measured disturbance, and from physical consideration, it comes that Vfc e [0; Vd[. 



122 



Energy Management 



B. Equilibrium 

After simple calculations the equilibrium vector is: 



= [*!/ x 



Xq / X4 , Xr, X,- , A 



2 , yv 3 , yv 4 , yv 5 , yv g 



7 ] T 



V d , 



'v ' 



v c , 



V«l 



, v d , ^l-^zXl, v sc (t = o), o, v 



R, 



R, 



(22) 



where V d is the desired DC link voltage. An implicit purpose of the proposed structure 
shown in Fig. 13 is to recover energy to charge the SC. Hence, the desired 
voltage x 5 = V sc = V sc (t = 0) =Constante. 



Or 



M- = [m-i/ ^] T 

U = [U pc , U sc f: 

The natural energy function of the system is: 






1 V FC j. X. 



V, 



V. 



(23) 



(24) 



1 T 

H = -x T Qx 

2 



(25) 



where 



is a diagonal matrix. 



Q = diag{C s ; L Fc ; C DL ; L DL ; C sc ; L sc ; L L 



C. Port-Controlled Hamiltonian representation of the system 

In the following, a closed loop PCH representation is given. The desired closed loop energy 
function is: 

H d =-x T Qx (26) 



Where X = X — X is the new state space defining the error between the state X and its 
equilibrium value X . 

The PCH form of the studied system with the new variable X as a function of the gradient 
of the desired energy (26) is: 



= [30i 1/ ^ 2 )-9l]VH d +A i (x / ^) 



(27) 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



123 



With 



And 



Where 




-A 



C J 



Mi 



C J 



3(//i,// 2 )-9* = 

1 



C J 



C l r 




-Mi 



^DL-^L 



A.x^ 



VH„ 



. s [-x 4 +^x 2 J 
— [Vfc-Ml 

J FC 





- — [x 5 -n 2 x 3 ] 

L sc 





3(^ 1/ ^ 2 ) = -3 T (^ 1/ ^i 2 ) 




Mi 



C J 

^DL-^SC 



C J 

^sc-^sc 









(28) 



(29) 



(30) 



(31) 



is a skew symmetric matrix defining the interconnection between the state space and 

9? = 9? > i s a symmetric positive semi definite matrix defining the damping of the 

system. 

With r is a design parameter, the following control laws are proposed: 



M-l =H-1 and ^2=^2 



(32) 



124 Energy Management 

Proposition 1: The origin of the closed loop PCH system (27), with the control laws (32) and 
(23) with the radially unbounded energy function (26), is globally stable. 
Proof: The closed loop dynamic of the PCH system (27) with the laws (32) and (23) with the 
radially unbounded energy function (26) is: 



where 



X = [3(n 1/ ^ 2 )-SR']7H d ( 33 ) 

m' = diag\0; 0; j-^; 0; 0; ^-A =9T r >0 (34) 

The derivative of the desired energy function (26) along the trajectory of (33) is: 

H d = VHjx = -VHj9l'VH d < ( 35 ) 

3.4 Sliding mode control of the system 

Due to the weak request on the FC, a classical PI controller is adapted for the boost 
converter. Because of the fast response in the transient power and the possibility to work 
with a variable or a constant frequency, a non-linear sliding mode control (ayad et al, 2007) 
which allows management of the charge and discharge of the SC tank is chosen for the DC- 
DC bidirectional SC converter. 

The current supplied by the FC is limited to an interval [Imin, Imax]. Within this interval, the 
FC boost ensures the regulation of this current to its reference. But, as soon as the load 
current is greater than Imax or lower than Imin, the boost becomes unable to regulate the 
desired current. The lacking or excess current is then provided or absorbed by the storage 
device, hence the DC link current is kept equal to its reference level. Consequently, three 
modes can be defined to optimize the function of the hybrid source: 

- The normal mode, for which the load current is within the interval [Imin, Imax]. In this 
mode, the boost ensures the regulation of the DC link current, and the control of the 
bidirectional SC converter leads to the charge or the discharge of SC up to a reference 
voltage level Vscref, 

- The discharge mode, for which the load current is greater than Imax- The current reference 
of the boost is then saturated to Imax, and the DC-DC converter ensures the regulation of the 
DC link current by supplying the lacking current through the SC discharge, 

- The recovery mode, for which the load current is lower than Imin- The power reference of 
the controlled rectifier is then saturated to Imin and the DC-DC converter ensures the 
regulation of the DC link current by absorbing the excess current through the SC charge. 

A. DC-DC Fuel Cell converter control principle 

The FC current reference Ifc is generated by means of a PI current loop control on a DC link 
current and load current. The switching device is controlled by a hysterisis comparator. 

t 
i; c =k p (l L -I DL )+k I J(l L -I DL )dt (36) 



where k p and kiare the proportional and integral gains. 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



125 




Fig. 14. Control of the FC converter 



A 


U F c 






^ 



B. DC-DC Supercapacitors converter control principle 

To ensure proper function for the three modes, we use a sliding mode control for the 
bidirectional SC converter. Thus we define a sliding surface S as a function of the DC link 

current Idl, the load current II, the SC voltage Vso its reference V sc and the SC current Isc: 



with 



S = (l DL -I L )+k c (l sc -l) 

t 
I = k ps (v sc -V s ' c )+k is J(v sc -V s * c >it 



(37) 
(38) 



With, k ps and ki S are the proportional and integral gains. 

When S < 0, the lower T S c=l in Fig.14 is switched on, and the upper T sc = [ s switched 

off. When S > 0, the upper T sc = 1 is switched on and the lower T S c=0 is switched off. 

The FC PI controller ensures that Idl tracks II. The SC PI controller ensures that Vsc tracks its 

reference Vsc . 

kc is the coefficient of proportionality, which ensures that the sliding surface equals zero by 
tracking the SC currents to its reference I when the FC controller cannot ensure Idl tracks II. 
In steady state conditions, the FC converter ensures that the first term of the sliding surface 

is zero, and the integral term of equation (38) implies that V sc = V sc m Then, imposing S = 
leads to Isc = 0, as far as the boost converter output current Idl is not limited so that the 
storage element supplies energy only during power transient and Idl limitation. 
The general system of the DC link and the DC-DC SC converter equations can be written as: 



With 



X=AX+BU+C+^ 

x = [v DL I sc V sc l] T 



(39) 



126 



Energy Management 



And 






















~-l/(r B .C DL ) 


i/c DL 





0" 








A = 


-1/Lsc 




~~ r sc / ^ sc * 

-1/Cgc 




















-k ps /C sc 


k is 













B = 


Isc 

c 


v 

-^0 


T 








4= 

r 


"(Idl- 
r 


^000 


T 

c = 


E B 

_l r B^DL 




) 





-k ls V s * c 


T 
/ 
















U = U SC 


If we denote 























G = [0 k c -k c ] 



the sliding surface is then given by 



In order to set the system dynamics, we define the reaching law 

S = -^S-Ksign(S) 



with 



K = ^ |S| < 8 anc j K = nXe ^ |S|| > 8 



(40) 
(41) 

(42) 
(43) 



The linear term -AS(X) imposes the dynamics inside the error bandwidthe. The choice of a 
high value of X (<i c /i) ensures a small static error when|S||<e. The non-linear term 
-Ksign(s) permits to reject perturbation effects (uncertainty of the model, variations of the 
working conditions...). This term allows compensation high values of error ||S|| > s due to 
the above mentioned perturbations. The choice of a small value of 8 leads to high current 
ripple (chattering effect) but the static error remains small. A high value of s forces a 
reduction in the value of X to ensure the stability of the system and leads to a higher static 
error. 

Once the parameters (X, K, e) of the reaching law are determined, it is possible to calculate 
the continuous equivalent control, which allows the state trajectory on the sliding surface to 
be maintained. Using Equations (39), (41) and (42), we find: 



Usee, = (GB)" 1 {- GAX - GC - XGX - Ksign(S) - C DL [4 + Xi~\} 

(37) and (39) give the equation: 

A eq = A - B(GB) - 1 GA - B(GB) "' XG 



(44) 



(45) 



This equation allows the determination of the poles of the system during the sliding motion 
as a function of X and kc. The parameters ki S and k ps are then determined by solving S = 0. 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 127 

This equation is justified by the fact that the sliding surface dynamic is much greater than 
the SC voltage variation. 

C. Stability 

Consider the following Lyapunov function: 

2 
Where, S is the sliding surface. 

The derivative of the Lyapunov function along the trajectory of (42) in the closed loop with 
the control (44) gives: 

V = SS = -XS 2 - KSsign(S) < ( 47 ) 

With X,K>0 

Hence, the origin of the closed loop of the system (39) with the control (44) and the sliding 

surface (41) is asymptotically stable. 

3.5 Simulation results of the hybrid source control 

The whole system has been implemented in MATLAB-SIMULINK with the following 
parameters associated to the hybrid sources: 

- FC parameters: P M ax = 400 W. 

- DC link parameters: Vdl= 24 V. 

- SC parameters: C sc = 3500/6 F, V s * c = 15V . 

The results presented in this section have been carried out by connecting the hybrid source 
to a "R, L and El " load. 

A. Sliding mode control applied to the hybrid source 

Figures 15, 16 and 17 present the behaviour of currents Idl, Idl, Iso Ib and the DC link 
voltage Vdl for transient responses obtained for a transition from the normal mode to the 
discharge mode by using sliding mode control. The test is performed by changing sharply 
the e.m.f load voltage El in the interval of te[0.5 s, 1.5 s]. The load current II changes from 
16.8 A to 25 A. The current load II = 16.8 A corresponds to a normal mode and the current 
load II = 25 A to a discharge mode. 

At the starting of the system, only the FC provides the mean power to the load. The storage 
device current reference is equal to zero, we are in normal mode. In the transient state, the 
load current II became greater then the DC link current Idl- The storage device current 
reference became positive thanks to control function which compensate this positive value 
by the difference between the SC voltage and its reference. We are in discharging mode. 
After the load variation (t > 1.5 s), the current in the DC link became equal to the load 
current. The SC current Isc became null. We have a small variation in the batteries currents. 



128 



Energy Management 



24 

s 22 

1 20 
^ 18 

16 



^/l] 



V 



Fig. 15. Load and DC link currents 















Vise 








H 


/" 


— ■ 




] 



Fig. 16. SC and batteries currents 



tone (s) 



> 23.; 
s 



f~^_^_H H ; 



Fig. 17. DC link voltage 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 



129 



B. Passivity Based Control applied to the hybrid source 

Figure 18 shows the FC voltage and current. Figure 19 presents the SC voltage and current 
response. The SC supply power to the load in the transient and in the steady state no power 
or energy is extracted since the current xe = Isc is null. 

The positive sens of Isc means that the SCs supply the load and the negative one 
corresponds to the recover of energy from the FC to the SC. Figure 20 presents the batteries 
voltage and its current. Figure 21 presents the response of the system to changes in the load 
current II. The DC Bus voltage tracks well the reference, i.e. very low overshoot and no 
steady state error are observed. It can be seen from this figure that the system with the 
proposed controller is robust towards load resistance changes. Figure 22 shows the FC Boost 
controller, the SC bidirectional converter controller and the changes in the Load resistance 
RL. Use and Ufc are in the set [0; 1]. 



26 

o 
^ fe 22 



< 2 











































j" ■ 






: 


i 


i 




1 2 


3 


4 


5 


6 


7 


8 


9 


10 































12 3 4 5 6 7 

Fig. 18. FC voltage and FC current 





15.0005 

15 

14.9995 

14.999 

14.9985 
t 

1:5 
1 

0.5 

-0.5 


! | j i i i | j i 






> 






































1 2 


3 


4 


5 


6 


1 


8 


9 1 






< 




u 






illl.il 



1 2 

Fig. 19. SC voltage and SC current 



130 



Energy Management 



> 24 



k,» •••;• ■■*■ 



1 2 3 4 5 6 7 8 9 10 



t 



1 2 3 4 5 6 7 8 9 10 



Fig. 20. Batteries voltage and batteries current 



> 24 



01234567S9 10 



12 3 4 5 6 7 

Fig.21. DC link voltage and load current 



0.5 



D " -0.5 

I 

0.38 
0.37 

0.36 

I 

g 16 

12 
10 



1 2 3 4 5 6 7 8 9 10 



t 



1 2 3 4 5 6 7 8 9 10 






1 2 3 4 5 (5 7 8 9 10 

Fig. 22. (a) FC Boost control, (b) SC DC-DC (c) Load resistance change 



Passivity-Based Control and Sliding Mode Control 

applied to Electric Vehicles based on Fuel Cells, Supercapacitors and Batteries on the DC Link 131 

4. Conclusion 

In this paper, control principles of a hybrid DC source have been presented. This source 

uses the fuel cell as mean power source, SCs as auxiliary transient power source and 

batteries on the DC link. 

Passivity Based Control and Sliding Mode Control principles have been applied and 

validated by simulation results. Include main findings and highlight the positive points of 

the simulation results and the possibility of applying this new concept in Fuel Cell 

applications. 

PCH structure of the overall system is given exhibiting important physical properties in 

terms of variable interconnection and damping of the system. The problem of the DC Bus 

Voltage control is solved using simple linear controllers based on an IDA-PBC approach. 

With the sliding mode principle control, we have a robustness control. But the sliding 

surface is generated in function of multiple variables: DC link voltage, SCs current and 

voltage. 

With PBC, only two measures are needed to achieve the control aims of this complex system 

(the FC Voltage and the SC current), while for the Sliding mode control we need to achieve 

the control aims of this complex system (the FC Voltage, the SC current, the SC voltage, load 

and DC link currents). The sliding mode is faster in terms of response to a set point change 

or disruption. 

The PBC control laws are completely independent from the system's parameters, and then 

this controller is robust towards the parameter variation. The Sliding mode controller is 

function of the system parameter and is therefore sensitive to there changes. 

The PBC control laws are very simple to realize and produce continuous behavior while the 

sliding mode control is more complicated (realization of the surface and the control laws) 

and introduce nonlinearities by commutation. 

Global Stability proofs are given and encouraging simulation results has been obtained. 

Many benefits can be expected from the proposed structure such that supplying and 

absorbing the power picks by using SC which also allows recovering energy. 

5. References 

Kishinevsky, Y. & Zelingher, S. (2003). Coming clean with fuel cells, IEEE Power & Energy 

Magazine, vol. 1, issue: 6, Nov.-Dec. 2003, pp. 20-25. 
Larminie, J. & Dicks, A. (2000). Fuel cell systems explained, Wiley, 2000. 
Pischinger, S.; Schonf elder, C. & Ogrzewalla, J. (2006). Analysis of dynamic requirements for 

fuel cell systems for vehicle applications, J. Power Sources, vol. 154, no. 2, pp. 420- 

427, March 2006. 
Moore, R. M.; Hauer, K. H.; Ramaswamy, S. & Cunningham, J. M. (2006). Energy utilization 

and efficiency analysis for hydrogen fuel cell vehicles, J. Power Sources, 2006. 
Corbo, P.; Corcione, F. E.; Migliardini, F. & Veneri, O. (2006). Experimental assessment of 

energy-management strategies in fuel-cell propulsion systems, J. Power Sources, 

2006. 
Rufer, A.; Hotellier, D. & Barrade, P. (2004). A Supercapacitor-Based Energy-Storage 

Substation for Voltage - Compensation in Weak Transportation Networks/' IEEE 

Trans. Power Delivery, vol. 19, no. 2, April 2004, pp. 629-636. 



132 Energy Management 

Thounthong, P.; Rael, S. & Davat, B. (2007). A new control strategy of fuel cell and 

supercapacitors association for distributed generation system, IEEE Trans. Ind. 

Electron, Volume 54, Issue 6, Dec. 2007 Page(s): 3225 - 3233 
Correa, J. M.; Farret, F. A.; Gomes, J. R. & Simoes, M. G. (2003). Simulation of fuel-cell stacks 

using a computer-controlled power rectifier with the purposes of actual high- 
power injection applications, IEEE Trans. Ind. App., vol. 39, no. 4, pp. 1136-1142, 

July/ Aug. 2003. 
Benziger, J. B.; Satterfield, M. B.; Hogarth, W. H. J.; Nehlsen, J. P. & Kevrekidis; I. G. (2006). 

The power performance curve for engineering analysis of fuel cells, J. Power 

Sources, 2006. 
Granovskii, M.; Dincer, I. & Rosen, M. A. (2006). Environmental and economic aspects of 

hydrogen production and utilization in fuel cell vehicles, J. Power Sources, vol. 157, 

pp. 411-421, June 19, 2006 
Ortega, R.; van der Schaft, A. J.; Maschke, B. & Escobar, G. (2002). Interconnection and 

damping assignment passivity-based control of port-controlled hamiltonian 

systems, Automatica, vol.38(4), pp.585-596, 2002. 
Becherif, M. & Mendes, E. (2006). Stability and robustness of Disturbed- Port Controlled 

Hamiltonian system with Dissipation, 16th IFAC World Congress, Prague, 2005. 
Becherif, M. & Ay ad, M. Y. (2006). Modelling and Passivity-Based Control of Hybrid 

Sources: Fuel cell and Supercapacitors, In 41st IEEE-IAS 2006, USA. 
Ay ad, M. Y.; Gualous, A.; Cirrincione, M. & Miraoui, A. (2007). Study And Realization Of A 

Power Source Using Supercapacitors Matrix and Fuel cell, in Proc. 2nd European 

Ele-Drive Transportation Conference EET-2007 - Brussels, 30th May - 1st June 2007 
Ayad, M. Y.; Pierfederici, S.; Rael, S. & Davat, B. (2007). Voltage Regulated Hybrid DC 

Source using supercapacitors, Energy Conversion and Management, Volume 48, 

Issue 7, July 2007, Pages 2196-2202. 
Belhachemi, F.; Rael, S. & Davat, B. (2000). A Physical based model of power elctric double 

layer supercapacitors, IAS 2000, 35th IEEE Industry Applications Conference, 

Rome, 8-12 October 
Rao, V.; Singhal, G.; Kumar, A. & Navet, N. (2005). Model for Embedded Systems Battery, 

Proceedings of the 18th International Conference on VLSI Design held jointly with 

4th International Conference on Embedded Systems Design (IEEE-VLSID'05), 2005. 
Chen, M.; Gabriel, A.; Rincon-Mora. (2006). Accurate Electrical Battery Model Capable of 

Predicting Runtime and I-V Performance. . IEEE Trans. Energy Convers, Vol. 21, 

No.2, pp.504-511 June 2006. 
Salameh, Z.M.; Casacca, M.A. & Lynch, W.A. (1992). A mathematical model for lead-acid 

batteries, IEEE Trans. Energy Convers., vol. 7, no. 1, pp. 93-98, Mar. 1992. 



Equivalent consumption minimization 
strategies of series hybrid city buses 

Liangfei Xu, Guijun Cao, Jianqiu Li, Fuyuan Yang, Languang Lu 

and Minggao Ouyang 

State Key Lab of Automotive Safety and Energy, Tsinghua University 

P.R.China 



1. Introduction 

With ever growing concerns on energy crisis and environmental issues, alternative clean 
and energy efficient vehicles are favoured for public applications. Internal combustion 
engine(ICE)-powered series hybrid buses and fuel cell (FC) hybrid buses, respectively as a 
near-term and long-term strategy, have a very promising application prospect. 
The series hybrid vehicle utilizes an ICE/FC as the main power source and a battery/ ultra 
capacity (UC) as the auxiliary power source. The main power source supplies the average 
vehicle power, and the auxiliary power source functions during accelerating and 
decelerating. Because the battery/ UC fulfills the transient power demand fluctuations, the 
ICE/FC can work steadly. Thus, the durability of the fuel cell stack could be improved 
compared with a pure FC-powered bus in the FC series hybrid bus. And the PM and NOx 
can be greatly lowered in the ICE series hybrid bus compared with a traditional city bus. 
Besides, the ability of the energy storage source to recover braking energy enhances the fuel 
economy greatly. 

The hybrid configuration raises the question of energy management strategy, which chooses 
the power split between the two. The strategy is developed to achieve system-level 
objectives, e.g. fuel economy, low emission and battery charge-sustaining, while satisfying 
system constraints. 

Energy management strategies in the recent literature can be generally categorized into two 
types: rule-based strategies and optimal strategies. A rule based strategy can be easily 
implemented for the real-time applications based on heuristics (N.Jalil, N.A.Kheir & 
M.Salman, 1997). Such a strategy could be further improved by extracting optimal rules 
from optimal algorithms (S.Aoyagi, Y.Hasegawa & T.Yonekura, 2001). 

Optimal strategies differ from each other in the time range. Fuel consumption in a single 
control cycle is minimized in an instantaneous optimal strategy (G.Paganelli, S.Delprat & 
T.M.Guerra, 2002). And a global optimal strategy minimises it over a whole determined 
driving cycle using determined dynamic programming method (DDP) (Chan Chiao Lin et 
al., 2003), or over a undetermined driving cycle using stochastic dynamic programming 
method (SDP) (Andreas Schell et al., 2005). Other strategies minimize fuel consumption over 
an adaptive time span, which could be adjusted on the basis of vehicular speed, pedal 



134 



Energy Management 



positions, historical vehicle power and power forcasting in the future (Bin He, Minggao 
Ouyang, 2006). 

From a mathematical viewpoint, the optimal problem could be solved using different 
methods. Energy management strategies based on DDP, SDP, fuzzy logic (Schouten N J, 
Salman M A & Kheir N A, 2002), neural network optimal algorithm (Amin Hajizadeh, 
Masoud Aliakbar Golkar, 2007), genetic algorithm (Vanessa Paladini et al., 2007) and 
wavelet algorithm (Xi Zhang et al., 2008) have been proposed by different researchers. 
This chapter describes the implementation of an equivalent consumption minimization 
strategy in a FC+battery city bus and an ICE+battery city bus. It belongs to the 
instantaneous optimization strategies. The strategy is based on an equivalent consumption 
model, which was firstly proposed by Paganelli G (Paganelli G et al., 2002) to evalutate the 
battery electrical energy consumption. The analytical solutions to the optimal problems are 
given, avoiding using complex mathematical tools. 

The charpter proceeds as follows. Section 2 describes the powertrain systems of the FC/ICE- 
powered hybrid city buses. Section3 details the equivalent consumption model. Section 4 
gives the equivalent consumption minimization strategy (ECMS) on the basis of the 
analytical solutions. Section 5 discusses the results in the "China city bus typical cycle" 
testing. Section 6 is the conclusions. 

2. The series hybrid powertrains 

In the 11 th Five-Year Plan of China, a series of hybird city buses have been developed. Fig. 1 
(a) and (b) show a fuel cell city bus and a diesel engine hybrid city bus respectively. 




1^ — =r 




^-■M'"- W 


^^ 


P 


« 




1 




m?: 



(b) 
Fig. 1. (a) Fuel cell city bus (b) Diesel engine series hybrid city bus 



Equivalent consumption minimization strategies of series hybrid city buses 135 

The series hybrid powertrain under discussion is mainly composed of a power unit (PU), an 
auxiliary power source and an alternating current motor, as shown in Fig. 2 (a) and (b). A 
Ni-MH battery has the advantage of good charging / discharging characteristics compared 
with a Pb-Acid battery. And it is relatively cheap compared with a Li-ion battery. Thus, a 
Ni-MH battery is selected as the auxiliary power source. The two kinds of city buses differ 
in the PU configuration. In the fuel cell hybrid bus, the PU consists of a proton exchange 
membrane (PEM) fuel cell system and a direct current to direct current (DC/ DC) converter, 
as in Fig. 2 (a). In the ICE hybrid bus, the PU consists of an internal combustion engine, a 
generator and a rectifier, as in Fig. 2 (b). 

As an electrochemical device, the PEM fuel cell system converts hydrogen energy to electrical 
energy directly without mechanical processes. For the city bus in Fig. 1 (a), two stacks with a 
rated power of 40kW are installed. The city bus is powered by an AC motor with a rated 
power of lOOkW. In order to fulfill the peak power during accelerating, a Ni-MH battery with 
a rated capacity of 80A.h, and a rated open circuit voltage of 380V is utilized. The fuel cell 
stack, the Ni-MH battery and the AC motor are connected as in Fig. 2 (a). 
Compared with the FC-powered hybrid bus, the ICE-powered hybrid bus is much more 
popular in the market because of the price. The city bus in Fig. 1 (b) is equipped with a 
diesel engine SOFIM 2.8L. It reaches its maximal torque at ISOOr.min- 1 . Its lowest specific 
fuel consumption is 210g.kWh- 1 at about 1600r.min 1 . A three-phase synchronous generator 
is connected with the diesel engine directly to convert the mechanical power into alternating 
current (AC). A three-phase rectifier is used to convert AC into direct current (DC). The AC 
motor and the battery are similar as in the FC city bus. The diesel engine, the generator, the 
rectifier, the battery and the motor are connected as in Fig. 2 (b). 

Fig. 2 (a) and (b) also present the control systems of the hybrid powertrain. It is a distributed 
control system based on a time-triggered controller area network (TTCAN). The vehicle 
controller unit (VCU) is the "brain" of the control system. It receives driver commands 
(pedal positions, shift signals, on-off swithes et al.) through its digital/ analog input channels, 
and sends control commands to other controllers. 

In the FC+battery hybrid powertrain, the TTCAN consists of the VCU, a fuel cell controller, 
a DC/ DC controller, a battery management system and a motor controller. The output 
torque of the motor and the output current of the DC/ DC converter are controlled by the 
VCU to regulate the motor power and the fuel cell power respectively (Xu Liangfei, 2008). 
In the ICE+battery hybird powertrain, the TTCAN is composed of the VCU, an engine 
controller, a excitation controller, a battery management system and a motor controller. The 
output power of the PU is controlled by a PWM signal from the VCU to the excitation 
controller, and the rotational speed of the diesel engine is controlled by a simulant throttle 
signal from the VCU to the engine controller (Cao Guijun, 2009). 
Main parameters of the two city buses are presented in Table 1. 



136 



Energy Management 



Cri ver 
cormand 



Vehi cl e 

Cbnt r ol I er 

Lhit 



Fuel Gel I 
cont r ol I er 



DO DC 
conver t er 
control I er 



Fuel Gel I 
System 



DO DC 
converter 



Battery 

Nfenagertent 
System 



Mrtor 

Control ler 

Unit 



Bectr 

Mrtor 



. Driver 
command 



Vehicle 

control ler 

..nit 



Eng ins 
Control ler 


Excitat ion 
control ler 



Genera 
-tor 





Ratt i - 




f ier 







=1_ 



Battery 

management 

system 



Battery 



Motor 
tontro I I ar 



Electric 
motor 



(a) (b) 

Fig. 2. Series hybrid powertrain structure (He Bin, 2006) (a) PEM fuel cell+Ni-MH battery (b) 
Diesel engine+Ni-MH battery 



Parameter (Unit) 


Value 


Fuel cell hybrid bus empty mass m (kg) 


1.45x104 


Diesel engine hybrid bus empty mass m 


1.35x104 


(kg) 




Frontal area A (m2) 


7.5 


Drag coefficient Cd 


0.7 


Rolling resistance coefficient 


1.8x10-2 


Mechanical efficiency r]j (%) 


95 


Mass factor 


1.1 


PEM fuel cell rated power (kW) 


80 


DC/ DC rated power (kW) 


80 


Style of the diesel engine 


SOFIM 2.8L 


Diesel engine lowest fuel consumption 


210g.kWh-i 


Style of the generator 


4UC224G 


Rated power of the generator 


68kW at 1500r.min-i 


Style of the rectifier 


three phase full bridge uncontrollable 


Power range of the rectifier (kW) 


10-120 


Ni-MH battery rated capacity (A.h) 


80 in Fig. 1 (a), 60 in Fig. 1 (b) 


Electric motor rated power (kW) 


100 



Table 1. Main parameters of the two hybrid city buses 



Equivalent consumption minimization strategies of series hybrid city buses 137 

3. The equivalent consumption model 

The concept of equivalent fuel consumption was proposed by Paganelli et al. for an 
instantaneous optimization energy management strategy (Paganelli G et al., 2002). In the 
two kinds of series hybrid vehicles, both the PU and the battery provide energy. The 
electrical energy consumption of the battery is transformed into an equivalent fuel 
consumption to make the two comparable. If some energy is drawn from the battery at the 
current sample time, the battery will have to be recharged to maintain the state of charge 
(SOC) in the future. The energy will be provided by the PU, or by the motor in braking 
regeneration. That will imply extra fuel consumption. Because the operating points of the 
PU and the battery in the future are unknown, the average values are used to calculate the 
battery equivalent hydrogen consumption Cbat- 

Cbat = <5PbatCp U ,avg/ (^dis^chg,avg Ppu,avg), Pbat^O (1) 

where: 

Pbat is the battery power, kW. 

C pu ,avg is the PU mean fuel consumption, g.s- 1 . 

P P u,avg is the PU mean output power, kW. 

?]dis is the battery discharging efficiency. 

?7chg,avg is the battery mean charging efficiency. 

5 is a ratio factor that defines as follows. 

0~ £pu,chg/ ( i ^pu,chg"'"£'recycle,chgj (2.) 

where: 

Epu,ch g is the battery charging energy provided by the PU. Erecycie,ch g is the battery charging 

energy which is recycled by the electric motor. The energy should be calculated over a 

certain time range, depending on the working conditions. If no braking energy is recovered, 

5=1. If no PU energy is used to charge the battery, 5=0. The battery could not only be 

charged by braking energy, 0<5<1. 

If the battery is recharged at the current sample time, a discharge of the battery is required 

to maintain the SOC. This discharge will lead to a reduction of the fuel consumption in the 

future. The battery equivalent consumption can be calculated as 

(—bat - *■ bat^chg?/dis,avg ^pu,avg/ *■ pu,avgr *■ bat^U (3) 

where: 

f/chg is the battery recharging efficiency. 

^dis,av g is the battery mean discharging efficiency. 

The battery charging/ discharging efficiencies are calculated based on the Rint model (V. H. 

Johnson, 2002), which is shown in Fig. 3. They can be formulated as 



138 



Energy Management 



7dis 



AR P 

1, h ^ Jv dis J bat 



Ut 



^ch g =2/ 



l+.l 



j^ggg 



t/. 



P.... > 



/L < 



(4) 



where Rdis and R c h g are the battery discharging and charging resistance respectively, LZ OC v is 
the open circuit voltage. All of them are functions of the battery SOC. 

For the 80 Ah Ni-MH battery, the relationship between Rdis/^chg and SOC is shown in Fig. 3 
(b), as well as the relationship between LZ OC v and SOC. Fig. 3 (c) presents the relationship 
between battery efficiency and Pbat, SOC. Fig. 3 (d) indicates the relationship between the 
battery equivalent consumption and Pbat/ SOC, where 5=1. 



Rh 



Ubui 



u M 



(a) 



100^ 














4 


90 

£ so 

^70^ 
60 


ff 












3 

*r 2 

w 
u> 1 

""Jo n 

if ° 

-1 


50, 
100 










-2 
100 




50 

P bat( 




kW) 


-100 


™ 40 

20 

SOC (%) 


80 


100 






SOC (%) 



(c) (d) 

Fig. 3. (a) The battery Rint model (b) Relationship between battery resistance/ open circuit 
voltage and SOC (solid line for charging, dashed line for discharging) (c) Battery efficiency 
v.s. battery power and SOC (d) Battery equivalent hydrogen consumption Cbat v.s. battery 
power and SOC, 5=1. 



In the fuel cell + battery hybrid powertrain, the PU is composed of the fuel cell system and 
the DC/ DC converter. In the following equations, Q c is the fuel cell hydrogen consumption, 
and Pdc is the DC/ DC output power. According to the experimental data, the fuel cell 
hydrogen consumption Q c can be expressed as 



Equivalent consumption minimization strategies of series hybrid city buses 



139 



a 



a P dc +a 1? 



P >P 

1 dc — J dcO 

P < P 



(5) 



where ai, fo are fit coefficients, Pdco is a critical value of Pdc. 

The relationship between Cf c and Pdc is nonlinear when Pd c is smaller than the critical value 
Pdco, and it is linear when Pdc is larger than Pd c o- Fig. 4 (a) and (b) compare the experiment 
curves and the fitting curves in the two cases. Pdco is about 7.5kW for the hybrid powertrain 
under discussion. 



0.16 










1.6 




Experiment 




Experiment 


0.14 


— Fitting curve 








/ 1 " 4 

1.2 


— Fitting curve 


0.12 








^ 0.1 








^ 1 




(A 








(A 




3 0.08 








S 0.8 




° 0.06 








°" .6 




0.04 








0.4 




0.02 








0.2 


-r 


) 2 


P d 


4 
c (kW) 


6 


8 °( 


) 20 



40 
P dc( kW ) 



60 



(a) (b) 

Fig. 4. (a) Relationship between fuel cell hydrogen consumption C& and DC/ DC power Pd c 
when Pdc^7.5kW (b) Relationship between fuel cell hydrogen consumption Q c and DC/ DC 
power Pdc when Pd c >7.5kW 

In the diesel engine + battery hybrid powertrain, the PU is composed of the diesel engine, 
the generator and the rectifier. In the following equations, Ci ce is the diesel engine fuel 
consumption, and P rec is the rectifier output power. The specific fuel consumption of the 
diesel engine is a complex function of torque and speed. Fig. 5 (a) gives an example of a TDI 
1.9 L diesel engine. The engine can work at different working points when the output power 
is Pi C e. Among these points there is an optimal working point, where the specific fuel 
consumption is minimal. The optimal working points compose an optimal curve, as shown 
in Fig. 5 (a). According to the optimal curve in Fig. 5 (a), we can find the relationship 
between the diesel engine output power Pi ce and the minimal fuel consumption Ci ce , as in 
Fig. 5(b). 



140 



Energy Management 




P ice (kW) 

(a) (b) 

Fig. 5. (a) The relationship between specific fuel consumption, torque and rotational speed 
of TDI 1.9L Diesel Engine. The dashed is the external characteristic, and the solid blue line is 
the optimal curve. (He Bin, 2006) (b) The minimal fuel consumption when the engine output 
power is Pi ce 



The fitting curve in Fig. 5 (b) can be expressed as: 



^ice — C 0*kq + ^l^Mce + C 2 



(6) 



where q, i=0~2 are fitting coefficients. For the TDI 1.9L engine, co=0.0002g.s- 1 .kW- 2 , Ci=0.0456 
g.s-i.kW- 1 , C2=0.2036g.s- 1 . The output power of the rectifier is calculated as: 



P =P n n 

rec ice 'sen n 



ice 'gen 'rec 



(7) 



where f/ gen and rj rec are the generator and rectifier efficiencies respectively. 
Then, the total fuel consumption C of the hybrid powertrain can be written as 



c = c +c 



(8) 



4. The equivalent consumption minimization strategy (ECMS) 

In the instantaneous optimization algorithm, an optimal output power of the PU is 
calculated to minimize the powertrain fuel consumption in one control cycle. It can be 
formulated mathematically as follows. 



^ P u,opt = arg min C = arg min (C pu + C bat ) 



subject to: 



SOC L < SOC < SOC H 

u h ■ <u h <u h 

bus,min bus bus,max 



0<P <P 

pu pu,max 



(9) 



Equivalent consumption minimization strategies of series hybrid city buses 141 

where Ubus,min and Ubus,max are the minimal and maximal value of bus voltage, P pu ,max is the 
maximan of P pu , C pu equals to C& in the fuel cell hybrid bus, C pu equals to d ce in the diesel 
engine hybrid bus. 

4.1 ECMS for the fuel cell hybrid powertrain 

As for the fuel cell city bus under discussion, the vehicle auxiliary power P aux , which is 
consumed by the cooling system, the electric assistant steering system et aL, is about 5kW 
(without the air condition) or 17kW (with the air condition). Therefore, the possibility of 
Pdc < 7.5kW is very small. That means, the relationship between the fuel cell hydrogen 
consumption Q c and the DC/ DC power Pd c could be regarded as linear in most of the time. 
Then, the optimized problem defined in Equation (9) could be simplified and the analytic 
solution to the problem is as follows. 



^bat, op t = min 



4 ^dis ^dis 



(10) 



where Pbat,o P t is the optimal battery power. If no braking energy is recovered, 8=1, then 

Pbat,o P t=0. This is because the relationship between the hydrogen consumption and the 

DC/ DC power is linear, any charging/ discharging process of the battery will cost an extra 

energy. 

With such a strategy, the battery SOC will fluctuate around the initial value. But usually we 

want to keep the SOC around a target value SOC tg . Thus, a balance power Pbat,baiance is 

defined as follows. 

^U lm ce=^(SOC-SOC tg ) (11) 

where k is a coefficient, fc>0. Then, the DC/ DC target power Pdc,t g is calculated as follows. 

^dc,tg = maX ( m i n (^demand ~ ^bat,opt ~ ^bat,balance > ^dc,max ) ' ^ J (12) 

where Pdemand is the powertrain demand power, including the electric motor power and the 
vehicle accessorial power. The VCU calculates the DC/ DC target voltage/ current according 
to Pdctg, sends the signal to the DC/ DC controller through TTCAN. There is a time-delay 
between the DC/ DC target signal and its actual output. This is because the fuel cell can't 
response quickly to dynamic loads. The fuel cell voltage drops with increasing current. A 
reactant starvation occurs at high currents and dynamic loads because the transport of 
reactant gases is not able to keep pace with the amount used in the reaction (Xu Liangfei et 
aL, 2008). 



142 



Energy Management 



4.2 ECMS for the diesel engine hybrid powertrain 

According to equations (6) and (7), the relationship between the d ce and P rec is. 



C X = ^gen^rec 



(13) 



The analytic solution for the optimized problem defined in Equation (9) can be written as 
follows. 



bat,opt 



u h . (u -u h ■ ) 

bus,mm y ocv bus,mm J 



U 1 



41L 



1- 



"dis 
z2\ 



K<dx m 



,dx < K < d 

> mm 



0,d<K<d/( n<: ^ vg n iis , ayg ) 

1 y / chg,avg / dis,avg J 



U 1 



4R, 



V 



J 



c/, 



bus,max 



\ bus,max ocv / 



R, 



K> 



/chg,avg 'dis,avg 

dx m 



<K<- 



dx m 



/chg,avg 'dis,avg 



max 



v chg /chg,avg 'dis,av 

where d, K, x m i n , x max are coefficients defined as follows. 



(14) 



d = c l +2c P demmd 



K- 



fc,avg ^ /dis,avg 'chg,avg J ' bat 



C l(n n \ P < 

fc,avg \ 'dis,avg /chg,avg / ' bat 
min yl bus,min \ bus,min ocv / / y ocv J 

max \/ bus, max y bus,max ocv / / \ ocv J 



(15) 



Equations (14) and (15) indicate that, the battery optimal power Pbat,o P t is a function of 
vehicle power demand Pdemand, battery SOC and the ratio coefficient 5. Pbat,o P t=/(Pdemand, SOC, 
5). In real-time application, this function can be calculated and stored in the ECU memory. 
The target power of the rectifier P re c,t g is calculated using a similar formula as Equation (12). 



^rec,tg maX \^ mm \ demand ^at^pt ^bat,balance ' ^rec,max J ' ^ ) 



(16) 



Equivalent consumption minimization strategies of series hybrid city buses 143 

The output power of the rectifier is controlled by a PWM signal from the VCU to the 
excitation controller. According to P re c,tg and the optimal curve in Fig. 5 (a), the optimal 
working point (a) eng , T eng ) can be found. The target rotational speed of the diesel engine CD en g 
is controlled by a simulant throttle signal from the VCU to the engine controller. In order to 
reduce the emission during dynamic loads, there is a time-delay between the command of 
VCU and the actual output of the engine (He Bin, 2006). 

5. Results in the cycle testing 

The instantaneous optimal energy management strategies have been successfully 

implemented in the two hybrid city buses. The hybrid powertrains were tested on the test 

bench with " China city bus typical cycled Results are presented in Fig. 6 (a)~(d). 

Fig. 6 (a) and (b) presents the results of the fuel cell hybrid city bus in the cycle testing, 5 = 

0.6. The vehicle velocity is shown in Fig. 6 (a). The test lasts about 20mins, and the maximal 

speed is 60km.lv 1 . The battery SOC was kept around 70%. 

Fig. 6 (b) shows the power split between the electric motor, the battery and the PU (Fuel cell 

+ DC/ DC converter). Part of the braking energy was recycled. In this figure, P m stands for 

the electric power of the motor. The electric power ranged from -50kW to lOOkW. Because of 

the time-delay between the DC/ DC target command and its actual output, the DC/ DC 

output power changed much more slowly than the motor electric power. The battery 

functioned during accelerating and decelerating. It was kept charge-sustaining. 

Fig. 6 (c) indicates the energy flow diagram. The hydrogen energy is calculated on the basis 

of its low heat value. The average efficiencies of the fuel cell system, the DC/ DC converter 

and the electric motor were 50%, 96% and 85% respectively. About 5.5% of the whole energy 

was consumed by the vehicle auxiliary components, e.g. the air condition. About 45.2% of 

the hydrogen energy was output from the electric motor, and about 9.5% of the hydrogen 

energy was recycled. The battery slightly discharged. The fuel economy of the city bus was 

about 7.4kg.l00km-!. 

The fuel consumption increases with 5 increases. Testing results show that, their relationship 

is as follows. 

5=0.6, fuel economy = 7.4kg.l00km-i; 

5=0.85, fuel economy = 8.9kg.l00km-i; 

6=1, fuel economy = 9.7kg.l00km- 1 . 

The energy flow diagram of the diesel hybrid powertrain, but not the city bus, is shown in 

Fig. 6 (d). The average diesel engine efficiency was about 33.5%, which is lower than the fuel 

cell engine. The total efficiency of the generator and the rectifier was about 85%. There were 

no vehicle auxiliary components, because the testing was carried out on a test bench. About 

33.1% of the whole energy was output from the electric motor, and about 11% of the energy 

was recycled. The battery slightly discharged. As a result, the fuel economy was SOL.lOOknv 1 , 

the NOx emission was S.Sg.knv 1 , and the PM emission was O.lg.knv 1 (Cao Guijun, 2009). 



144 



Energy Management 



6. Conclusions 

This chapter proposes an Equivalent Consumption Minimization Strategy (ECMS) for the 
series hybrid city buses with two different powertrain configurations, Fuel cell + battery and 
diesel engine + battery. 

An equivalent consumption model is firstly introduced, incorporating the fuel consumption 
of power unit and the battery equivalent consumption. The concept of the equivalent 
consumption is further developed compared with its origin. The ECMS is developed based 
on the analytical solution to the instantaneous optimization problem. 

Because of the linear relationship between the fuel consumption and the DC/ DC power, the 
battery optimal power is a function of the battery SOC and the ratio coefficient 5. 

The ratio coefficient 5 depends on the braking regeneration strategy. And it changes with 
the working conditions of the powertrain system. It is the key parameter of the ECMS, and 
changes with time. Besides, a battery balance power is introduced to keep the battey SOC 
around a target value. 




* o 



200 400 600 800 1000 1200 1400 
f(s) 




200 400 600 800 1000 1200 1400 
f(s) 



(a) 



^vw^ttYHT 



200 400 600 800 1000 1200 1400 
f(s) 



200 400 600 800 1000 1200 1400 
f(s) 

200 400 600 800 1000 1200 1400 
f(s) 

(b) 



Equivalent consumption minimization strategies of series hybrid city buses 



145 



hydrogen Energy 
( 100%- 



Fuel Gel I syst em ef f i ci ency 
50% 



Desel engi ne (100%- 



D esel engi ne ef f i ci ency 33. 5% 



DO DC efficiency 



NMH 
Jattery 



- 2. 7% 



Bier gy I oss < ^ — ^ 
Bier gy I oss 



I 

53. 2% 



33.5' 



Generator and 

recti fi er 
eff i ci ency 85% 



_hfiier 



gy loss 



\fehicle 
auxi I i ary 
energy 
5. 5% 



NIVH 
Battery 



28. 8% 



0. 85% 



Bier gy I oss / — ^ 
Bier gy I oss 



B ect r i c not or 

(average 
eff i ci ency 85^ 



9.5% 45 " 2% 

I 



t 



Bier gy I oss 



B ect r i c not or 
(average eff i ci ency 



Biergy 
;=>Loss 



33. 1% 



r. 



Biergy 
^Loss 



(c) (d) 

Fig. 6. (a) Vehicle velocity and the battery SOC in the " China city bus typical cycle" (b) 
Power split of the fuel cell hybrid city bus, 5 = 0.6 (c) energy flow diagram of the fuel cell 
hybrid city bus (d) energy flow diagram of the diesel hybrid powertrain, 5 = 0.6 

The ECMS of the diesel hybrid powertrain is a little complex, because there is a quadratic 
relationship between the fuel consumption and the engine power. The battery optimal power is a 
function of powertrain demand power, battery SOC and the ratio coefficient 6. For the same 
reason, the balance power is introduced to calculate the target power of the rectifier. 

The fuel cell + battery city bus was tested in the " China city bus typical cycle". Results show 
that, the battery SOC was kept around 70%, and the fuel economy was 7.4kg. 100km 1 . Fuel 
consumption increases with the ration coefficient 5 increases. 

The diesel + battery powertrain was tested in lab with the same cycle. Results show that, the 
battery SOC was kept in balance, and the fuel economy was SOL.lOOkm 1 . 

In this chapter, we only consider the fuel economy in the optimal strategy. However, the fuel cell 
durability and the exhaust emission should also be included in the optimized strategy. 

Because of the linear characteristics of the fuel cell system, the fuel economy is mainly 
determined by the ratio coefficient 5. It means that, the braking regeneration strategy contributes 
much more than the power split strategy. Thus, the primary challenge in power split strategy is 
to prolong the fuel cell durability, while fulfill the powertrain power demand. 

The fuel economy of the diesel engine hybrid bus is determined by 5, SOC and vehicle 
power demand. The braking regeneration strategy is also very important. The primary 
challenge of the control system is to make the engine work on the optimal curve, as in Fig. 5 
(a). Actually we use a feedforward + feedbackward method to control the engine working 
point so as to lower the fuel consumption and the exhaust emission (Cao Guijun, 2009). This 
control problem is valuable to be studied in future. 



146 Energy Management 



7. References 

N., Jalil; N., A., Kheir & M., Salman. (1997). A rule-based energy management strategy for a 

series hybrid vehicle, Proceedings of the American Control Conference, pp. 689-693 
S., Aoyagi; Y., Hasegawa; T., Yonekura; H., Abe. (2001). Energy efficiency improvement of 

series hybrid vehicle. JSAE Review, Vol. 22, (2001), pp. 259-264 
G., Paganelli; S., Delprat; T., M., Guerra; J., Rimaux; J., J., Santin. (2002). Equivalent 

consumption minimization strategy for parallel hybrid powertrains. IEEE Vehicular 

Technology Conference, Vol. 4, (2002), pp. 2076-2081 
C., C., Lin; H., Peng; J.,W., Grizzle; J., Kang. (2003). Power managment strategy for a parallel 

hybrid electric truck. IEEE Transactions on Control Systems Technology, Vol. 11, (2003), 

pp. 839-849 
Andreas Schell; Huei Peng; Doanh Tran; et al. (2005). Modelling and control 

strategy development for fuel cell electric vehicles. Annual Reviews in 

Control, Vol. 29, No. 1, pp. 159-168 
B., He; M., Yang. (2006). Optimization-based energy management of series hybrid 

vehicles considering transient behavior. International Journal of Alternative 

Propulsion,Vol. 1, No. 1, pp. 79-96 
Schouten N., J.,; Salman M., A.,; Kheir N., A. (2007). Fuzzy Logic Control for Parallel Hybrid 

Vehicles. IEEE Transactions on Control Systems Technology, Vol. 10, No. 3, pp. 460-468 
Amin Hajizadeh; Masoud Aliakbar Golkar. (2007). Intelligent power management strategy 

of hybrid distributed generation system. International Journal of Electrical Power & 

Energy Systems, Vol. 29, No. 10, pp. 783-795 
Vanessa Paladini; Teresa Donateo; Arturo de Ris; et al. (2007). Super-capacitors fuel cell 

hybrid electric vehicle optimization and control strategy development. Energy 

Conversion and Management, Vol. 48, No. 1, pp. 3001-3008 
Xi Zhang; Chunting Mi; Abul Masrur & David Daniszewski. (2008). Wavelet Based Power 

Management of Hybrid Electric Vehicles with Multiple Onboard Power Sources. 

Journal of Power Sources, Vol. 185, No. 2, pp. 1533-1543 
Paganelli G., ; Delprat S., ; Guerra T., ; et al. (2002). Equivalent consumption 

minimization strategy for parallel hybrid powertrains. IEEE 55th VTC, 

Birmingham, Al, USA,Vol. 4, pp. 2076-2081 
Xu Liangfei; Hua Jianfeng; Li Xiangjun; Meng Qingran; Li Jianqiu; Ouyang Minggao. (2008). 

Control strategy optimization of a hybrid fuel cell vehicle with braking energy 

regeneration. IEEE Vehicle Power and Propulsion Conference, Harbin, China, pp. 1-6 
Cao Guijun. (2009). Research on the auxiliary power unit of the diesel based series hybrid 

electric powertrain. PhD dissertation, Tsinghua University, Beijing, China 
He Bin. (2006). Energy management and dynamic control of series hybrid vehicles. PhD 

dissertation, Tsinghua University, Beijing, China 
V., H., Johnson. (2002). Battery performance models in ADVISOR. Journal of Power Sources, 

Vol. 110, No. 2, pp. 321-329 



8 



Intelligent Energy Management 
in Hybrid Electric Vehicles 

Hamid Khayyam 1 , Abbas Kouzani 1 , Saeid Nahavandi 1 , 
Vincenzo Marano 2 and Giorgio Rizzoni 2 

Deakin University Australia 1 and The Ohio State University USA 2 



1. Introduction 



Energy management in vehicles is an important issue because it can significantly influence the 
performances of the vehicles. Improving energy management in vehicles can deliver 
important benefits such as reducing fuel consumption, decreasing emission, lower running 
cost, reducing noise pollution, and improving driving performance and ease of use. According 
to Mainins (Manins, 2000), each year more then 50 million new cars are produced in the world. 
However, usually only 30% to 40% of the energy produced by the engine is used to drive a car. 
The large energy waste of around 60% is the result of having an engine powerful enough to 
cope with the maximum power demand despite the fact that such power is required for only a 
vary small percentage of vehicles' operating time. In addition, vehicle emissions are a source of 
greenhouse gas pollution emitting 70% to 90% of urban air pollution (SOE, 2006). Fuel 
economy benchmarks and emission regulations have encouraged vehicle manufactures and 
researchers to investigate new technologies to enhance fuel economy and minimise emissions. 
The energy efficiency of vehicles can be improved by enhancing the efficiency of the vehicle. 
Implementing energy management strategies in classical vehicles does not fully deliver the 
expected benefits. Hybrid electric vehicles, on the other hand, offer a platform that can 
accommodate advanced energy management strategies giving rise to full realization of the 
stated benefits. Intelligent energy management methods can observe and learn driver 
behavior, environmental and vehicle conditions, and intelligently control the operation of 
the hybrid electric vehicle. 

A Hybrid Electric Vehicle (HEV) takes advantage of an Internal Combustion Engine (ICE) 
and an Electric Motor (EM) to deliver fuel consumption and exhaust emission reduction. An 
EM is powered by on-board battery packs to drive the vehicle. From the consumers overall 
perspective, the HEV is essentially the same as a Conventional Vehicle (CV). Moreover, 
HEVs are refuelled in the same way as a CV. A HEV has the advantage over a pure Electric 
Vehicle (EV) in both travelling range and convenience, as there is no need to recharge the 
battery through a power point for long hours. Importantly, a HEV has the potential to 
improve fuel economy by almost 50%, while also possessing all the advantages and 
flexibility of a CV (Ehsani et al,. 2005). Hence, HEVs solve the problems of EVs whilst 
minimising the shortcoming of CVs providing the benefits of both electric and conventional 



148 



Energy Management 



vehicles. HEVs are categorised into three groups: Series (S-HEV), Parallel (P-HEV), and 
Series/ Parallel (S/ P-HEV) as shown in Fig. 1. 

In an S-HEV, there is no mechanical link between the ICE and drive train. This means that 
the ICE can run continuously in its preferred operating range, whereas the drivetrain is 
driven by an electric machine. For the electric power request, it relies on the battery plus the 
generator. The generator is driven by the ICE and maintains an appropriate energy level in 
the battery. A disadvantage of this configuration is that energy is first converted from 
mechanical power to electric power with the generator and then back to mechanical power 
by the electric machine, both introducing losses. 

The P-HEV establishes a parallel connection between the ICE and the electric machine that 
both are allowed to give force to the drive the vehicle. The power through the EM can be 
positive as well as negative. This allows the EM to operate in motor mode and generator 
mode. At a top-level view, the P-HEV configuration looks similar to a conventional vehicle, 
although the EM in a conventional vehicle operates only in generator mode. 
Finally, the last vehicle configuration is an S/ P-HEV. It merges the topology of a series and a 
parallel HEV. S/P-HEVs have the highest complexity since power to the drivetrain can follow 
various trajectories. Recently plug-in hybrid electric vehicle (PHEV) has come to market. A 
PHEV is a hybrid electric vehicle that described above. The PHEV batteries can be recharged 
by plugging into an electric power source. A PHEV combines type of conventional hybrid 
electric vehicles and battery electric vehicles, possessing both an internal combustion engine 
and batteries for power. The desire strategy using PHEV can be employed as follows: in short 
distance travelling electric vehicle (EV) mode operation such as urban and for long distance 
travelling hybrid electric vehicle (HEV) mode operation such as highways. 
The most important challenge for the development of P-HEV is the synchronization of 
multiple energy sources and conversion of power flow control for both the mechanical and 
electrical paths in optimal fuel efficiency and battery areas. The difficulty in the development 
of hybrid electric vehicles is the coordination of multiple sources such as mechanical and 
electrical. The reason why a P-HEV is considered in this work is that it has fewer disadvantages 
and less complexity (Kessels.J, 2007) (Ehsani et al.,2005). 



Z V ^U W T FT Z L 

^j G EM,G y\ ^™ 




Serial Hybrid Electric Vehicle 



Parallel Hybrid Electric Vehicle 
Legend 



Battery 
Fuel Tank 
Engine 
Generator 
Motor/Generator 
Transmission 
Electrical Link 
Mechanical Link 
Hydraulic Link 




Serial/Parallel Hybrid Electric Vehicle 



G 

M/G 



Fig. 1. Three HEVs structures. 



Nevertheless, any vehicle needs to deal with uncertain factors such as environment 
conditions and also driver behaviour. HEVs are a highly complex systems comprising a 



Intelligent Energy Management in Hybrid Electric Vehicles 149 

large number of mechanical, electronic, and electromechanical elements (Zhu et al.,2002). 
Hence a HEV can be considered as a Complex System (CS). 

A Complex System is a system that can be analyzed into many components having 
relatively many relations among them, so that the behaviour of each component depends on 
the behaviour of others (Simon. A.H,1973). 

In the real world, many problems and systems exist that are too complex or uncertain to be 
represented by complete and accurate mathematical models. However, such systems need 
to be designed, optimized, and controlled. CSs can be handled by Intelligent Systems (ISs). 
ISs can learn from examples, are fault tolerant, are able to deal with non-linear problems, 
and once trained can perform prediction and generalization at high speed. Intelligence 
systems have been used in diverse applications in control, robotics, pattern recognition, 
forecasting, medicine, power systems, manufacturing, optimization, signal processing, and 
social/ psychological sciences. They are useful in system modelling such as in implementing 
complex mappings and system identification. ISs comprise areas like expert systems, 
artificial neural networks, genetic algorithms, fuzzy logic and various hybrid systems, 
which combine two or more of these techniques. ISs play an important role in modelling 
and prediction of the performance and control of energy and renewable energy processes. 
According to literature, ISs have been applied to energy and renewable energy engineering. 

ISs can be developed through modelling and simulation. The modelling and simulation 
approach has become an essential tool for mechanical engineers and automotive researches in 
improving efficiency and timing of vehicle design and development, resulting in the delivery of 
significant cost saving as well as environmental benefits. The modelling and simulation is 
generally defined as mathematical realisation and computerised analysis of abstract 
representation of systems. The modelling and simulation helps achieve insight into the 
functionality of the modelled systems, and investigate the systems' behaviours and 
performances. The modelling and simulation is used in a variety of practical contexts relating to 
the design, development, and use of conventional as well as advanced vehicles including: design 
and evaluation of vehicle performance, fuel consumption, emission, energy storage devices, 
internal combustion engine, hybrid engine, accessories, composite materials, determination of 
drag using wind tunnel, training drivers trough virtual vehicle, collecting and analysing sensory 
information, identifying critical test conditions, investigating crash factors, characterising road 
topology, testing and analysing energy management strategies, and so on. 

This work employs the modelling and simulation approach to develop an Intelligent Energy 
Management System (IEMS) for a P-HEV. 

The main objective is to optimize fuel consumption and reduce emissions. The work involves the 
analysis of the role of drivetrain, energy management control strategy and the associated impacts 
on the fuel consumption with combined wind/ drag, slope, rolling, and accessories loads. 

2. Literature Review and Background 

This section provides a review of the main approaches used in modelling and control of 
energy management of HE Vs. In a CV, energy can be dissipated in a number of ways 
including (Kessels.J, 2007): 

i. Brake utilisation: The brake is applied by the driver to decelerate the vehicle 
resulting in the loss of kinetic energy in the form of heat. 



150 Energy Management 

ii. Engine start/ stop: The engine often runs idle during the utilisation of vehicle 

resulting in an unnecessary consumption of fuel, 
iii. Uneconomic engine operating condition: An engine often demonstrates non- linear 

fuel consumption behaviour in certain operating conditions that causes an 

excessive use of fuel, 
iv. Unscheduled load: Certain mechanical and electrical loads get activated outside the 

economic operating point of engine increasing the fuel consumption. 

P-HEVs provide a platform to reduce the wasted energy. The most important challenge for the 
development of P-HEV is the synchronization of multiple energy sources and conversion of 
power flow control for both the mechanical and electrical paths. Control in HEVs is recognized 
as two levels of actions: supervisory control and component control. In this study supervisory 
control is investigated as a suitable control strategy in energy management. 
The control strategy is an algorithm that is used for issuing a sequence of instructions from 
the vehicle central controller to operate the drivetrain of the vehicle. The control strategy 
needs to monitor uncertain events. Moreover, in order to improve the system, the control 
strategy can provide optimized energy management. The control strategies in a P-HEV can 
be classified in two main groups as follows. 

2.1 Rule-Based Control 

The control rules techniques are based on mathematical, heuristics, and human expertise 
generally with an analytical knowledge of a predefined driving cycle. Control rules can be 
categorized in three methods. 

A. Rule-Based 

This method is based on an examination of the power requirements, ICE efficiency, fuel or 
emission maps. Human knowledge is used to design rules to split the requested power between 
converters. The method can be categorized into three groups: on/ off control (Ehsani et al.,2005), 
base line control (Zhu et al.,2002) (Sciarretta et al, 2004) (Linl et al.,2004) (Lyshevski,1999) 
(Barsali et al., 2004) (Khayyam et al., 2008), and discrete time events (Zhang & Chen, 2001) 
approaches. 

B. Fuzzy logic 

Fuzzy logic control has a nonlinear structure that can deal with the nonlinear structure of 
the power split problem. Fuzzy logic has a more robust structure and offers more design 
flexibility. The problem with fuzzy logic is the optimization and mathematical manipulation 
of defuzzification system. The defuzzification process consumes memory and time in 
controller. Some fuzzy logic controller have been developed for HEVs including (Baumann 
et al, 2000) (Farrokhi & Mohebbi, 2005) (Langari &won, 2005) (Mohebbi et al.,2005) ( Salman 
et al., 2000) (Schouten et al.,2002) (Hajimiri at al, 2008). 

C. Neuro-Fuzzy 

There are also combinations of fuzzy logic and artificial neural called neuro-fuzzy control 
(Mohebbi et al.,2005) and fuzzy discrete event control (Bathaee et al., 2005). 



Intelligent Energy Management in Hybrid Electric Vehicles 151 

2.2 Optimal Control 

In optimal control the controller is optimized according to a cost function of the system. 
Therefore, optimal control strategies are almost perfect. However, the optimal controllers 
are sensitive to parameter changes and also to noise. To perform the optimization process, 
all the dynamic and static behaviours of the system components are taken into 
consideration. Calculations are usually simplified by introducing assumptions which means 
that the solution is optimum only under the assumptions. On the other hand, the discrete 
time events method is simple and more robust. System behaviours are divided into discrete 
events. Each event is connected to another by certain rules (Mohebbi & Farrokhi, 2007). 
If this optimal control is performed over a fixed driving cycle, a global optimum solution 
can be found. In fact, the optimal control system solution is noncasual in that it achieves the 
reduction of fuel consumption using information of future and past power demands. 
Obviously, this technique cannot be used directly for real-time energy management. 
Optimal control can be divided in two groups as follows. 

A. Global Optimization (off line) 

There are several reported solutions to achieve performance targets by optimization of a cost 
function representing efficiency over a drive cycle, yielding global optimal operating points. 
The global optimization techniques are not directly applicable for real-time problems, 
considering the fact that they are casual solutions. This is due to their computational 
complexity. Some of the global optimization methods are given below: 

A.l Neural Networks 

Neural networks have the ability to be trained online or offline, but online training 
consumes memory in a controller. This trainability characteristic makes neural networks as 
a good candidate for adaptive energy management systems. As an example, the work 
presented in (Mohebbi &Farrokhi,2007) developed a neural network for optimal control. 
Prokhorov (Prokhorov D.V , 2008) used a neural network controller for improved fuel 
efficiency of the Toyota Prius hybrid electric vehicle. A new method to detect and mitigate a 
battery fault was also presented. The developed approach was based on recurrent networks 
and included the extended Kalman filter. 

A.2 Classical Optimal Control 

(Delprat et al,. 2004) used the optimal control theory based on Lewis and Syrmos (Lewis & 
Syrmos., 1995) work. This method is directly applied to find a global solution for the energy 
management problem in a parallel torque-addition arrangement. The analytical nature of 
this method makes it a good one. However, variation of drivetrain structure makes it 
difficult to find an analytical solution, compared with numerical and iterative-based 
methods. Some optimal control have been developed for HEVs including (Wei et al.,2007) 
(Pisu & Rizzoni,2007) (Musardo et al.,2007). 

A.3 Linear Programming 

This method can formulate the problem of optimizing the fuel efficiency as a nonlinear 
convex optimization problem that is approximated by a large linear program (Tate & 



152 Energy Management 

Boyd,1998). The approximations used for transformations and the fact that LP may not be 
applicable to a more sophisticated drivetrain degrade the proposed approach. 

A.4 Dynamic and Stochastic Programming 

Dynamic Programming (DP) method utilizes the minimizing cost function over a driving 
cycle. (Lin et al.,2003) demonstrated that the approach does not give a real-time solution by 
nature. A family of random driving cycles needs to be used to find an optimal solution. 

A.5 Genetic Algorithm 

The Genetic Algorithm (GA) has been used to solve a constrained nonlinear programming 
problem. (Piccolo et al.,2001) showed that GA is very useful for complex nonlinear optimization 
problems. This is because GA leads to a more accurate exploration of the solution space than a 
conventional gradient-based procedure. But GA dose not give the necessary view to the designer 
of the powertrain , unlike an analytical approach. Montazeri et al. (Montazeri et al., 2006) 
described the application of genetic algorithm for optimization of control parameters in P-HEV. 

B. Real Time Optimization (on line) 

In order to develop a cost function for real-time optimization, the following methods can be used. 

B.l Model Predictive Control 

(Salman et al., 2005) utilized a look-ahead window to find a real-time predictive optimal 
control law. This approach can be used for superior fuel economy by previewing the driving 
pattern and road information. 

B.2 Decoupling Control 

(Barbarisi et al.,2005) proposed a novel strategy to assure acceptable drivability of the 
vehicle that was based on the vehicle's dynamic model. Based on the proposed decoupling 
methods, the controller's output is composed of different components. 

B.3 Genetic-Fuzzy 

The genetic-fuzzy control strategy is a fuzzy logic controller that is tuned by a genetic 
algorithm. Poursamad et al. (Poursamad et al.,2008) and Montazeri et al. (Montazeri et al., 
2008) applied these control strategy model to minimize fuel consumption and emission. 

2.3 Discussions 

The presented work is focused on a control strategy to reduce fuel consumption though 
considering performance and driveability. Our optimal control strategy is found in two 
steps, first finding the control which results in the reduction of fuel consumption together 
and offering the best performance, and second taking vehicle driveability into consideration. 
Among the control strategies for the best fuel economy, dynamic programming is the only 
one that assures global optimality if the driving cycle is known in advance. 
However, it does not apply to real-time problems. On the other hand, fuzzy logic, rule- 
based, and neuro-fuzzy controllers are not generally optimized, but applied to real-time 



Intelligent Energy Management in Hybrid Electric Vehicles 



153 



problems. If the future driving conditions of a few minutes ahead can be predicted then the 
optimal controller can help find a suboptimal solution. 

3. Factors Involved in Energy Management of Hybrid Electric Vehicles 

Bandivadekar and Heywood (Bandivadekar & Heywood, 2007) presented an analysis that 
shows the possibility of halving the fuel consumption of new vehicles by 2035. Enhancement in 
vehicle control and management strategies is considered to be an influential mean in reducing 
the fuel consumption of vehicles. Energy management approaches in vehicles can be realised 
through considering a number of factors including (Cacciabue et al., 2009): environmental 
conditions, driver behaviour, vehicle specifications, and intelligent transportation approach 
(EPA, 2004). In order to develop an energy management system, a number of models need to be 
implemented and used. These models are described in the following. 

3.1 Main factors involved in energy management system of HEVs 

A HEV can be considered as a complex system consisting of subsystems. In the 
development of energy management systems, model of the HEV subsystems are developed 
and used. Fig. 2 shows an overview of the energy management model for HEVs. 



Current 
Environment Model 



Look-Ahead 
Environment Model 



Environment 



IEMS 



Strategy Data 



Speed, 



Acceleration 
Desired 



Decision j4 ( Perception ^ [ Sensation 

Driver Behivour 



Propulsion Balance 



D5 



(J: 



Hybrid Electric Vehicle 

Fig. 2. Overview of the energy management model for HEVs. 



3.2 Model of Environment 

Among the factors that are involved in HEV systems, the environment conditions such as road 
geometrical specifications and wind behaviour are often unknown and uncertain during 
drives. The information about the geometrical specification and wind behaviour of the road 



154 Energy Management 

ahead of the vehicle can be used by an intelligent system to reduce fuel consumption of the 
vehicles (Khayyam et aL, 2008). However, this information is often unavailable to the 
intelligent system on-board of a vehicle in real-time. Thus, utilising on-line and off-line 
prediction and monitoring of the geometrical specifications and wind behaviour of the road 
ahead of vehicles can improve their performances. Environmental information can be 
categorized in two groups: current and look-ahead. The data include road geometry, road 
friction, wind drag, and ambient temperature. It has been demonstrated that lookahead 
environment information can be employed by the energy management system to achieve 
reduction of fuel consumption (Hellstrom et al.,2009). Khayyam et al. (Khayyam et al.,2008) 
presented a Slope Prediction Unit (SPU) to calculate the slope angle of the road within the 
distance of 50-300 meters away from the vehicle. This information reduced fuel consumption 
about 6.1% liter/ 100 km during simulation. Global Positioning Systems (GPS) and Geographic 
Information Systems (GIS) can provide static and dynamic road information. 
Current Environment Model (CEM) is an algorithm that creates data associated with 
environmental conditions and frictions. Look-ahead Environment model (LEM) is an 
algorithm that creates data associated with future environmental conditions and frictions 
encountered by the vehicle. 

In order to model environment, a number of methods can be used. Khayyam et al. 
(Khayyam et al.,2009a) proposed a method that can be used to produce authentic highway 
height data using a set of probability distributions. They considered a highway as a complex 
road which can have any kind of possible geometrical variations. The presented method 
models highway heights by Rayleigh probabilistic distribution function. In addition, 
highway geometric design laws were employed to modify the created highway data making 
it consistent with the real highway situation. The proposed model is then used to produce a 
3D realistic road. The method is called a Probabilistic Highway Modelling (PMH) technique. 
PMH is capable of creating artificial highway and wind data that possess statistical 
characteristics of real highway and wind situations. A highway is considered to contain a 
collection of road segments. The Poisson Probability Distribution Function (PDF) is used to 
produce a random number that determines the number of road segments. Segments can 
then have different lengths. For each segment, the exponential PDF produces a random 
number that represents the segment length. In addition, for each segment, two other 
random numbers are generated and used to form the geometry of the segment. The 
Rayleigh PDF is employed to produce a random number that represents the height change 
of the segment. Also, the Gaussian PDF is used to form a random number that gives the 
bend deflection change in the segment. The random numbers for height and bend could be 
small or large injecting varying degrees of heights and bends into different road segments. 
Also, highway geometric design laws are used to modify the created highway data to make 
it consistent with the real physical highway situation. 

A wind is constructed using a collection of regions of differing lengths. A wind creation 
algorithm is an iterative routine. The algorithm creates wind speed and direction values for 
each region. The exponential PDF produces a random number that represents the region 
length. The Weibull PDF is employed to produce a random number that represents the wind 
speed value in the region. Also, the uniform PDF is used to form a random number that 
gives the wind direction value in the region. 

The PHM can be employed in simulation of problems involving highway roads such as 
energy optimization of conventional and hybrid electric vehicles. Fig. 3 displays a flowchart 



Intelligent Energy Management in Hybrid Electric Vehicles 



155 



diagram description of the highway creation algorithm using the PHM. The result of the 
highway creation algorithm demonstrates in Fig. 4 that show a 3D representation of the 
constructed sample highway using the PHM. Fig. 5 displays a flowchart diagram 
description of the wind creation algorithm using the developed PHM concept. 




Create the number of segments (s) 
using Poisson PDF 



T 



Create the initial direction angle ( <^o= O- 

360°) and the height value (Ho) using 

Uniform PDF 




Create the length value for segment i 
(Li) using Exponential PDF 



Create the height value for segment i 
(Hi) using Rayleigh PDF 



Create the bend value for segment i 
(Bi) using Gaussian PDF 



Calculate geometry parameters 



Smoothen bends and slopes using 
curve comforts 



Fig. 3. Highway creation algorithm using the developed PHM. 



^toi^ 



£ 250 
-S 200 



~ 150 - 
< 




Y position(m) 
X position(m) 

Fig. 4. 3D representation of the constructed sample highway using PMH technique. 



156 



Energy Management 




Create a random binary number 
using Unifrom PDF 


(b) 


± 


O reate 


the length value for region 
using Exponential PDF 


i (Li) 



Wind speed value -for 
region i (Si) = O 




Create the wind speed 

value for region i 
(Si) using Weibull PDF 



Wind direction value for 
region i (Di) = O 



/vir 
lio 
Un 



Create the wind direction 

value for region i in [O 3S9J 

(Di) using Uniform PDF 




Fig. 5. Wind creation algorithm using the developed PHM. 



3.3 Model of Driver 

Driver behaviour has a strong influence on emissions and fuel consumption of the vehicle. 
Modelling driver behaviour can be done using different methods. As an example, the 
Driver-Vehicle-Environment (DVE) (Cacciabue, 2007) (Lin et al., 2005) method models 
human machine interaction and associated taxonomies for classifying human behaviour. De. 
Vlieger et al. (De. Vlieger et al.,2000) identified three types of driving behaviour as follows: 

1- Calm driving that implies anticipating other road user's movement, traffic lights, 
speed limits, and avoiding hard acceleration. 

2- Normal driving that implies moderate acceleration and braking. 
3-Aggressive driving that implies sudden acceleration and heavy braking. 

Moreover, they note that emissions obtained from aggressive driving in urban and rural 
traffic are much higher than those obtained from normal driving. A similar trend is 
observed in relation to fuel consumption. It is stated that the driving style affects the 
emission rate and the fuel consumption rate. 

Average acceleration and Standard Deviation (SD) of acceleration over a specific driving 
range are used to identify the driving style. Acceleration criteria for the classification of the 



Intelligent Energy Management in Hybrid Electric Vehicles 



157 



driver's style are based on the acceleration ranges proposed by De Vlieger et al. (De Vlieger 
et al. 2000). They defined the typical ranges of average accelerations as describe in table 1. 



Acceleration 


Calm 
Driving 


Normal 
Driving 


Aggressive 
Driving 


City 

Journey (m/s 2 ) 


4.85-6.9 


6.98-8.6 


9.15-11.8 


Highway 
Journey (m/s 2 ) 


0.85 


1.0 


2.16 



Table 1. Overview of the tested acceleration (De Vlieger et al., 2000). 

Our objective is to use support dynamic real-time driver behaviour system in the energy 
management system. A driver first determines the drive strategy, selects the engine 
specifications, starts the vehicle motion, and controls the mass flow rate of fuel into ICE by 
changing the pedal, gear, brake, and clutch. Also, the driver sends this data as drive strategy 
toIEMS. 



3.4 Model of Vehicle (Quasi-Static) 

In a P-HEV, both the Internal Combustion Engine (ICE) and the Integrated 
Starter/ Generator (ISG) can give tractive force to the wheels. Furthermore, the ISG will be 
used as a generator to supply the electric loads. A schematic drawing of the vehicle 
configuration is shown in Fig. 6. 



r 



p f 



— ► Engine 



* 



Battery 



Pd 



( f \ Ps J Batter y 

\ ^s i Efficiency 



Pb _ Pc 

<>^ 



Electric Per 
Motor 



Phev 

ISG 4 »L- 



Drive Pnet 

Train 



Wheels 
Pnet I 

~i 



Power 
Split 



Fig. 6. P-HEV topology (Kessels.J,2007). 

The power demand of the drivetrain Pd covers all the elements of the drivetrain, including 
the transmission and the clutch. The engine speed CO and the drivetrain torque U are 
calculated back from the vehicle speed and denote the driver's power demand: 



P d = ®T d 



(1) 



The power split device is assumed to have no energy losses and establishes the following 
power balance: 



(2) 



Where : Phev is hybrid power and P e is engine power. 



158 Energy Management 

3.4.1 Conventional Vehicle Specification 

A vehicle ICE can be treated as a controlled volume system whose energy balance is given 
as follows: 

z~-combaustioi \z--fuel z^air ^--exhaust) (jj 

= P + P +P +P +P +o +o 

road- friction drag slope accessory driving ^water/oil z^heatloss 



In order to include all losses, Equation (3) is reformed into the following equation where the 
effect of different losses is taken into account by corresponding efficiencies: 



(Q combustion ) X lotto X V M ^ X 1 



mechanical 



(4) 



p _|_ p _|_ p _|_ p _|_ p 

road — friction drag slope accessory driving 



where: p = Power output of engine 

ri otto =Otto cycle efficiency= i =0.529 (Pullkrabek,1997) 

1 " ^(r-i) 

= Real fuel air engine efficiency =0. 75 (Yaodong Wang,2007) 

fuel -air 

=Mechanical efficiency =0.9 (Plint ,1997) 

mechanical 

= Heat loss efficiency=0.8 (Pullkrabek,1997) 

heat loss 

These efficiency are depend on some variable factors and situations. They can be measured 
by industrial vehicle companies. In the section 3.4.3 we will select specific efficiency in our 
model.To calculate n Equation (3) is used: 

z^combaustion x v ' 

combustion fuel ¥ combustion 

where a is the combustion energy. In this model, the fuel is assumed to be r H in 

^combustion oJ ' ^n 11 \.%ln 

(Wang et al., 2007) . The complete combustion of c H with 1+k percent theoretical air is 
written as: 

C,H U96 + kxll.74x(0 2 +3.76)N 2 > ^ 

8C0 2 + 1ASH 2 + 1 1 .14(k - \)0 2 + 1 1 .74 x 3 .76 x £ x 7V 2 

If the heat transfer was accurately measured, the released energy would be 109100 kJ/ per 

/kg 
8 mole of C0 2 (Hey wood .B.J, 1998). The result of Equation (6) gives: 

^combustion + Z ™ W +Ak ^ = W C.V . + Z * e I k f + Ah h (7) 

Where: 

^ n t [h f +AA]. = h f C s H UM + 1.2 x 11 .74 (O 2 + 3.76 x N 2 ) = 793 .23 kJ I kg 



Intelligent Energy Management in Hybrid Electric Vehicles 



159 



Description 


Type 


Symbol 


Value 


Combustion 








Enthalpy of formation 


E-F 


IT, 


Thermodynamic tables 


Sensible formation 


E-F 


A h 


Thermodynamic tables 


Combustion energy 


E-F 


" combustion 


38017 u/ 
/kg 


Mass flow rate of fuel 
combustion 


V-O 


rri/uei 


kg / 
/ s 


Temperature of fuel 


V-S 


T 

1 fuel 


27 °C 


Temperature of air 


v-s 


T . 

air 


27 °C 


Temperature of exhaust 


V-S 


T 

exhaust 


450 °C 


Engine compression ratio 


E-F 


T c 


8.6 


Air compression ratio 


E-F 


7 


1.35 


Ratio of nitrogen per oxygen 


E-F 


r N2/02 


3.76 


Excess air 


V-O 


E excessair 


20% 


Road 








Road friction 


E-F 


F 

friction 


C romng mgcos^ 


Road friction coefficient 


E-F 


c 

^rolling 


0.01 


Gravity acceleration 


E-F 


g 


9.8 m/s 2 


Vehicle velocity 


V-O 


v, 


16.6 m/s 


Vehicle angle 


V-O 


0, 


0° 


Drag 








Drag friction 


E-F 


F 

drag 


C drag (O)x—pV 2 A(0) 


Wind angle of attack 


E-F 


2 


Random direction (0-360°) 


Wind velocity 


E-F 


v 2 


0-6 m/s 


Result wind and vehicle angle 


V-O 


e 


Calculate in simulation IEMS 


Result of wind and vehicle speed 


V-O 


v t 


Calculate in simulation IEMS 


Result of wind and vehicle speed 


V-O 


r,-i 


Calculate in simulation IEMS 


Drag coefficient (By simulation ) 


V-S 


C dmg (&) 


-(0.00005 )x(<9)+ 0.0097 x(#)+0.31 


Front surface area 


V-S 


A(ff) 


1.8xl/cos(#) 


Vehicle + passenger mass 


V-O 


m 


1280 kg 


Air density 


E-F 


P 


1.225 kg/ m3 


Slope 








Slope friction 


R-O 


*~ slope 


mg sin O 


Road slope angle 


R-O 


o 


-1%< atan(0) < +0.6% 


Radius of Comfort requirement 


R-O 


R 


100 m 


Accessory 








Accessory 


V-O 


P 

1 accessory 


0-4250 watt 



V-S vehicle specification; V-O vehicle operation; E-F environment factors; 
R-O road condition. 
Table 2. Parameters involved in energy balance equation 



160 Energy Management 

and 

£ n e [h f + Ah]e = 8C0 2 [h f + A h ]C0 2 +lASH 2 0[h f +A h ]H 2 + 11.74x (0.2)O 2 [A h ]0 2 + 

11.74 x 3.76 x 1.2 xN 2 [A k ]N 2 =37219 .70 kJ I kg 



and W cv =0 



q ^suon = 1 "37219 .70 + 793 .23 |= 38017 .93 U I kg (8) 



Substituting the terms stated in Table 2, the mass flow rate fuel consumption of the vehicle 
can be calculated as follows : 

P _lP _lP _lP _lP / Q x 

road— friction drag slope accessory driving \s) 

m fuel - z : 

vd combustion lotto I f ue i_ air 'mechanical I heat loss 

The total fuel consumption in this process is: 

T 

m fuel = I™ fuel X dt (10) 



1 o 9 

p =[F + f + f +f ]xV t + [1/2 x m x (V t \ - V t )] 

«e? L friction drag slope accessory J f A^ Vf-1 ' t Jl 

where t is the total numbers of steps involved in the simulation. 

The symbols given in these equations are described in Table 2. The acceleration of the 
vehicle in At time can be calculated as: 



V t - V t _, dV 



At dt 



(ii) 



Also, the distance traversed by vehicle in A£ is: 



1 7 

X t = — x a t x At + V t _ 1 x At r\2) 

3.4.2 Parallel Hybrid Electric Vehicle Specification 

The ISG is mounted on the crankshaft of the ICE and therefore, it is also coupled to the drive 
train of the vehicle. Since the ISG model uses power based signals, it is not possible to 
observe speed-dependent characteristics. The ISG operates similar to the electric machine. It 
can operate in two modes: generator mode (Phev >= ) and motor mode ( Phev<0). 
The electric power net connects the ISG with the electric loads and the battery. No losses are 
assumed in the electrical wires, leaving the following description: 

P c = P em+P b (13) 

Where: Pem is electric machine power, Pb battery power, and Pc electric loads. 

The battery model consists of two subsystems: a static efficiency block and a dynamic 
energy storage block, see Fig. 7. The battery model is used where the losses grow 
proportionally with the power during charging (Pb > 0) and discharging (Pb < 0). 



Intelligent Energy Management in Hybrid Electric Vehicles 



161 



The efficiency block incorporates the energy losses during charging and discharging, 
whereas the energy storage block keeps track of the actual energy level E s in the battery. At 
this point an integrator is used: 



E s {t e ) = E s {Q)+[P s {t)dt , P b =max( fj~P a9 \p g ) 

u r/ 



(14) 



Fig. 7. Battery Model 

To indicate the actual charging level of the battery, the State of Charge (SOC) is often used. 
However, the physical background of SOC has a strong relation with battery models based 
on current and voltage. Because the proposed battery model is power based, the State of 
Energy (SOE) is more appropriate. The SOE expresses the relative energy status as follows: 



SOE 



-xlOO % 



(15) 



Depending on the control strategy from the EM system, three different representations of 
the internal battery losses are taken into account, which approximate the relation between 
the power Pb at the battery terminals and the net internal power P s . Table 3 provides the 
specifications of the battery and EM. The battery efficiency is considered as: 



2547600 



'2881008 



88 % 



(16) 



Feature 


Symbo 
1 


Type 


Battery (NHW11) 






Cells per module 




6 


Total Volts 


Vmax 


273.6 


Capacity (Amp hours) 




6.5 


Capacity (Watt hours) 




1778.4 


Electric Motor 






Operating Voltage (V) 


Vmin 


273 


Power (W) 




33000-44000 



Table 3. Parameters involved in energy balance equation 



3.4.3 Control strategy and optimal torque 

The control strategy involves calculation of the torque produced by ICE based on various 
parameters such as road load and battery SOC. This includes the calculation of an optimal 
torque based on contending ICE parameters, and deciding the actual torque output by later 
modifying the optimal torque based on road load and battery SOC. The optimal torque map 
is shown in Fig. 8. 



162 



Energy Management 



Fig. 8. Optimal torque map 



Max torque 




ICE Speed 



At the same current speed, if the required torque is above the optimal torque (Area 1), the 
ICE torque should be decreased bringing it near the optimal torque point. It means that EM 
should be run as a motor to make up for the remaining torque, provided there is enough 
battery charge. 

At the same current speed, if the required torque is below the optimal torque (Area 2), the ICE 
torque should be increased bringing it near to the optimal torque point. This is possible only if 
SOC is not high. We can run the EM as a generator, while running the ICE at its optimum. 
In order to modeling, the following specification of engine and Motor/ Inverter will be 
considered. Figs 9 and 10 show that the fuel converter efficiency operation and as well 
Motor/ Inverter Efficiency. 




Tourqe(N/m) 



Speed(RPM) 



Fig. 9. Fuel Converter Operation Honda Insight 1.01 VTEC-E SI from ANL Test Data . 




J 



Motor Torque(Nm) 



Motor Speed(RPM) 



Fig. 10. Motor/ Inverter Efficiency and Condition Torque Capability (Preliminary Model of 
Honda lOkw). 



Intelligent Energy Management in Hybrid Electric Vehicles 163 

3.4.4 On-line adaptive strategy 

The general control strategy for a parallel HEV can be summarized as follows (Shi et al,.2006): 
i. When the speed of the vehicle is small, ICE stops and electric motor gives the 

driving power required which avoids higher fuel consumption and reduce 

emission (It is assumed that SOC is sufficient), 
ii. When the speed of the vehicle is high enough, electric motor stops, ICE starts and 

gives the driving power required. Currently, ICE works along optimum curve 

depending on the cost function, 
iii. If the power required is larger than what ICE can give, ICE and electric motor work 

together and electric motor takes additional required power from the battery (It is 

assumed that SOC is sufficient), 
iv. If SOC of the battery drops under the safe level, ICE supplies both the energy 

required for travelling and extra power to charge the battery through electric motor 

(electric motor is at generator mode), 
v. In brake state, energy floats from vehicle body to drivetrain. Electric motor works 

as a generator and transforms braking energy to electricity to charge the battery. 

4. Intelligent System Methods in Energy Management 

Intelligent energy management methods can observe and learn driver behavior, 
environmental and vehicle conditions, and intelligently control the operation of the hybrid 
vehicle. This section describes intelligent system approaches with applications to design 
optimization, modeling, and control of complex systems and processes. 

4.1 Introduction of Complex and Uncertain System 

A Complex System is (Simon. H,1973) "A system that can be analyzed into many 
components having relatively many relations among them, so that the behaviour of each 
component depends on the behaviour of others". 

In the real world, we can find many problems and systems that are too complex or uncertain 
to be represented in complete and accurate mathematical models. And yet, we still have the 
need to design, optimize, or control the behaviour of such systems. Complex system can be 
solved by artificial intelligent systems. 

Advances in intelligent systems have brought new opportunities and challenges for 
researchers to deal with complex and uncertain problems and systems, which could not be 
solved by traditional methods. Methods developed for mathematically well-defined 
problems with precise models may lack in autonomy and thus cannot give adequate 
solutions under uncertain environments (Shin &Xu, 2009). Intelligent systems are defined 
with high degree of autonomy, reasoning with uncertainty, higher performance, high level 
of abstraction, data fusion, learning and adaptation (Shoureshi & Wormley,1990). 

4.2 Soft Computing Techniques 

Various soft computing based techniques have emerged as useful tools for solving 
engineering problems that were not possible or convenient to handle by traditional 
methods. The soft computing techniques give computationally efficient modelling, analysis, 
and decision making. The techniques that belong to the soft computing include artificial 
neural networks (ANNs), Fuzzy sets and systems, and evolutionary computation. 



164 



Energy Management 



4.2.1 Artificial neural networks (ANNs) 

ANNs are collections of small individually interconnected processing units. Information is 
passed between these units along interconnections. An incoming connection has two values 
associated with it, an input value and a weight. The output of the unit is a function of the 
summed value. ANNs while implemented on computers are not programmed to perform 
specific tasks. Instead, they are trained with respect to data sets until they learn patterns 
used as inputs. Once they are trained, new patterns may be presented to them for prediction 
or classification. ANNs can automatically learn to recognize patterns in data from real 
systems or from physical models, computer programs, or other sources. They can handle 
many inputs and produce answers that are in a form suitable for designers. 

4.2.2 Genetic Algorithms (GA) 

GA is based on the way living organisms adapt to life by evolution and inheritance. GA 
imitates the process of evolution of population by selecting fit individuals for reproduction. 
Thus, GA is an optimum search technique based on the concepts of natural selection and 
survival of the fittest. It works with a fixed-size population of possible solutions of a 
problem, called individuals, which are evolving in time. A genetic algorithm utilizes three 
principal genetic operators: selection, crossover, and mutation. 

4.2.3 Fuzzy Logic (FL) 

FL is used in control engineering. It is based on reasoning which employs linguistic rules in 
the form of IF-THEN statements. FL provides a simplification of a control methodology 
description. This allows the human language to be used to describe the problem and its 
solutions. In many control applications, the model of the system is unknown or the input 
parameters are variable and unstable. In such cases, fuzzy controllers can be applied. These 
are more robust and cheaper than conventional PID controllers. It is also easier to 
understand and modify fuzzy controller rules, which not only use human operator's 
strategy but, are expressed in natural linguistic terms. 

4.2.4 Hybrid system (HS) 



Techniques 


Advantage 


Limitation 


Expert Systems also called 
Knowledge-Based Systems (KBS) 


-Cost reduction in achieving a 
complex task 


-The lack of expertise 


Artificial Neural Networks 

(ANNs) 


-Most of the problems are now 
able to be solved 
-Representing I/O relationships 
for nonlinear systems. 


-Is only a special mathematical 
technique 


Fuzzy logic (FL) 


-Applied successfully in large 
number of uncertain applications 


-Input/ output controls of 
process are complicated 


Genetic Algorithms (GAs) 


-Optimisation 


-Successful for some 
applications 


Hybrid System 

(ANNs & FLS), (FLS & ANNs), 

(GAs & FLS) and (GAs & ANNs) 


-Combination technique is 
capable to solve all problems 
of engineering discipline 


-No 



Table 4. Intelligent system methods. 



Intelligent Energy Management in Hybrid Electric Vehicles 165 

HS combines multiple soft computing methods. For example, neuro-fuzzy controllers use neural 
networks and fuzzy logic, whereas in a different hybrid system a neural network may be used to 
derive some parameters and a genetic algorithm may be used subsequently to find an optimum 
solution to a problem. Table 4 presents a comparison of features of soft computing methods. 

5. Proposed Intelligent Energy Management System 

This work employs the analysis and simulation approach to develop an Intelligent Energy 
Management System (IEMS) for a HEV. The overview of IEMS is shown in Figl2. IEMS 
calculates the energy distribution and power flows in the powertrain of the vehicle and 
related losses. It indicates the ways to minimises the vehicles' fuel consumption under 
various driving conditions. IEMS learns when it is run, and makes proper adjustments to the 
way it operates to ensure that fuel consumption optimisation is achieved. 
The developed model includes the following components: 

5.1 Look-Ahead Environment Model Unit (LEM): 

This unit employs an imaging sensor and a vision algorithm to calculate the slope angle of 
the road ahead within the distance of 300 meters away from the vehicle, and forward this 
information to IEMS. 



5.2 Current Environment Model Unit (CEM): 

This unit employs the following data from environment situation. 

i. Current Road Slope Module (CRSM): This module specifies the actual slope angle of 

the road at the current location of the vehicle, 
ii. Road Friction Module (RFM): This module gives road friction coefficient, gravity 

acceleration, and motion angle, 
iii. Wind Drag Module (WDM): This module provides the following wind parameters: 

wind speed, wind direction, and drag coefficient. 

5.3 Friction Management Unit (FMU): 

This module obtains CEM data and also the following data to calculate and send them to IEMS. 
i. Combustion Module (CM): This module employs the combustion process from the 

vehicle as described in Equation (6-8), and calculates and returns the amount of 

combustion energy needed, 
ii. Accessory Module (AM): This module represents the accessories embedded within 

the vehicle such as electrical devices and air conditioning, 
iii. Vehicle Efficiencies Module (VEM): This module defines the values of the otto cycle, 

real fuel air engine, mechanical and heat loss efficiencies. 

5.4 Battery State of Charge (SOC): 

This module provides the amount of current, temperature and voltage of the battery 
continuously. Figure 11 displays only that the useable area of charge on the hybrid battery, 
displayed "empty" is about 40% and displayed "full" is about 85%. 



166 



Energy Management 



SOC % 



fc Pi l > ■ 1 1 ■ It?! 1 1 i i n If ?■ 1 1 1 1 n ltPi i i I ■ I ■ tf f 1 1 1 i ■ ■ ■ tfft ■ 1 1 1 ■ i tf Fi ■ 1 1 ■ i i IfPi ■ 1 1 ■ I r ITPi 1 1 ■ 1 1 ■ I ??■ 



Notice the overlap or hysteresis of 
each bar to the next; this is 

very similar to the voltage 
overlap or hysteresis 
we measure as we 
monitor the bar 
movement up 
and down 

the Batt 

Icon 




Notice Bars 6 & 7 have larger SOC 
ranges than the rest of the bars 



Graph Design Kevm Bracey 
Data AttilaVass 



Data .-(tries with temperature 



Fig. 11. The useable area of charge and discharge on the hybrid battery. 

5.5 Control Strategy 

In this work, the on-line adaptive strategy which was discussed in section 3.4.4, has been 
considered. 



5.6 IEMS Algorithm 

The overview of the simulation algorithm for IEMS is displayed in Fig. 13. The simulation 
starts with initialising several variables including normal power and primal kinetic energy 
for a moving vehicle. The data includes arrays of 7200 elements (steps). One iteration occurs 
in each step representing the time interval of 0.05 sec. Then the slope prediction data is 
retrieved from LEM. If the predicted slope angle is different from the current slope angle, 
STI block increases or decreases the power. Next, the vehicle/ environment/ friction data is 
retrieved from FMU. If the current total friction energy is different from the energy 
associated with the slope prediction, FTI block is triggered calculating the amount of power 
for all frictions. Otherwise, fuzzy logic controller (FLC) block is entered. FLC controls and 
optimises the fuel consumption with respect to the vehicle/ efficiencies, speed, acceleration, 
and gear data. Also the FLC intelligently consider with drive strategy (see section 5.7) and 
control strategy. If the comparison is satisfied then these data will be forwarded to the next 
block where they overwrite the results of the previous iteration. Otherwise, the power of 
engine and inverter operation is corrected by decreasing or increasing. Once either of speed 
or acceleration is found to be greater than the desired limit, and then FLC will control the 
engine power and inverter operation by its algorithm. When either of speed or acceleration 
becomes smaller than the desired control strategy limit, the engine power is increased with 
regard to control strategy. In the assignment block, the old data is overwritten with the new 
data. The Inverter algorithm, shown in Fig. 14, synchronises the battery with EM, Gen. With 
regard to the battery SOC and IEMS Interpreter Load (IIL), inverter starts charging or 
discharging the battery in each time. It then informs the IEMS about its result via SOC. If 
SOC is high, and at times of high load, the generator can be switched off and EM can 
provide mechanical power via the battery by the inverter's instruction. The parameters of 
the FLC controller are optimized by genetic algorithm optimizer (GAO). 



Intelligent Energy Management in Hybrid Electric Vehicles 



167 




Fig. 12. Overview of the IEMS model. 




Fig. 13. Overview of the IEMS algorithm. 



168 



Energy Management 



Rtl.K BASK Oil III 



Set Vmax.tcharge 
And Idesired 



/Inverterx 
\Control/ 



IP 

argej 



And tdischarge 



Set Counter 
(to) 



Read current 



Current 

TO IEMS via 

SOC 



/ Output Voltage 
( TO IEMS via 
\ BSOC 



Read Voltage 



V<Vmaxo, 

\ T<tc? 




Set Counter 
(td) 



li 



Makeup current 
difference with 
Electric Motor 



~x 



A* l>lmax c 
V>Vmin o 
\ t>td? 



Inform IEMS 
via SOC 



Inform IEMS \ 
via SOC W 



Fig. 14. Overview of the inverter algorithm. 

5.7 Engine and EM/Gen Specification and Drive Strategy 

In this work, we have considered a vehicle with the engine and specification as given in Table 5. 



Parameters 


Min 


Max 


Average 


Engine size (litre) 


— 


1.1 






Engine RMP (Rev/min) 


3000 


4000 


3500 


Engine power (kW) 


9.8 


10.5 


10 


Engine Torque (N/m) 


25 


29 


27 


EM/Gen RPM 
(Rev/min) 


3000 


4000 


3500 


EM/Gen Torque(N/m) 


8 


12 


10 



Table 5. Engine and EM/Gen specification. 

We have also formulated a set of parameters called " Drive Strategy" as shown in Table 6. 



Table 6. Drive strategy parameters. 



Parameters 


Min 


Max 


Average 


Engine size (litre) 


— 


1.2 






Speed (m/s) 


16.38 


16.94 


16.66 


Acceleration (m/s 2 ) 


-0.98 


0.98 


0.5 


Travel Time 




7200 


0.05(s) 


Travel Distance (m) 




6000 





Intelligent Energy Management in Hybrid Electric Vehicles 



169 



6. Simulation and optimization of hybrid vehicle 
6.1 Simulation 

6.1.1 Simulation 1 

Khayyam et al (Khayyam et al, 2009b) demonstrated a Air Condition system simulation that, 
the vehicle was tested under sunny condition first for 1200 step for the vehicle speed around 
20 m/s. Next, the fan and the air conditioning are turned on. The parameters given in Tables 
7-9 were employed to achieve the comfort temperature in the cabin room for 6000 step. The 
air condition energy consumption shown in Fig 15(d). 



Parameters 


Min 


Max 


Normal 


C.O.P 


1.45 


1.71 


1.38 


CAP (KW) 


3.8 


8.15 


7.9 


RMP( r ev/min ) 


3000 


4000 


3500 


Evaporator (KW) 


5.51 


13.93 


10.90 


Temperature (C) 
Gas R-134 




Sub Cool 


10 
superheat 




Pressure (kPa) 
Gas R-134 


310 
Charge 


2415 
Discharge 





Table 7. Compressor specifications. 



Parameters 


Min 


Max 


Average 


Volts 


12.5 


12.6 


12.5 


Amp 


20 


25 


24 


RMP ( rev 1 min ) 


1000 


1800 


1200 


Engine power (W) 


250 


315 


300 



Table 8. Blower specifications. 



Parameters 


Min 


Max 


Average 


Temperature (C) 


20 


25.6 


21.5 


Humidity (%) 


40 


60 


50 


Air speed (m/s) 


1 


5 


2.5 



Table 9. Comfort cabin room specifications. 

As discussed in section 3.2, some data has been created by PMH technique. The data created 
is associated with a slopped-windy-sunny condition. HEV was tested on this data, where 
the hybrid electric components were included. The road was set to be slopped with various 
slope angles within the range - 1% < atan(0) < +0.6%. Moreover, the environmental wind 
was assumed to be non-zero. The wind angle of attack, 62, was varied within the range to 
360°. Considering the wind velocity, however, different conditions were implemented: V2=0 
to 6. The Current Environment Model (CEM) component monitored the current slope. The 
following parameters were also considered: road-friction, combustion, and air conditioning 
accessory (Tablel). Fig. 15 illustrates the slope angle, wind-speed, wind direction as well as 
A/C energy consumption data used in the simulation. 



170 



Energy Management 



0.4 
0.2 

|-o, 

m -° A 

-0.6 
-0.8 


I /~N J J J J J J 


- - - -r-JV r f\'f\ - f \ - -Psj TV \-^^< - r - H^si" ' ' /K 


:::: : :: ¥ \^\ :: \h ::: ^ :::1:::t:^: i:::^: 


: : : :a/^--- 



? c 






Step 

(a) 



L J_ 1 _L J J 


i 1 1 1 1 1 L 








r r 

L J_ 


T T ^ 
1 _L J 


J 


L 1 I I 1 I 

[ 1 I I I I 




r 

L 














r r 

L L 


T T ~1 
1 _L J 


n 
J 




L 1 I I 1 I 

[11111 




r 






















• i 




r r 


T T "7 


n 






■ T — i-J— (-— r — r 







3500 

Step 



(b) 





i 
















11111 










r 


_ r r r r r 




— r 


r r 




r r 


T 


i 


riii 










i 










i 








































! 


















1 












! 





500 1000 1500 2000 2500 3000 3500 4000 4500 5000 5500 6000 6500 7000720( 



Step 



(c) 




500 1000 1500 2000 2500 3000 3500 4000 4500 5000 5500 6000 6500 7000 

Step 

(d) 
Fig. 15. (a) Slope (Road) angle data, (b) wind-speed data ,(c) wind-direction and (d) A/C 
energy consumption. 



6.1.2 Simulation 2 

IEMS-HEV was tested on a set of data associated with a slopped prediction (look-ahead 
within a 300 meter distance) -windy-warmed employing the hybrid electric components. The 
management of the battery, EM, and Gen is conducted by the inverter algorithm. This 
enables ICE and EM to output power simultaneously when the load is greater than 10 kW or 
a slope of greater than 0.1% is climbed by the vehicle. The following parameters were also 



Intelligent Energy Management in Hybrid Electric Vehicles 



171 



considered: road-friction, combustion, and air conditioning accessory. The predicted slope 
angle data is similar to the actual slope angle data. 

6.2 Discussions 

6.2.1 Simulation 1 Results 

The power and fuel consumption results for the first simulation are shown in Fig. 16. 
Initially. 7800 W of energy is given to the vehicle so that the initial speed of 16.6 m/s is 
achieved. The energy consumption remained constant at 7800 W where the condition was 
flat- windless (e.g. steps 0-600). Depending on the condition of the road slope angle, the 
wind speed, angle of attack, and accessory energy consumption, the power consumption 
varied as shown in Fig. 16. The HEV was informed about the current slope by CEM. 
Fig. 16 shows that the air conditioning system and slope friction have a significant impact on 
the fuel consumption. The reason is that it requires more fuel in a transit time. HEV can 
measure how much energy is needed in each step, and works out a desired fuel rate for the 
engine so that the power brake would not be needed. Using Equation (10), the average fuel 
consumption for Simulation 1 was found to be around 6.65 liter/ 100 km. 



Ill : i : 














- ii /, iiiiii.,. - , - - - 












Power Consumption 

Fuel Consumption 




"-r- -pA ---,-- -f - - T - - T - - r - - r --,---,---,- - 












ii i i i i i i i i i i i ii 



4500 5000 5500 6000 6500 7000 7500 



Step 



Fig. 16. Power and fuel consumption results for Simulation 1. 



6.2.2 Simulation 2 Results 

The power and fuel consumption results for the second simulation are shown in Fig. 17. 
Similarly, 7800 W of energy is initially given to the vehicle so that the initial speed of 16.6 
m/s is achieved. Also, the Look- Ahead informed IEMS about any slope ahead. IEMS 
calculates and FLC investigates, and if the load is found to be greater than 10 kW or the 
slope greater than 0.1%, the propulsion balance requests ILL to switch on EM through 
inverter. The outcome of this simulation shows that the vehicle speed and acceleration are 
smoother than those of Simulation 1. Using Equation (10), the average fuel consumption for 
Simulation 2 was found to be around 6.11 liter/ 100 km. Fig. 18 shows the SOC of battery 
during the travel. It goes up to 85% and then comes down to the same level when used. 



172 



Energy Management 



12000 


T I >\n r ^ I rT I I T ^ ! r 






ion 




! /\ ! ! ! ! ! ! ! 










Required Power 

EM/Gen Power 

ICE Power 




nsum|: 
att) 






2 §, 4000 








. \r\ i i i i i i i i i i i 


o 


— i-T^..:..:..^L.L.. :...:...:. ..:..:...:..... 


-2UU0 


i i i i i i i i i i i i 



Step 



Fig. 17. Power consumption results for Simulation 2. 



0.9 

0.8 

O 0.7 

o 

CD 0.6 

0.5 
0.4 


1 1 1 1 1 1 1 1 1 1 1 1 


| s 1— ^1 


y r ~^~^^-^\ 


-yr-\--\---\--\---\-- p^-i^-^-L- -:---!---;- 


/ \ 1 r ! \ ! [ ! [ ! ^^ — "i — -^_ 


i i i i i i i i i i i i 



Fig. 18. SOC of battery. 



Step 



7. Conclusions 

This chapter presented a description of intelligent energy management systems for hybrid 
electric vehicles. In addition, an intelligent energy management model for a parallel hybrid 
electric vehicle was described. The model takes into account the role of combined 
wind/ drag, slope, rolling, and accessories loads to minimize the fuel consumption under 
various driving conditions. Two simulation studies were conducted. They show that the 
vehicle speed and acceleration were smoother when the hybrid section was included. The 
average fuel consumption for Simulation 1 and 2 were found to be around 6.65 and 6.11 
liter/ 100 km, respectively. 



8. References 

A. Bandivadekar and J. Hey wood, (2007) "Factor of two : halving the fuel consumption of 

new U.S. automobiles by 2035," Report from Laboratoy for energy and the 

environment (MIT), vol. LFEE,. 
A. Piccolo, L. Ippolito, V. Galdi, and A. Vaccaro,(2001) "Optimization of energy flow 

management in hybird electric vehicles via genetic alorithms," Proc. IEEE/ASME 

Int. Conf. Italy, pp. 434-439,. 

A. Sciarretta, M. Back, and L. Guzzella, (2004) "Optimal Control of Parallel Hybrid Electric 

Vehicles," IEEE Trans, on Control Systems Technology, vol. 12,. 

B. M. Baumann, G. Washington, B. C. Glenn, and G. Rizzoni,(2005) "Mechatronic design and 

control of hybrid electric vehicles," IEEE/ASME Transactions on Mechatronics, vol. 
5, pp. 58-72, 2000. 

C. Musardo, G. Rizzoni, Y. Guezennec, B Staccia.(2005) // A-ECMS: An Adaptive Algorithm 

for Hybrid Electric Vehicle Energy Management"; European Journal of Control, 
Fundamental Issues in Control, Special Issue, Volume 11, Number 4-5. 



Intelligent Energy Management in Hybrid Electric Vehicles 173 

C. C. Lin, H. Peng, and J. W. Grizzle, (2003) "Power management strategy for a parallel 

hybrid electric truck," IEEE Trans, on Control Systems Technology, vol. 11, pp. 839- 

849,. 
C. C. Linl, H. Pengl, and J. W. Grizzle, (2004)" A Stochastic Control Strategy for Hybrid 

Electric Vehicles," Proceeding of the 2004 American Control Conference Boston, 

Massachusetts, vol. 4710-4715,. 
E. D. Tate and S. P. Boyd, (1998) "Finding ultimate limits of performance for hybrid electric 

vehicles," SAE, vol. 00FTT-50,. 
E. Hellstrom, M. Ivarsson, J. Aslund, and L. Nielsen, (2009) "Look-ahead control for heavy 

trucks to minimize trip time and fuel consumption," control Engineering Practice, 

vol. 17, pp. 245-254,. 
EPA, (2004) "Assessing the emission and fuel consumption impacts of intelligent 

transportation system(ITS)," EPA, vol. 231, pp. 98-007,. 
G. J. v. Wylen and R. E. Sonntag, (1990) "fundamentals of classical thermodynamics " vol. 

Third edition SI version. 
G. Shi, Y. Jing, A. Xu, and J. Ma, (2006) "Study and Simulation of Based-fuzzy-logic Parallel 

Hybrid Electric Vehicles Control Strategy," Proceedings of the Sixth International 

Conference on Intelligent Systems Design and Applications pp. 280-284,. 
H. Khayyam, A. Z. Kouzani, and E. J. Hu,(2008) "An intelligent energy management model 

for a parallel hybrid vehicle under combined loads," in IEEE International 

conference on vehicular electronics and safety Columbus, OH, USA 2008, pp. 145- 

150. 
H. Khayyam, A. Z. Kouzani, and E. J. Hu, (2009b) "Reducing energy consumption of vehicle 

air conditioning system by an energy management system," IEEE The 4th 

Internationnal Green Energy Conferance Beijing, China, vol. 1 
H. Khayyam, A. Z. Kouzani, H. Abdi, and S. Nahavandi, (2009a) "Modeling of highway heits 

for vehicle modeling and simulation " Proc. ASME/IEEE Int. Conf. MESA09 USA. 
J. B. Heywood, (1998) "Internal combustion engine fundamentals," McGraw-Hill, New York,. 
J. S. Won, (2003). "Intelligent energy management agent for a parallel hybrid vehicle," PhD 

Thesis 2003. 
J. T.B.A. Kessels, (2007) "Energy Management for Automotive Power Nets," PhD thesis 2007. 
L. L. Yaodong Wang, (2007) "An analytic study of applying Miller cycle to reduce Nox 

emission from petrol engine " Applied Thermal Engineering, vol. 27, pp. 1779-1789,. 
Lewis,Frank L. & Syrmos, Vassilis L. (1995) "Optimal Control" Hohn Wiley & Sons Inc. 

Newyork. 
M. Ehsani, Y. Gao, S. E. Gay, and A. Emadi, (2005) "Modern electric, hybrid electric, and fuel 

cell vehicles", New York CRC PRESS. 
M. Farrokhi and M. Mohebbi, (2005) "Optimal Fuzzy Control of Parallel Hybrid Electric 

Vehicles," ICCAS2005 June 2-5. 
M. Mohebbi and M. Farrokhi, (2007) "Adaptive neuro control of parallel hybrid electric 

vehicles," Int. J. Electric and Hybrid Vehicles, vol. 1,. 
M. Mohebbi, M. Charkhgard, and M. Farrokhi, (2005) "Optimal neuro-fuzzy control of 

parallel hybrid electric vehicles," Vehicle Power and Propulsion, 2005 IEEE 

Conference, pp. 26-30. 
M. Plint and A. Martyr,(1997) "Engine testing theory and practice," Butter worth-Heinemann 

British Library . 



174 Energy Management 

M. Salman, F. Change, and J. S. Chen, (2005) "Predictive energy management strategies for 

hybrid vehicles," IEEE Conf. Decision Control pp. 21-25,. 
M. Salman, N. J. Schouten, and N. A. Kheir, (2000) "Control strategies for parallel hybrid 

vehicles", American Control Conference, vol. 1, pp. 524-528. 
Manins ,P.C. (2000). "Environmental impact of the new Australian Hybrid Cars " Proceedings 

of the 15th International Clean Air and Environment Conference vol. 26-30, pp. 

117-122,. 
N. J. Schouten, M. A. Salman, and N. A. Kheir, (2002) "Fuzzy logic control for parallel hybrid 

vehicles," IEEE Transactions on Control Systems Technology, vol. 10, pp. 460-468, . 
O. Barbarisi, E. R. Westervelt, F. Vasca, and G. Rizzoni,(2005) "Power management 

decoupling control for a hybrid electric vehicle," IEEE Conf on Decision and 

Control, Spain, pp. 2012-2017. 
P. C. Cacciabue, (2007) "Modelling driver behaviour in automotive environments ": Springer 

2007. 
P. Pisu, G. Rizzoni, (2007) "A Comparative Study of Supervisory Control Strategies For 

Hybrid Electric Vehicles" IEEE Transactions on Control Systems Technology, 

Special Issue on Control Applications in Automotive Engineering, 
Q. R. Riley, (1994) "Alternative cars in the 21 century a new personal transportaion 

paradigm," SAE International, vol. 1994,. 
R. Langari and J.-s. W. Won, (2005) "Intelligent Energy Management Agent for a Parallel 

Hybrid Vehicle-Part 1 : Systsem Architecture and Design of the Driving Situation 

Identification Process," IEEE Trasactions on Vehicular Technology vol. 54, pp. 925- 

934,. 
R. Shoureshi and D. Wormley,(1990) "Intelligent control systems," Final report of 

NSF/EPRI,. 
R. Zhang and Y. Chen, (2001) "Control of hybrid dynamical systems for electric 

vehicles, "American Control Conference, vol. 4, pp. 2884-2889, 
S. Barsali, C. Miulli, and A. Possenti, (2004) "A control strategy to minimize fuel 

consumption of series hybrid electric vehicles," IEEE Transaction on Energy 

Conversion, vol. 19, pp. 187-195, 
S. Delprat, J. Lauber, T. M. Guerra, and J. Rimaux,(2004) "Control of a Parallel Hybrid 

Powertrain: Optimal Control," IEEE Transaction on vehicular technology, vol. 53, 

pp. 872-881,. 
S. E. Lyshevski, (1999) "Diesel-Electric Drivetrains for Hybrid-Electric Vehicles: New 

Challenging Problems in Multivariate Analysis and Control," Proceedings of the 

1999 IEEE International Conference on Control Applications vol. 1, pp. 840-845,. 
S. M. T. Bathaee, A. H. Gastaj, S. R. Emami, and M. Mohammadian,(2005) "A fuzzy-based 

supervisory robust control for parallel hybrid electric vehicles," Vehicle Power and 

Propulsion, 2005 IEEE Conference, pp. 694-700,. 
Simon, Herbert A., (1973) "The Organization of Complex Systems," in Hierarchy Theory, ed. 

by Howard H. Pattee, New York: George Braziller, 
SOE,(2006) "Independent report to the Australian Government Minister for the Environment 

and Heritage " <http://www.environment.gov.au/soe/2006/publications/report/ 

index.html>, 2006. 
W. W. Pullkrabek, (1997) "Engineering fundamentals of the internal combustion engine " 

Prentice Hall. 



Intelligent Energy Management in Hybrid Electric Vehicles 175 

X. Wei, L. Guzzella*, V. I. Utkin and G. Rizzoni, (2007) "Model-based Fuel Optimal Control 

of Hybrid Electric Vehicle Using Variable Structure Control Systems", ASME 

Transactions. Journal of Dynamic Systems, Measurement, and Control - Volume 

129, Issue 1, pp. 13-19. 
Y. C. Shin and C. Xu,(2009)" Intelligent Systems modeling, optimization, and control" Boca 

Raton : CRC Press,. 
Y. Lin, P. Tang, W. J. Zhang, and Q. Yu, (2005) "Artificial neural network modelling of driver 

handling behaviour in a driver- vehicle-environment system," International Journal 

of Vehicle Design, vol. 37, pp. 24-45,. 
Y. Wang, L. Lin, and A. roskily(2007). "An analytic study of applying Miller cycle to reduce 

Nox emission from petrol engine " Applied Thermal Engineering, vol. 27, pp. 1779- 

1789 
Y. Zhu, Y. Chen, and Q. Chen, (2002) "Analysis and Design of an Optimal Energy 

Management and Control System for Hybrid Electric Vehicles," Proc. of the 19th 

Electric Vehicles Symposium, Busan, Korea,. 



176 Energy Management 



Optimal Management of Power Systems 



Luca Andreassi 

University of Rome "Tor Vergata" 

Italy 
Stef ano Ubertini 

University of Naples "Varthenope" 

Italy 



1. Introduction 



The increasing energy demand along with the growing concern for environmental issues 
make energy saving one of the main tasks of present times and it is likely to become even 
more important in the next decades, as the economic growth is being pursued in developing 
countries, as China, India and Brazil. 

As a consequence, researchers, industries and politicians are required to make significant 
efforts in this field. More and more stringent regulations on pollution and CO2 emissions 
have been issued, which means limiting energy consumption. However, even if policy is an 
important tool, it cannot be the only one and it is necessary to spread the knowledge on 
energy systems, energy saving options and energy use rationalisation (Lopes et al., 2005). 
This is a prerequisite to make right choices for a more efficient use of energy, even if these 
choices are not mandatory from a "legal" point of view. 

Being obvious that this knowledge should be transferred to all the population layers, it is 
important that the main energy users, as industry, realize that energy is not merely an 
overhead, as part of business maintenance, but actually a raw material resource required to 
run the business. Energy management programs should, therefore, become an integral part 
of the corporate strategy, to increase the business' profitability and competitiveness. 
Moreover, knocking down energy costs most of the times means reducing demand on the 
world's finite energy sources, cutting pollution and creating a healthier working 
environment. 

The main example in this context is Japan, as the Japanese economy is the most energy 
efficient in the industrialized world and their improvements in energy efficiency enabled the 
Japanese industry to increase its output of 40% by spending the same energy in 2001 as in 
1973 (Van Schijndel., 2002; Kamal, 1997). In general, the application of good energy 
management practices and energy-efficient equipment allow a readily achievable, cost- 
effective, 20% reduction in industrial consumption (Smith et al., 2007) 

Energy saving can be realised through different actions on both the utilisation and the 
production sides (Agency for Natural Resources and Energy, 2004; Meier, 1997). However, it 
is really a complex task, as many factors influence energy usage, conversion and 
consumption and these factors are strictly connected to each other. For example, when 



178 Energy Management 

evaluating an action on energy consumption/ conversion, one should take care of the 
interactions, as one measure influences the saving effect of the other measures. Accordingly 
that the single contributions to energy saving cannot be simply summed up because of 
overlapping effects. On the other hand, the combined effect can be higher than the sum of 
the separate effects as well. Furthermore, it is worth of noting that energy saving represents 
energy that is not used and, therefore, it cannot be directly measured (except in some cases 
as, for example, straightforward energy conversion processes). 

Therefore, it is necessary to develop and apply new methodologies for total energy management 
in buildings and industrial plants (Cesarotti et al., 2007, Andreassi et al., 2009). 
In this scenario, the installation of energy systems (characterized by multiple energy 
supplies and energy conversion equipments to meet energy demands) in industrial plants 
has become increasingly popular in recent years (i.e. combined heat and power - CHP, 
renewable energy systems) and their proper management becomes crucial to reduce energy 
costs and environmental impact. 

Usually, in fact, the small power plants dedicated to buildings or power plants (nominal 
power ranging from some hundreds of kWs to 10 MW) are operated simply switching on 
and off the machines for long time intervals (i.e. night and day, winter and summer). 
However, the machines typically used in these systems have small thermal inertia, thus 
allowing quick load variation, and may be operated under partial load. 

In most cases operating decisions are made by a control room dispatcher on the basis of 
empirical data, machine efficiency calculations and/ or trial errors. Obviously, this approach 
cannot keep into proper account all the huge number of variables (and their interaction) 
affecting the energetic and economic results that may be achieved. In fact, these combined 
cooling, heating and power systems meet the electricity demand by running the generators 
and by purchasing electricity from an outside electric power company. The exhaust heat 
recovered from the thermal engines is reused to handle the heating load which is 
supplemented by boilers. Analogously, cooling load could be met by recovering heat to 
power absorption chiller system so providing all or a portion of the cooling load. Any other 
request of cooling load can be satisfied with an electric power compressor driven air 
conditioning system. Of course, the main objective is to achieve for each hour the most 
profitable operation strategy, maximizing the profitability, covering the energy demand and 
obtaining savings in terms of primary energy and emissions. It becomes obvious that in 
order to realize the greatest cost savings a proper optimization has to be performed. 
In scientific literature, several criteria for the optimization of combined cooling, heating and 
power systems in industrial plants are available based on different management hypotheses 
and objective functions. The goal of the models is to optimize the operation of the energy 
system to maximize the return on invested capital. Many of these models do account for 
load operations but use simple linear relationships to describe thermodynamic and heat 
transfer process that can be inherently non-linear. (Arivalgan et al., 2000) presented a mixed- 
integer linear programming model to optimize the operation of a paper mill. It was 
demonstrated that the model provides the methods for determining the optimal strategy 
that minimizes the overall cost of energy for the process industry. (Von Spakovsky et 
al.,1995) used a mixed integer linear programming approach which balances the competing 
costs of operation and minimizes these costs subject to the operational constraints placed on 
the system. Main issue of the presented model is that it is useful to predict the best operating 
strategy for any given day. Nevertheless, the model validity was strictly dependent on the 



Optimal Management of Power Systems 179 

linear behavior of the plant components. (Frangopoulos et aL, 1996) employed linear 
programming techniques to develop an optimization procedure of a power plant supported 
by a thermo-economic analysis of the system. (Puttgen & MacGregor, 1996) and (Valero & 
Lozano, 1993), illustrate a total revenue maximization performed through linear 
programming subject to constraints due to conservation of mass, thermal storage restrictions 
and shiftable loads requirement. (Moslchi et aL, 1991) divided the energy system into an 
electric subsystem and a steam subsystem: in the first one steam turbines generate the 
electricity necessary to meet the power demand, while the second one consists of boilers 
which use fuel and water to produce steam for industrial processes. The two subsystems 
were solved separately with solutions coordinated to achieve optimality of the combined 
systems. Finally, thermo-economics offer the most comprehensive theoretical approach to 
energy systems analysis where costs are concerned. It is based on the assumption that 
exergy is the only rational basis to assign cost. In other terms, the main issue is that costs 
occur and are directly related to the irreversibility taking place within each component. 
Accordingly thermo-economics could represent a reliable approach to power plants 
operation optimisation involving thermodynamic and economical aspects (Tstsaronis & 
Winhold,1985; Temir & Bilge, 2004; Tstsaronis & Pisa, 1994). 

The purpose of this chapter is to highlight the importance of the optimal management of 
power plants in terms of environmental impact, fuel consumption and energy costs. This is 
done by presenting and applying a mathematical model to identify the optimal operating 
conditions of energy conversion equipments (i.e. boilers, air-conditioning systems and 
refrigerators, thermal engines) (Car dona & Piacentino, 2007; Doering & Lin, 1979; Kong et 
aL, 2009; Marik et aL, 2005; Kong et aL, 2005). In practice, substantial energy savings and/ or 
environmental benefits could be obtained without any action on the power plant 
components. 

2. Main philosophy 

The power plant serving an industrial or civil facility is a complex system made up of 
different components (i.e. primary movers, boilers, refrigerators etc.) that has to satisfy the 
energy requirements in terms of heat, electricity and cooling. The effectiveness of a power 
plant is measured through the overall efficiency, which is the ratio between the obtained 
usable energy (i.e. electrical and thermal energy, cooling energy) and the spent primary 
energy (i.e. fuel). The difference between spent and useful energy represents waste energy. 
The efficiency of a power system is a combination of the components efficiency, defined as 
the ratio between output and input energy. The maximisation of a power plant efficiency 
can be, therefore, performed mainly in two ways: 

substituting existing components with higher efficient ones; 

running components as much efficiently as possible. 
The first item is related to the existence of different ways to convert primary energy to 
useful energy and thus different machines and power systems in general, as reciprocating 
engines, gas turbines, fuel cells and so on up to renewable energy systems which, in 
principle, convert free available energy to useful one. 

The second one is indeed related to the dependence of energy converters efficiency on 
several parameters, and, therefore, on the instantaneous efficiency of each component of a 
power plant varies with time. As these efficiency variations may be significant and the 



180 Energy Management 

energy demand could be satisfied with several power plant operating configurations (i.e. 
heat from a boiler or a cogenerator), the optimal management of a power plant is as much 
important as the use of efficient component, with the certain advantage of requiring limited 
investments. 

Next we have to consider that the power produced by the energy system may be not 
entirely used in the structure that serves, as the electric power may be imported/ exported to 
a utility grid. This means that the electric network acts as an energy storage system that 
gives and absorbs energy at different costs, defined by the electricity rate. Therefore 
energetic and economic optimisation do not in general coincide and the concept of power 
plant optimal management needs to be extended to reducing costs and not (only) primary 
energy consumption (i.e. maximum efficiency). 

This complicates the analysis, as costs are not proportional to the energy content of a certain 
energy carrier (i.e. methane, gasoline, electricity etc.) and other factors need to be assessed 
and optimised, as the contract with the electric company. On the other hand, this makes an 
optimal management strategy much more attractive, as costs can be reduced (or profits can 
be increased) up to 10% passing from standard to optimal management. 

The meaning of optimal management of a power plant is setting the power plant 
components operating conditions in order to satisfy the energy demand while minimising or 
maximising a certain objective function (i.e. energy costs/ profit, pollutant emissions, fuel 
consumption, carbon dioxide emissions etc.). This can be done at different detail levels. In 
the following a simple but sufficiently accurate methodology is proposed. 

Before giving the details of the proposed methodology, it is important to highlight that this 
chapter discusses the opportunities given by running a power system efficiently, but it 
presupposes that a regular maintenance of the power plant components and the prompt 
repair of defects are performed. Maintenance is, in fact, one of the most cost-effective 
methods for avoiding energy waste, as energy losses from poorly maintained or antiquated 
systems are often considerable. In particular, modern power systems feature sophisticated 
components that require regular ongoing inspections, measurements and repair for peak 
operating efficiency. 

3. Mathematical model 

The system representation can be achieved through a mathematical model which emulates 

the energy/ mass balances existing between the power plant and the served facility. The 

model allows matching the industrial plant energy demands (electricity, hot water, cold, 

etc.) through an analysis of the system performance characteristics, taking into account the 

main subsystems integration issues, their operation requirements and their economic 

viability. 

In this chapter the following equipments are investigated: 

gas engines 

gas steam boilers 

hot water boilers 

mechanical chillers 

absorption chillers 



Optimal Management of Power Systems 181 

being understood that any other energy converter may be included in the proposed method. 
In particular, also renewable energy systems may be included in this analysis. In fact, it is 
true that in the case of wind or solar power generation, the main goal is to produce as much 
energy from the system as possible to recover the installation cost, but this electrical energy 
production affects the behavior of the whole energy system. For example, if a wind turbine 
is producing the electrical power needed by the industrial plant, it may be convenient to 
reduce the cogenerator load and increase the heat production in the boilers. 
As the present approach is devoted to optimal management of the power plant, which is to 
say those equipment operating conditions (i.e. set-points) that minimize a prescribed cost 
function, it is not necessary to go into the detail of the equipments behavior. Therefore, all 
the equipments in the power plant are considered as energy converters, characterized by 
inputs and outputs and modelled as black-boxes. The outputs depend on the component 
load or setpoint. It is worth of noting that, although the output could be more than one, as in 
the case of a gas engine cogenerator (electricity and hot water for example), each equipment 
is usually defined by only one input (fuel or electric energy). 

Conservation equations are considered to solve each subsystem with a quasi-steady 
approach (i.e. the variables are considered constant between two time steps). 
Before starting the description of the numerical model equations, it is essential to introduce 
the feature of the variables involved in the mathematical representation. 

3.1 Input and the output variables 

Input variables are subdivided into two main classes, as proposed in (van Schijndel, 2002): 
controllable and non-controllable variables. 

The non-controllable inputs are those related to the energy requirements (i.e. dependent on 
the industrial plant production plan or the building operation), as, at each time step, the 
power plant has to supply the "non controllable" energy demand. 

The energetic non-controllable inputs are: the cooling demand ( Q CD ), the low temperature 
heat demand ( Q HwD ), the high temperature heat demand (steam) ( Q SD ) and the electricity 
demand (P E j D )- 
The economic non-controllable inputs are the fuel cost ( C f ) and the electricity cost. 

Considering that electricity can be purchased by or sold to the public network, as the power 
plant electricity output may be higher or lower than the electric demand, the energy costs in 

sale (S E1 ) and in purchase (C E1 ) are considered. There are two important factors affecting 

the economic inputs that need to be assessed: 

as different electricity rates are available in the market, and the power plant 

operation affects the electricity demand from the net, the present methodology may 

be efficiently combined to a tariff analysis and contract renewal process; 

there may be other terms that affect the energy cost and price due to public 

incentives, as it happens for renewable energy and high efficiency cogeneration in 

Europe. 

The controllable inputs are the power plant component operating conditions, here uniquely 

determined by set points varying from (representing switching off) to 1 (representing 

maximum load). 



182 Energy Management 

The total cost (TC), the electricity cost and consumption ( E1C , P E1Bal ), the fuel cost and 

consumption (FC, lh Tf ) are the model outputs. The optimisation procedure is performed 
on one or a combination of the above outputs. 

3.2 The objective function 

Simulations are performed pursuing the goal of optimising the equipment operation, in 
order to satisfy specified criterion. Currently, the following three optimization criteria are 
the most common: 

minimum cost of operation 

minimum fuel consumption 

minimum pollutant emissions (CO, NO x ,SO x , Soot, CO2) 
For the last strategy different weights of the different pollutant emissions may be applied. In 
the present work, we have assumed that they are proportionally weighted with the Italian 
legislation maximum limits, as reported in section 3.8. 

3.3 Modeling the power plant components 

The mathematical representation of every subsystem is summarised in Table 1. Each 
equation is representative of the energy transformations taking place into the correspondent 
equipment between input and output. Efficiencies forming equations are set point 
dependent, according to the manufacturer specifications. In fact, the efficiency under 
nominal operating condition is always available and very often efficiency values at other 
loads are also known. It is important to keep in mind that efficiency can be limited by 
mechanical, chemical, or other physical parameters, or by the age and design of equipment. 
Therefore, deviations from producer efficiency may exist and should be taken into account. 
Then, the efficiency ( T| ) of each equipment could be represented by a polynomial function 

as it follows: 



n = Z 



a k E' m 



where E is the primary input energy and ak is the polynomial coefficient. 

Of course, the more are the known load/ efficiency points, the more accurate will be the 

efficiency profile. 

As an example, a cogenerator can be represented as a black-box where fuel is converted, 

through an efficiency function like (1), in electricity, thermal energy (both low and high 

temperature) and cooling energy, as shown in Figure 1. 

In this scenario, the primary energy power equation for the gas engine is 

P ge =m-H,-SP ge (2) 

This chemical power is subdivided in electrical and thermal power on the basis of the 
machine efficiencies (electric efficiency of the gas engine, thermal efficiency of the gas 
engine for steam production, thermal efficiency of the gas engine for hot water production, 
thermal efficiency of the gas engine for cold water production). The values of the presented 
efficiencies can be directly obtained by the engine manufacturer. 



Optimal Management of Power Systems 






183 














Equipment 


Chemical power 


Electrical power 


Hot water power 


Steam power 


Cold power 




Gas engine 


P ge =m.-H r SP gg 


Klge = P gS ■ Vsl 3S 


Qnv.-gg = P ge " *lBwge 


Qsge = P ge ' Wsge 


Qcge = P ge ' Vcgg 




Mechanical chiller 










Qcmc = P Elmc " VElmc 




Absorption chiller 










Qcac = Q-Hvi-geac ' Wcac 




Hot water boiler 






Qav.-b = ™fxv,-h ■ H t ■ nitwh 








Steam boiler 






Qsb = ™ f sb ■ H i ■ %a 







Table 1. Subsystems mathematical characterization 

The numerical results discussed in this chapter have been derived following this approach. 
Nevertheless, one of the main peculiarities of the presented numerical model is the 
flexibility. Accordingly, it is possible to easily represent the efficiency on the basis of specific 
driving parameters as, for example, external temperature, maintenance service level, etc. 
Following a similar scheme, the boilers heat production as hot water is evaluated as 



and, as steam as 



^<Hwb — m fHwb ' -""i ' ^Hwb 

Qsb= lil fSb H 1 r lsb 



(3) 
(4) 



Once again the boiler efficiencies can be schematized exclusively on the basis of the 
manufacturer data or this representation can be improved considering specific drivers. 
Finally, two chillers have been considered: mechanical and electric chillers. In both cases the 
chiller cold power production is defined on the basis of a chiller efficiency: 



Elmc I Elmc 



Fuel I S 




(5) 
(6) 

P Elge = mHflElg* 
I [> Qc S e = wHtfcge 



Fig. 1. Representative model of a trigenerator. 



184 Energy Management 

3.5 Electricity and thermal balances 

The energy model can be divided into two main submodels: the electricity balance and the 
thermal balance. 

Considering the overall power plant and keeping into account the previous sections, the 
electricity balance can be expressed as follows: 

P = P - P - P ( 6 ) 

1 ElBal L Elge x mc x E1D 

where P Elge is the gas engine electric power output, P mc and P E1D represent the electric 

power used by the mechanical chiller and the other electric needs of the facility, 

respectively. Of course, negative values of P E1Bal indicate a shortage of electricity. 

Once the electricity demand (or the electricity offer to the market) is defined, it is possible to 
determine the electricity cost, given by: 

ElC = s E1 -p(P EBal ) + c E1 -n(P E1Bal ) H 

where S E1 and C E1 represent the cost of electricity in sale and in purchase, respectively, and 

the function p(x) (n(x)) return the value of the argument x if positive (negative), zero 

otherwise. 

It is worth noting that the electrical efficiencies, which contribute to the definition of the 

terms in Equation (6), depend on the setpoint according to the manufacture specification. It 

is therefore clear, and it will be highlighted in the case study section, that a numerical 

procedure is requested as the main aim of the model is to define the optimal equipments 

setpoint in order to satisfy a specific request, which depends on the power outputs that, in 

turn, depend on the setpoint reliant efficiencies. 

Electric energy is univocally defined, whereas characterizing thermal energy needs one 

more specification. Operating temperature must be issued to define the available thermal 

energy potential. Hence, in principle, infinite thermal balances would be possible. 

Three balances have been distinguished in this paper: a hot water balance (T = 80°C), a 

steam balance (12 bars saturated steam) and a cooling balance (T = -5°C). 

To evaluate the supplied fuel to the hot water boiler, a hot water balance can be written as 

the difference between the cogenerator hot water heat power, Q Hwge , and the plant hot 
water power demand, Q HwD : 

^HwBal = ^Hwge ~~ XHwD 

A negative value of the balance (i.e. the hot water demand exceeds the cogenerative hot 
water), implies the hot water boiler usage. 

The switching of the absorption chiller depends on the thermal balance (8): if positive it is 
possible to turn on the absorption chiller, defining the following function: 



SW ac =p(sign(Q HwBal )) ( 9 ) 



Optimal Management of Power Systems 185 

The used heat from the CHP systems to the absorption chiller can be calculated as: 

^<Hwac = k^ac '\VHwBal ~~ Pv<HwBal ~~ ^?acmax // 

where Q acmax is the maximum thermal power required by the absorption chiller. The heat 
demand and the gas supply of hot water boilers are then given by the following equations: 

QHwb=-n(Q H wBal) (11) 

Q H „ (12) 



fHwb " 



%wb XH ; 



where p and H i are the density and the lower heating value of the fuel and Tf Hwb is the 

hot water boiler efficiency. Analogously, the heat balance, the demand and the gas supply of 
steam boilers are evaluated as follows: 

^<SBal = ^<Sge _ ^<SD 

Qs b =-n(QsB al ) (14) 

Q Sb (15) 



m fSb 



T lsb xH i 



where T| sb is the steam boiler efficiency. 

Finally, indicating with COp mc , SP mc and Q Cmc the coefficient of performance, the set 

point and the cold power production of the mechanical chiller respectively, the cold balance 
and the electricity absorbed by the mechanical chiller are calculated with the following 
relationships: 

QcBa.=Q Cm c+Qcac-QcD (16) 

6 ( 17 ) 

p _ VCmc 

cop mc -SP mc 



186 Energy Management 

3.7 Pollutant emissions 

The following pollutant emissions are considered: nitrogen oxides NO x carbon monoxide 
CO, sulphur oxides SO x , carbon dioxide, CO2 and particulate, Soot. 

Being the total mass flow rate used in the power plant given by the sum of the boilers (fh b f) 

and the gas engine ( III f ) fuel consumption, under the hypothesis that a complete 
oxidation occurs, the fuel mass balance reads as follows: 

m Tf =m bf +m gef ( 18 ) 

The SO x and CO2 mass flow rates are calculated as a percentage of the mass concentration of 
carbon, \C\ m , and sulphur, \S\ m , in the fuel supplied by the energy converters: 

44 r 1 . ( 19 ) 



= ~U 



m C0 2 =— 1 L i' m Tf 

64 r , . (20) 

m so x = — L S Jm-m Tf 

It is worth to note that the result of Equation (15) is only a first tentative value, as the CO2 

mass flow rate will be corrected after having evaluated the CO mass flow rate. 

The other pollutant emissions (NO x and CO) have been calculated on the basis of the 

equipment experimental emission data, usually given as a function of the load fraction. The 

pollutant emission mass flow rates for a boiler and gas engine are shown in Figures 2 and 3, 

respectively. 

Accordingly, from a general point of view, CO and NO x emissions are evaluated as a 

function of the equipment set point SP: 

A C0/N0 , - f (SP) ( 21 ) 



Optimal Management of Power Systems 



187 



700 



600- 



500- 



j§ 400 
£ 300 

X 

o 

fc 200 



100- 



- 1 1 1 1 1 1 1 1 1 1 1 1 1 1 r- 



•.-' • 



■ Methane 
Natural gas 

• Diesel 
- - - Fuel Oil 



-i — | — i — | — i — | — i — | — i — | — i — | — i — | — i — | — i — | — i — | — i — | — i — |— 
0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 



Thermal load (MW/m ) 

Fig. 2. NOx thermal load influence for the boilers. 
1000 



800 



&0 



O 

o 



600 



400 



200 







1 


1 


1 


1 


1 


- 
















MO 




X 

CO 


- 


























y 










1 


1 


1 


1 


1 







20 



40 



60 



80 



100 



Power (MW) 

Fig. 3. NOx and CO load influence for the internal combustion engine. 



188 



Energy Management 



It must be highlighted that part of the consumed electricity could be purchased from the 
public network. Therefore, to minimise the pollution of the power plant on a fair basis, the 
emissions deriving from the production of the electric energy drawn from the public 
network must be estimated and taken into account. For this reason, we have introduced a 

polluting factor pf m i x (expressed in kg/kWhe) depending on the mix of the different 
pollutant emissions (CO, NOx, Soot, SOx) of the national power plants connected to the 
network: 



pf mix = kWh e (0.021 • pf co + 0.418 ■ pf NOx +0.296- pf soot + 0.265 • pf SOx ) 



(22) 



The Italian polluting factors are reported in Table 2 (from ENEL s.p.a.). The coefficients 
multiplying each pf factor have been chosen on the basis of the current Italian environment 
limitations (Italian Ministry for the Environment, 2002). 



pfCO 


pfNOx 


pfC02 


pfSOx 


0.032 


0.6 


0.22 


0.9 



Table 2. 2004 italian pollutant emission factor (kg/kWh) 

A similar factor exists also for carbon dioxide (i.e. related to the average electrical efficiency 
of the national power plants connected to the network): 



The carbon dioxide polluting factor, pf co , has been set to 0.531 
s.p.a. data. 



VSNh. 



(23) 



according to ENEL 



3.8 Economic output 

The economical optimisation is performed maximising the total cost: 

TC = E1C-FC 

where E1C is the electricity cost and FC represents the total fuel cost: 



FC = c bf -m bf +c gef -m gef 



(24) 



(25) 



where C bf and C f represent the boiler and the engine fuel cost, respectively. It is 

important to note that, even if the boilers and the internal combustion engines are both fed 

by natural gas, the values of C bf and C f may be different (i.e. different taxes are applied if 

the same fuel is used for heat or electricity production). Actually, Current Italian Legislation 
yields a 0.25 m3/kWh of gas used in CHP defiscalisation (40 %) with respect to standard 
boilers (this is related to the incentive pay to improve final energy usage). 



Optimal Management of Power Systems 



189 



3.9 Time scale 

Even if any time step may be in principle applied to the developed numerical model, the 

minimum time-step is defined by the time interval between the specific data available by the 

user on the energy loads. 

The energy demand is the time integral calculation of the instantaneous power supplied by 

the power plant. It can be represented by a continuous function, as shown in Figure 4. 

In principle, to represent the energy utilisation curve we should need an infinite number of 

data. In practice, the available data (i.e. energy consumption and production data) in a plant 

are far from being instantaneous. Moreover, such a precise data could be even useless due to 

the method approximations and the related foresight uncertainty. 

Performing the optimisation of an energy system management requires a correct time step 

choice, which must be a right compromise among various effects. 

For example, a small time steps guarantee accuracy, but the resulting management criterion 

may be applicable with difficulty, as the equipment set point adjustment could be 

inconsistent with the equipment specifications, both in terms of availability of an automated 

control system or in terms of component thermal inertia (circles in Figure 4). Moreover, the 

effort required to frequently change the components set point may not be justified by the 

effective advantage in terms of energy/ money saving. It is worth noticing, in fact, that the 

convenience of turning on or off a thermal machine (i.e. internal combustion engine), 

depends on the price of electricity, and the time scale of electricity price variation are 

usually of the order of some hours (i.e. 4, 6, 12 hours). An example of electricity rate is given 

in the next section. 

In this paper, four different time steps have been used, a month, half a day, four hours and 

one hour in order to highlight the importance of the parameter "time step" in the energy 

system management. 

Yearly heat demand 



kW 



2100 



1800 



1500 



1200 



900 



600 



300 




Days 



Fig. 4. Yearly thermal demand. 



190 



Energy Management 



4. Case study 

A pharmaceutical industrial plant has been selected as the case study for the present 
optimization procedure. The power plant consists of: 

1 natural gas internal combustion engine 

1 steam boiler 

1 hot water boiler 

1 mechanical chiller 

2 absorption chillers 

The main characteristics of each component are summarized in Table 3. Energy flows and 
component interconnections are reported in Figure 5. 



EQUIPMENT 


Producer 


Output 


Efficiency 


Gas engine 


CAT 


2000 kWe 


0.37 


Compression 
chiller 


YORK 


4200 kW 


3.9 


Absorption 
chillers 


YAZAKI 


500 kW 


0.72 


Hot water boiler 


RIELLO 


2500 kW 


0.85 


Steam boiler 


RIELLO 


3200 kW 


0.84 



Table 3. Equipment specifications 





















► 


f ^ 
HOT WATER 

BOILER 




,„„„„„..„... *i«.. ...-.».-.„..„ ..\ 


► 


FACILITY 
HOT WATER 






": 




v. J 




i 








■ 




► 


STEAM 
BOILER 








FACILITY 

HEATING 






; 




^ J 




; 






i 

j 










; 




FACILITY 
STEAM 




* 


GAS 
ENGINE 


i 








1 ABSORPTION 
CHILLERS 








1 
















V 


t:z:t 


FACILITY 
COOLING 






/ FITBLIC \ | 

VI If-tf 'TRlf '1TY 


J MECHANICAL 
[ CHILLERS 










\ NETWORK 




v. J 


FACIUTY 
ELECTRICITY 




\_ 


























COOLING 
ELECTRICITY 


> ~ . _ HEAT 

PRIMARY ENERGY 



















Fig. 5. Power plant energy flows and cooling installation. 



Optimal Management of Power Systems 



191 



The installation is designed for producing domestic hot water and heating (2.5 MW), steam 
(3.2 MW), cooling (4.3 MW) and electricity (1.2 MW). 

The economical results and fuel usage registered in 2005, are used to validate the proposed 
model. In the standard operation of the power plant, the internal combustion engine is on at 
full power (set point equal to 1) during the day (7 am - 8 pm) and it is turned-off during the 
night (8 pm - 7 am). The switching on of the boilers is determined by the heat balance (i.e. 
heat demand minus the heat eventually available from the thermal engines). The chillers are 
turned on in function of the cold demand giving higher priority to the absorption chillers if 
there's heat available from the thermal engines (i.e. summer operation). 
The operating range (set point from to 1) of the machines have been discretised through 
steps of 0.2, being understood that the minimum set point is fixed by the manufacturer or by 
excessive efficiency degradation (i.e. 40% of full load for the thermal engines). 
An important element for the economical optimisation is the electricity rate. In the present 
case, the electricity rate of the industrial plant is divided into three time bands, as shown in 
Table 5 (the price includes fixed contributions). Table 4 shows the year cost and 
consumptions summary, compared with the simulation results. A mean difference of about 
2% of reported values is globally appreciable. 



Year 


2005 


simulation 


% error 


Total cost (k€) 


2182 


2132 


-2.4 


Gas usage engine (m3) 


1306734 


1281906 


-1.9 


Gas usage boilers (m3) 


2334173 


2285155 


-2.2 


Public electricity cost (k€) 


984 


964 


-2.1 



Table 4. Energy aspects of the power plant 



Time Bands 


Price (c€/kWh) 


Peak hours 


14.59 


Full hours 


12.98 


Empty hours 


8.68 



Table 5. Electricity rate 



5. Results and discussion 



The numerical method capabilities have been firstly evaluated performing three different 
simulations considering the same time scale and different optimisation criteria (minimum 
cost of operation, minimum consumption of fuel and minimum polluting emissions). 



192 



Energy Management 



Finally, in order to highlight the numerical results dependence on the available data time 
scale, four simulations have been performed considering the same optimisation criterion 
with different time scales. 



5.1 Optimisation criterion effect 

The following three different optimisation strategies have been considered: 

Strategy #1: minimise the total operation cost 

Strategy #2: minimise fuel consumption 

Strategy #3: minimise polluting emissions 
Each simulations has been performed using a time step of 4 hours. Table 6 compares the 
simulation results for the different optimization criterion. 





Strat. # 1 


Strat.# 2 


Strat.# 3 


Total cost (k€) 


1947 


2094 


2040 


Engine fuel consumption (m3) 


3405888 


3167942 


3283027 


Boilers fuel consumptions (m3) 


291359 


375772 


324488 


Electricity cost (k€) 


850 


1022 


956 


C02 emissions (kg) 


14434458 


14130819 


14299282 



Table 6. Four hours time step results 

It is immediately detectable that in every simulation, independently from the optimization 
criterion, the total cost is lower than 2005, thus demonstrating that the previous standard 
operation was far from being the optimal one, also from an economical point of view. These 

results also confirm that, often, fuel consumption (i.e. C0 2 emissions) or pollutant 

emissions reduction, may also yield an economical advantage. 

Adopting strategy #1, optimising the total cost, we could save more than the 11% of the 
original cost. Such an economic saving is obtainable without any installation improving 
(and then without any additional investment), but only with an optimal management of the 
power plant components. The operating conditions of the power plant components are 
reported in Figure 6 and Figure 7. The first graph shows the equipment utilisation factor in 
function of the set point, thus indicating if the components size have been properly chosen. 
The second graph, that shows the equipment utilisation yearly distribution, demonstrates if 
the equipment is characterized by a seasonal behaviour, or if it works almost constantly 
during the year. 



Optimal Management of Power Systems 



193 



Strategy #1 :Equipment utilisation factor 



u 
o 

o 

o 



■f 




1 . 1 thermal engine 
hot water boiler 
steam boiler 
mechanical chiller 
absorption chiller 



i i r 

0-0,2 0,2-0,4 0,4-0,6 0,6-0,8 0,8-1 



Set Point 
Fig. 6. Strategy #1: equipment utilisation factor. 



Strategy #1 : Equipment utilisation time distribution 

— i 1 — 






o 



thermal engine 
hot water boiler 
steam boiler 
mechanical chiller 



^ 20 



s - 




jan feb mar apr may jun jul aug sep oct nov dec 
month 



Fig. 7. Strategy #1: equipment utilisation time distribution. 



194 



Energy Management 



Strategy #2: Equipment utilisation factor 




Set Point 
Fig. 8. Strategy #2: equipment utilisation factor. 

The cogenerative thermal engine operates always under full load and its use is evenly 
distributed over the year, underlying a correct design sizing. On the other hand, the boilers 
are clearly over-sized, as they never work over the 40% of their capabilities. This fact can be 
explained observing that, originally, the power plant didn't include the cogenerator and the 
boilers had to satisfy the whole thermal demand. Regarding the cold production, chillers 
utilisation, both mechanical and absorption, is more regular over the year. Absorption 
chillers are turned on only during the warm months, when the heat demand is lower than 
the internal combustion engine heat production. 

It may appear singular that minimising the fuel consumption (strategy #2) does not yield 
the economical optimisation. This is related to the fact that the natural gas cost depends on 
its usage (see eq. 25), and in particular it is reduced for CHP utilisation. Therefore, it may be 
economically convenient to consume more gas for CHP operation. On the other hand, when 
the target is the carbon dioxide emissions minimisation, the high efficiency of the boiler 
together with a low electricity request may lead to a lower thermal engine utilisation. 
Comparing Figure 6 and Figure 8, in fact, it is possible to notice that strategy #2 requires a 
greater use of the boiler with respect to strategy #1. In addition, it can be appreciated a more 
uniform equipment utilisation over the year. Moreover, the economic optimisation leads a 
reduction of the thermal engine utilisation as the electricity rate is such that in some periods 
the electricity purchase from the public network is more convenient than the auto- 
production. The thermal engine is even turned off in August, during the industrial plant 
summer closure. These results also highlight the significant effects of the electricity and gas 
rates on the optimal management of the power plant. (Figure 9) 



Optimal Management of Power Systems 



195 



o 
o 

a 
o 

is 



Strategy #2: Equipment utilisation time distribution 

— i 1 1 1 1 1 1 1 1 1 1 r~ 




f 1 thermal engine 
^^^ hot water boiler 
^^| steam boiler 

mechanical chiller 
absorption chiller 




Fig 



jan feb mar apr may jun jul aug sep oct nov dec 
month 
9. Strategy #2: equipment utilisation time distribution. 



Finally, considering the pollutant emissions as the target function to be minimised, the 
result is a compromise between the first two strategies, as primarily a function of the 
environmental impact of the CHP under full load and part load operations. The power plant 
components operation with strategy #3 is shown in Figure 10 and Figure 11. 

Strategy #3: Equipment utilisation factor 



o 



•^ 
a 




0-0,2 0,2-0,4 0,4-0,6 0,6-0,8 0,8-1 

Set Point 



Fig. 10. Strategy #3: equipment utilisation factor. 



196 



Energy Management 



o 



2 



50 



40 



Strategy #3: Equipment utilisation time distribution 

- 1 1 1 1 1 1 1 1 1 1 1 1— 



I I thermal engine 

^^ hot water boiler 

I M steam boiler 

I —I mechanical chiller 




jan feb mar apr may jun jul aug sep oct nov dec 
month 
Fig. 11. Strategy #3: equipment utilisation time distribution. 



5.1 Time scale effect 

In this paragraph, the optimisation strategy #2 results performed on four different time 
scales are presented. Yearly global results are summarised in Table 7. 





Monthly 


12h 


4h 


lh 


Total cost (k€) 


1921 


2008 


2094 


2103 


Engine gas usage (m3) 


3349123 


3195003 


3167942 


3162428 


Boilers gas usage (m3) 


274246 


352955 


375772 


390128 


Net electricity cost (k€) 


844 


938 


1022 


1031 


C02 emissions (kg) 


13806563 


14086093 


14130819 


14148523 



Table 7. Optimisation results using different time steps 

Firstly, as expected, reducing the time-step leads to a fuel consumption reduction, as the 
optimisation becomes more accurate. Considering that the minimum time-step is determined 
by the time-scale of energy consumption data, the more frequent is the measurement of fuel 
and electricity consumption the more accurate is the present methodology. 
As the fuel consumption reduces, the total cost rises, such as boilers gas usage, public 
electricity cost and carbon dioxide emissions. This fact can be easily related to the lower 
usage of the thermal engine, which means that a greater part of the electric energy demand 
have to be satisfied by the public network and the boilers have to compensate for the lower 



Optimal Management of Power Systems 



197 



heat production by cogeneration. In the matter of C02, even if boilers efficiencies are higher 
than the engine one, the emissions are increased because of the fuel mix utilization in public 
electricity production instead of natural gas only. 

As reported in Table 8, mean and variance values of the equipment installation set points 
decrease as the time step raises, with the exception of the engine mean set point. This is 
related both to the increased energy demand variation and the higher efficiency of the 
boilers. Considering the negligible gain (0.003 % as reported in Table 8) observed changing 
the time step from 4 h to lh time step and the effort required (both technological and 
managerial) to make a frequent control of the power plant components, it may be 
counterproductive to use very small time-steps. It must be also noticed that using a little 
time step forces a frequent regulation of the equipment set point, thus producing losses that 
cannot be predicted by the present quasi-steady numerical model. As an example over two 
weeks, Figure 12 shows how reducing the time step the steam boiler set points vary around 
its mean value, represented respectively by the bigger time step. 







lh 


4h 


12 h 


Month 


Thermal engine 


mean 


0,88 


0,93 


0,94 


0,946 


variance 


0,052 


0,05 


0,04 


0,003 


Hot water boiler 


mean 


0,057 


0,056 


0,053 


0,042 


variance 


0,016 


0,013 


0,012 


0,006 


Steam boiler 


mean 


0,12 


0,12 


0,1 


0,076 


variance 


0,011 


0,01 


0,009 


0,005 


Mechanical chiller 


mean 


0,59 


0,57 


0,56 


0,53 


variance 


0,084 


0,083 


0,081 


0,02 


Absorption chillers 


mean 


0,45 


0,44 


0,41 


0,35 


variance 


0,155 


0,15 


0,13 


0,09 



Table 8. Mean and variance of the equipment installation set points with strategy #2 using 
different time stepping 



Considering the plant regulation point of view, the above results show that with manual 
power management (which means that the machines are manually regulated and therefore 
not compatible with small time-steps) it is still possible to achieve impressive results in 
terms of energy saving. Alternatively, with automatic power management, which 
theoretically allows a continuous regulation, extra-savings could be obtained. 



198 



Energy Management 



Steam boiler trend 



g 
o 

Q_ 

-i— » 
(D 
(J) 



0.35 



0.30 - 



0.25 



0.20 



0.15 



0.10 



0.05 




hour 



Fig. 12. Two weeks steam boiler set points. 



6. Calculating or measuring the energy demand 

The facility energy demand, which represent the first of the non-controllable input variables, 
may be obtained through historical data (i.e. energy bills) or may be directly measured or 
may result from a combination of the two. The present numerical results clearly highlight 
that the energy demand data availability is crucial to the success of implementing the 
proposed methodology, as the time-scale detail on the energy demand data determines the 
minimum time step between different set points and therefore the effective gain. 
It is also important to notice that making the consumption profile on historical data , as done 
for the present case study, may lead to wrong conclusions and non-economic actions, as 
energy consumption may significantly vary from year to year, as it is related to several 
factors as production volume, ambient temperature, daylight length etc. 
Therefore, to be effective, the present procedure should be coupled to a real-time energy 
monitoring system. With modern computers, in fact, the optimisation could be calculated in 
short times, similar to or smaller than a typical model time-step, thus giving the equipment 
setpoints "real-time". Moreover, if the proposed computational procedure is combined to an 
automatic system to control the equipment set-points, the optimisation could be performed 
in real-time. 

The energy demand from the served facility may be also obtained through another 
mathematical model, which is in turn built on the basis of historical or measured data. This 
requires the construction of a consumption model: modeling the industrial plant energy 
consumption in function of its major affecting factors (i.e. energy drivers), as production 
volume, temperature, daylight length etc. This model should give the expected consumption 
in function of time and, again, the time-step should be as small as possible in order to have 



Optimal Management of Power Systems 199 

reliable predictions and to distinguish the plant consumption and the energy drivers 
variation within the time bands of the energy rate. This could be done by installing a 
measuring system to record both energy consumption and energy drivers. The meters 
position within the plant is particularly important in order to correlate the energy 
consumption to the energy drivers (i.e. different production lines). Therefore, a preliminary 
analysis based, for example, on the nominal power and the utilization factor of the single 
machines should be performed in order to build a meters tree. 

7. Conclusions 

The present chapter discusses the importance of energy systems proper management to 
reduce energy costs and environmental impact. A numerical model for the optimal 
management of a power plant in buildings and industrial plants is presented. The model 
allows evaluating different operating strategies for the power plant components. The 
different strategies are defined on the basis of a pure economic optimisation (minimisation 
of total cost) and/ or of an energetic optimisation (minimisation of fuel consumption) 
and/ or of an environmental optimisation (minimisation of pollutant emissions). All these 
strategies have been applied to an energy system serving a pharmaceutical industrial plant 
demonstrating that, independently from the optimisation criterion, a significant gain can be 
obtained with respect to the standard operation with every objective function (cost, fuel 
consumption or pollutant emissions). 

Furthermore, given the same optimisation criterion, remarkable differences are observed 
when varying the time-step, highlighting that the accuracy of the numerical results is strictly 
dependent on the detail level of the external inputs. In particular, the time-step dependence 
shows on one hand the importance of continuously monitoring the energy consumption 
(data available with a high frequency) and on the other hand the uselessness of using very 
small time scales for the energy system regulation. 

The main advantages of the described model are that it is time efficient and its effectiveness 
is guaranteed whatever is the input data detail. Obviously, the more detailed are the input 
data, the more accurate are the numerical results. Nevertheless, even using monthly data it 
has been possible to suggest a cost reducing operating strategy. Moreover, in the presence 
of an energy consumption monitoring system, the proposed methodology could allow a 
real-time calculation of the optimal equipment setpoints. 

8. References 

Agency for Natural Resources and Energy, January 2004, http://www.enecho.meti.go.jp. 
Andreassi L., Ciminelli M.V., Feola M. & Ubertini S. (2009) Innovative Method for Energy 

Management: Modelling and Optimal Operation of Energy Systems Energy and 

Buildings Volume 41 pp. 436-444 
Arivalgan A., Raghavendra B.G. & Rao A.R.K.. (2000) Integrated energy optimization model 

for a cogeneration in Brazil: two case studies. Applied Energy Volume 67 pages 245- 

263 
Cardona E. & Piacentino A. (2007) Optimal design of CHCP plants in the civil sector by 

thermoeconomics. Applied Energy Vol. 84 pages 729-748 



200 Energy Management 

Cesarotti V., Ciminelli M.V., Di Silvio B., FedeleT. & Introna V. (2007) Energy Budgeting 

and Control for Industrial Plant through Consumption Analysis and Monitoring, 

Proceedings of European Power and Energy Systems EuroPES 2007 
Doering R.D.& Lin B.W. (1979) Optimum operation of a total energy plant. Computers & 

Operations Research Vol.6 pages 33-38 
Frangopoulos C.A., Lygeros A.L., Markou C.T. & Kaloritis P. (1996) Thermoeconomic 

operation optimization of the Hellenic Aspropyrgos Refinery combined cycle 

cogeneration system, Applied Thermal Eng. Volume 16 pages 949-958 
Italian Ministry for the Environment, "Recepimento della direttiva 1999/30/ CE del 

Consiglio del 22 aprile 1999 concernente i valori limite di qualita v dell' aria ambiente 

per il biossido di zolfo, il biossido di azoto, gli ossidi di azoto, le particelle e il 

piombo e della direttiva 2000/ 69/ CE relativa ai valori limite di qualita v aria 

ambiente per il benzene ed il monossido di carbonio", Gazzetta Ufficiale 

Supplemento Ordinario, 2002, p. 87. 
Kamal W.A. (1997) Improving energy ef f iciency — the cost-effective way to mitigate global 

warming. Energy Conservation and Management 38 1, pp. 39-59. 
Kong X.Q, Wang R.Z. &Huang X.H. (2005) Energy optimization model for a CCHP system 

with available gas turbines. Applied Thermal Engineering. Vol. 25 pages 377-391 
Kong X.Q., Wang R.Z., Li Y. & Huang X.H. (2009) Optimal operation of a micro-combined 

cooling, heating and power system driven by a gas engine. Energy Conversion and 

Management. Vol. 50 pages 530-538 
Lopes L., Hokoi S., Miura H.& Shuhei K.(2005) Energy efficiency and energy savings in 

Japanese residential buildings — research methodology and surveyed results, 

Energy and Buildings 37 698-706 
Marik K., Schindler Z. &. Stluka P. (2008) Decision Support tools for advanced energy 

management. Energy. Vol. 33 pages 858-873 
Meier A.K. (1997) Observed Savings from Appliance Efficiency Standards Energy and 

Buildings, 26 111-117 
Moslchi K., Khade, M. & Bernal R. (1991) Optimization of multiplant cogeneration system 

operation including electric and steam network, IEEE Trans Power Syst 6 (2) pp. 

484-490 
Puttgen H.B. & MacGregor P.R. (1996) Optimum scheduling procedure for cogenerating 

small power producing facilities. Proceedings IEEE Trans Power Syst Vol. 4 pages 

957-964 
Smith, C.B.; Capehart B.L. & Rohrer Jr. (2007) Industrial Energy Efficiency and Energy 

Management, in Energy Management and conservation handbook. 

ISBN:9781420044294 
Tstsaronis G. & Winhold M. (1985) Exoergonomic analysis and evaluation of energy 

conversion plants. I: A new methodology. II: Analysis of a coal-fired steam power 

plant. Energy Volume 10 pages 81-84 
Tstsaronis G. & Pisa J. (1994) Exoergonomic evaluation and optimization of energy systems 

- application to the CGAM problem. Energy Volume 19 pages 287-321 
Temir G. & Bilge D. (2004). Thermoeconomic analysis of a trigeneration system. Applied 

Therm. Eng. Volume 24, pages 2689-2699 
Valero A. & Lozano M. (1993) Theory of the exergetic cost. Energy Vol. 18, pages 939-960 



Optimal Management of Power Systems 



201 



Van Schijndel A.W.M. (2002), Optimal operation of a power plant Energy and Buildings 34 

1055-1065. 
Von Spakovsky M.R:, Curtil V. &, Batato M. (1995) Performance optimization of a gas 

turbine cogeneration/heat pump facility with thermal storage. Journal of 

Engineering of Gas Turbines and Power, Volume 117 pages 2-9 

9. Nomenclature 



E 


Primary energy 


(E) 


EIC 


Annual electricity cost 


(k€) 


FC 


Annul fuel cost 


(k€) 


H t 


Lower heating value 


(kj/kg) 


P 

1 ElBal 


Electricity balance 


(W) 


^Elge 


Gas engine electric power production 


(W) 


P 

1 EID 


Electricity demand 


(W) 


P S e 


Chemical power consumption in the gas engine 


(W) 


p 

mc 


Mechanical chiller electric power consumption 


(W) 


^flcmax 


Absorption chiller (maximum) heat consumption 


(W) 


Qcac 


Absorption chiller cold power production 


(W) 


iJcBal 


Cold balance 


(W) 


Qcd 


Cold demand 


(W) 


Qcge 


Gas engine cold power production 


(W) 


zZCmc 


Mechanical chiller cold power production 


(W) 


z^Hwac 


Heat power from gas engine to absorption chiller 


(W) 


i^HwBal 


Hot water balance 


(W) 


izHwb 


Boilers heat production as hot water 


(W) 


&HwD 


Hot water demand 


(W) 


z^Hwge 


Gas engine heat production as hot water 


(W) 


Qs„ 


Boilers heat production as steam 


(W) 


fJsBal 


Steam balance 


(W) 


Q SD 


Steam demand 


(W) 



202 



Energy Management 





Qsge 


Gas engine heat production as steam 


(W) 


SP S e 


Gas engine set point 




SP 

mc 


Mechanical chiller set point 




sw ac 


Switch of supply heat of absorption chiller (0 or 1) 




TC 


Total annual cost 


(k€) 


c v 


Boilers fuel cost 


(€/kg) 


C gef 


Gas engine fuel cost 


(€/kg) 


C El 


Cost of electricity 


(€/J) 


C °Pac 


Coefficient of performance of the absorption chiller 




C °P m c 


Coefficient of performance of the mechanical chiller 




m bf 


Fuel mass consumption in the boilers 


(kg) 


m g ef 


Fuel mass consumption in the gas engine 


(kg) 


m bf 


Fuel mass flow rate in the boilers 


(kg/s) 


m co 


CO mass flow rate 


(kg/s) 


m C o 2 


C02 mass flow rate 


(kg/s) 


m jHwb 


Hot water boiler fuel consumption 


(kg/s) 


™fisb 


Steam water boiler fuel consumption 


(kg/s) 


™Zef 


Fuel mass flow rate in the gas engine 


(kg/s) 


™NO x 


NOx mass flow rate 


(kg/s) 


™SO x 


SOx mass flow rate 


(kg/s) 


m Tf 


Total fuel mass flow rate 


(kg/s) 


Pfco 


CO polluting factor 




Pfco 2 


C02 polluting factor 




Pf 

rJ mix 


Global polluting factor 




P/no x 


NOx polluting factor 




PJ soot 


Soot polluting factor 




Pfso x 


SOx polluting factor 





10 



Energy Management 

Alaa Mohd 

The University of South Westphalia, Campus Soest 

Germany 



1. Introduction 



Fossil fuels are currently the major source of energy in the world. However, as the world is 
considering more economical and environmentally friendly alternative energy generation 
systems, the global energy mix is becoming more complex. Factors forcing these 
considerations are (a) the increasing demand for electric power by both developed and 
developing countries, (b) many developing countries lacking the resources to build power 
plants and distribution networks, (c) some industrialized countries facing insufficient power 
generation and (d) greenhouse gas emission and climate change concerns. Renewable 
energy sources such as wind turbines, photovoltaic solar systems, solar-thermo power, 
biomass power plants, fuel cells, gas micro-turbines, hydropower turbines, combined heat 
and power (CHP) micro-turbines and hybrid power systems will be part of future power 
generation systems. 

A new trend in power systems is developing toward distributed generation (DG), which 
means that energy conversion systems (ECSs) are situated close to energy consumers and 
large units are substituted by smaller ones. For the consumer the potential lower cost, higher 
service reliability, high power quality, increased energy efficiency, and energy 
independence are all reasons for interest in distributed energy resources (DERs). The use of 
renewable distributed energy generation and "green power" can also provide a significant 
environmental benefit. This is also driven by an increasingly strained transmission and 
distribution infrastructure as new lines lag behind demand and to reduce overall system 
losses in transmission and distribution. Other motives are the increased need for reliability 
and security in electricity supply, high power quality needed by an increasing number of 
activities requiring UPS like systems and to prevent or delay the expansion of central 
generation stations by supplying the growing loads locally (McDowall 2007; Brabandere 
October, 2006). 

Nevertheless, all of these sources require interfacing units to provide the necessary crossing 
point to the grid. The core of these interfacing units is power electronics technologies since 
they are fundamentally multifunctional and can provide not only their principle interfacing 
function but various utility functions as well. The inverter is considered an essential 
component at the grid side of such systems due to the wide range of functions it has to 
perform. It has to convert the DC voltage to sinusoidal current for use by the grid in 
addition to act as the interface between the ECSs, the local loads and the grid. It also has to 



204 Energy Management 

handle the variations in the electricity it receives due to varying levels of generation by the 
renewable energy sources (RESs), varying loads and varying grid voltages. Inverters 
influence the frequency and the voltage of the grid and seem to be the main universal 
modular building block of future smart grids mainly at low and medium voltage levels. 

The main problem associated with that is the development of general, flexible, integrated, 
and hierarchical control strategy for DERs to be integrated into the dynamic grid control 
and management procedures of electrical power supply systems (primary control, 
frequency and power control, voltage and reactive power control) through flexible power 
electronics namely inverters. 

2. Distributed Generation 

Currently, there is no consensus on how the distributed generation (DG) should be exactly 
defined (Purchala, Belmans et al. 2006). A very good overview of the different definitions 
proposed in the literature is given in (Pepermans, Driesen et al. 2005). In general, distributed 
generation describes electric power generation that is geographically distributed or spread 
out across the grid, generally smaller in scale than traditional power plants and located 
closer to the load, often on customers' property. Distributed generation is characterized by 
some or all of the following features: 

• Small to medium size, geographically distributed power plants 

• Intermittent input resource, e.g., wind, solar 

• Stand-alone or interface at the distribution or sub-transmission level 

• Utilize site-specific energy sources, e.g., wind turbines require a sustained wind 
speed of 20 km/ hour. To meet this requirement they are located on mountain 
passes or the coast 

• Located near the loads 

• Integration of energy storage and control with power generation 

Technologies those are involved in Distributed Generation include but are not limited to: 
Photovoltaic, Wind energy conversion systems, Mini and micro hydro, Geothermal plants, 
Tidal and wave energy conversion, Fuel cell, Solar-thermal-electric conversion, Biomass, 
Micro and mini turbines, Energy storage technologies, including flow and regular batteries, 
pump-storage hydro, flywheels and thermal energy storage. 

The idea behind DG is not a new concept. In the early days of electricity generation, DG was 
the rule, not the exception (Driesen and Belmans 2006). However, technological evolutions 
and economical reasons developed the current system with its huge power generation 
plants, transmission and distribution grids. An overview of Distributed Generation is 
illustrated in Fig. 1.2. 

In the last decade, technological innovation, economical reasons and the environmental 
policy renew the interest in Distributed Generation. The major reasons for that are: 

• To reduce dependency on conventional power resources 

• To reduce emissions and environmental impact 

• Market liberalization 

• Improve power quality and reliability 



Energy Management 



205 



Progress in DG technologies especially RESs 

To reduce transmission costs and losses 

To increase system security by distributing the energy plants instead of 

concentrating them in few locations making them easy targets for attacking 




Fig. 1. Principal supply strategy of distributed Generation. 







H 

□ ■ 
m - 

■0- 



Distributed generation is becoming an increasing important part of the power infrastructure 
and the energy mix and is leading the transition to future Smart Grids. This is as well one of 
European Commission targets in order to increase the efficiency, safety and reliability of 
European electricity transmission and distribution systems and to remove obstacles to the 
large-scale integration of distributed and renewable energy sources. 



3. Future Power Supply Systems (Smart Grids) 

Energy plays a vital role in the development of any nation. The current electricity 
infrastructure in most countries consists of bulk centrally located power plants connected to 
highly meshed transmission networks. However, new trend is developing toward 
distributed energy generation, which means that energy conversion systems (ECSs) will be 
situated close to energy consumers and the few large units will be substituted by many 
smaller ones. For the consumer the potential lower cost, higher service reliability, high 
power quality, increased energy efficiency, and energy independence are all reasons for the 
increasing interest in what is called " Smart Grids". 

Although the "Smart Grid" term was used for a while, there is no agreement on its 
definition. It is still a vision, a vision that is achievable and will turn into reality in near 



206 Energy Management 

future. One of the best and general definitions of a smart grid is presented in (Energy 2007). 
Smart grid is an intelligent, auto-balancing, self-monitoring power grid that accepts any 
source of fuel (coal, sun, wind) and transforms it into a consumer's end use (heat, light, 
warm water) with minimal human intervention. It is a system that will allow society to 
optimize the use of RESs and minimize our collective environmental footprint. It is a grid 
that has the ability to sense when a part of its system is overloaded and reroute power to 
reduce that overload and prevent a potential outage situation; a grid that enables real-time 
communication between the consumer and utility allowing to optimize a consumer's energy 
usage based on environmental and/ or price preferences (Energy 2007). 

3.1 Drivers Towards Smart Grids 

Many factors are influencing the shape of our future electricity networks including climate 
change, aging infrastructure and fossil fuels running out. According to the International 
Energy Agency (IEA) Global investments required in the energy sector for 2003-2030 are an 
estimated $16 trillion. In Europe alone, some €500 billion worth of investment will be 
needed to upgrade the electricity transmission and distribution infrastructure. The 
following are the main drivers towards Smart Grids (Hatziagyriou 2008; Ipakchi 2007): 

• The Market: Providing benefits to the customers by increasing competition 
between companies in the market. Competition has led many utilities to divest 
generation assets, agree to mergers and acquisitions, and diversify their product 
portfolios. This will give the customers a wider choice of services and lower 
electricity prices. 

• Environmental regulations: Another significant driver concerns the regulation of 
the environmental, public health, and safety consequences of electricity production, 
delivery, and use. The greenhouse gases contribute to climate change, which is 
recognised to be one of the greatest environmental and economic challenges facing 
humanity. To meet these environmental policies, rapid deployment of highly 
effective, unobtrusive, low-environmental-impact grid technologies is required. 

• Lack of resources: Energy is the main pillar for any modern society. Countries 
without adequate reserves of fossil fuels are facing increasing concerns for primary 
energy availability. Currently approximately 50% within EU is imported from 
politically unstable countries. 

• Security: The need to secure the electric system from threats of terrorism and 
extreme weather events are having their effect as well. Techniques must exist for 
identifying occurrences, restoring systems quickly after disruptions, and providing 
services during public emergencies. This is why electricity grids should be 
redesigned to cope with the new rule. 

• Aging infrastructure: The aging infrastructure (Europe and USA) of electricity 
generation plants, transmission and distribution networks is increasingly 
threatening security, reliability and quality of supply. The most efficient way to 
solve this is by integrating innovative solutions, technologies and grid 
architectures. 

• New generation technologies (Distributed Generation): These forms of generation 
have different characteristics from traditional plants. Apart from large wind farms 
and large hydropower plants, this type of generation tends to have much smaller 



Energy Management 207 

electricity outputs than the traditional type. Some of the newer technologies also 
exhibit greater intermittency. However, existing transmission and distribution 
networks, were not initially designed to incorporate these kinds of generation 
technology in the scale that is required today. 

• Advanced power electronics: Power electronics allow precise and rapid switching 
of electrical power. Power electronics are at the heart of the interface between 
energy generation and the electrical grid. This power conversion interface- 
necessary to integrate direct current or asynchronous sources with the alternating 
current grid-is a significant component of energy systems. 

• Information and communication technologies (ICT): The application of ICT to 
automate various functions such as meter reading, billing, transmission and 
distribution operations, outage restoration, pricing, and status reporting. The 
ability to monitor real-time operations and implement automated control 
algorithms in response to changing system conditions is just beginning to be used 
in electricity (2003). Distributed intelligence, including "smart" appliances, could 
drive the co-development of the future architecture. 

3.2 Key Challenges for Smart Grids 

Even though many drivers for smart grids and their benefits are obvious, there are many 
challenges and barriers standing in the way and should be cracked first. These include: 

• Standardisation: Design and development of a modular standardised architecture 
of modern power electronic systems for linking distributed energy converting 
systems (DECSs) (i.e. PV, wind energy converters, fuel cells, diesel generators and 
batteries) to conventional grids and to isolated grids on the basis of modular power 
electronic topologies which fulfil the requirements for integration into the dynamic 
control system of the grid (Ortjohann and Omari 2004). 

• Advance communication layer: Development and implementation of a general 
communication layer model for simple and quick incorporation of DECSs in the 
grid and its superimposed online control system 

• Non-technical challenges: Issues such as pricing, incentives, decision priorities, risk 
responsibility and insurance for new technologies adaptation, interconnection 
standards, regulatory control and addressing barriers. This also includes, finding a 
profitable business model, attracting resources and developing better public 
policies (Nigim and Lee 2007). 

4. State of the Art 

This section presents the state-of-the-art of power electronic inverters control used currently 
in electrical systems. Different system architectures, their modes of operation, management 
and control strategies will be analysed. Advantages and disadvantages will be discussed. 
Though, it is not easy to give a general view at the state of the art for the research area since 
it is rapid and going in different directions. The focus here will be on the main streams in 
low voltage grids especially paralleled power electronics inverters. Inverters are often 
paralleled to construct power systems in order to improve performance or to achieve a high 
system rating. Parallel operation of inverters offers also higher reliability over a single 



208 



Energy Management 



centralized source because in case one inverter fails the remained (n-1) modules can deliver 
the needed power to the load. This is as well driven by the increase of RESs such as 
photovoltaic and wind. There are many techniques to parallel inverters which are already 
suggested in the literature, they can be categorized to the following main approaches: 

1) Master/ Slave Control Techniques 

2) Current/ Power Deviation (Sharing) Control Techniques 

3) Frequency and Voltage Droop Control Techniques 

a) Adopting Conventional Frequency/ Voltage Droop Control 

b) Opposite Frequency/ Voltage Droop Control 

c) Droop Control in Combination with Other Methods 

4.1 Master/Slave Control Techniques 

The Master/ Slave control method uses a voltage controlled inverter as a master unit and 
current controlled inverters as the slave units. The master unit maintains the output voltage 
sinusoidal, and generates proper current commands for the slave units (Prodanovic, Green 
et al. 2000; Tuladhar 2000; Ritwik Majumder , Arindam Ghosh et al. 2007). 
One of the Master/ Slave configuration is the scheme suggested in (Chen, Chu et al. 1995; 
Jiann-Fuh Chen and Chu 1995) , see Fig. 2, which is a combination of voltage-controlled and 
current-controlled PWM inverters for parallel operation of a single-phase uninterruptible 
power supply (UPS). The voltage-controlled inverter (master) is developed to keep a 
constant sinusoidal wave output voltage. The current-controlled inverter units are operated 
as slave controlled to track the distributive current. The inverters do not need a PLL circuit 
for synchronization and gives a good load sharing. However, the system is not redundant 
since it has a single point of failure. 




Fig. 2. Combined voltage and current controlled inverters (Jiann-Fuh Chen and Chu 1995). 

A comparable scheme is also presented in (K Siri, C.Q. Lee et al. 1992) but it needs even 
more interconnection since it is sharing the voltage and current signals. In (Holtz and 
Werner 1990) the system is redundant by extended monitoring of the status and the 



Energy Management 



209 



operating conditions of all power electronic equipment. Each block of the UPS system is 
monitored by two independent microcomputers that process the same data. The 
microcomputers are part of a redundant distributed monitoring system that is separately 
interlinked by two serial data buses through which they communicate. They establish a 
hierarchy among the participating blocks by defining one of the healthy inverter blocks as 
the master. 

The scheme proposed in (Petruzziello 1990), see Fig. 3., is based on the Master/ Slave 
configuration but is using a rotating priority window which provides random selection of a 
new master and therefore results in true redundancy and increase reliability. 



Module 1 




Module 2 


) 






Module 3 


Power 
Section 




Power 
Section 




Power 
Section 


Contol Logic 
and Sync 
Circuitry 


Contol Logic 
and Sync 
Circuitry 


Contol Logic 
and Sync 
Circuitry 


h' 


i 


i 


U: 


I I 


1' 


i 


CV 


U s 


I 


1" 


CV 


k I 






















o 







O: Output, I: Input 

Fig. 3. Proposed Master/ Slave configuration in (Petruzziello 1990) 



In (Van Der Broeck and Boeke 1998) the system is also redundant since a status line is used 
to decide about the master inverter using a logical circuit (flip-flop), if the master is 
disconnected one slave becomes automatically the master. The auto-master-slave control 
presented in (Pei, Jiang et al. 2004) is designed to let the unit with highest output real power 
act as a master of real power and derives the reference frequency, the others have to follow 
as slaves. The regulation of the reactive power is similar, the highest output reactive power 
module acts as master of reactive power and adjusts the voltage reference amplitude. 
In (Lopes 2004; J.A.P.Lopes, Moreira et al. 2006) the paper focus on operation of the 
microgrid when it becomes isolated under different condition. This was investigated for two 
main control strategies, single master operation where a voltage source inverter (VSI) can be 
used as voltage reference when the main power supply is lost; all the other inverters can 
then be operated in PQ mode. And multi-master operation where more than one inverter 
are operated as a VSI, other PQ inverters may also coexist. In more recent papers 
(Prodanovic, Green et al. 2000; T.C. Green and Prodanovic 2007; Prodanovic Oct. 2006) an 
enhanced approach is introduced, the master inverter is replaced by a central control block 
which controls the output voltages and can influence the output current of the different 
units, this is sometimes called central mode control or distributed control. This means that 
the voltage magnitude, frequency and power sharing are controlled centrally (commands 
are distributed through a low bandwidth communication channels to the inverters) and 
other issues such as harmonic suppression are done locally, see Fig. 4. 



210 



Energy Management 




Communication Bus 



Generator Bus 



Fig. 4. Proposed distributed control configuration in (T.C. Green and Prodanovic 2007). 

4.2 Current/Power Deviation (Sharing) Control Techniques 

In this control technique the total load current is measured and divided by the number of 
units in the system to obtain the average unit current. The actual current from each unit is 
measured and the difference from the average value is calculated to generate the control 
signal for the load sharing (Tuladhar 2000). In the approach suggested in (T.Kawabata and 
S.Higashino 1988), see Fig. 5, the voltage controller adjusts the small voltage deviation and 
keeps the voltage constant. The AI signal is detected and given to the current loop as a 
correction factor, and the AP signal controls the phase of the reference sine wave. A very 
good load sharing can be obtained. Transient response is very good due to the feed forward 
control signal (Tuladhar 2000). 



Current 
Controller 





l L /n 



O- 



Fig. 5. Proposed parallel operation of inverter with current minor loop (T.Kawabata and 
S.Higashino 1988). 



Energy Management 



211 



In (Huang 2006) circular chain control (3C) strategy is proposed, see below Fig. 6., all the 
modules have the same circuit configuration, and each module includes an inner current 
loop and an outer voltage loop control. With the 3C strategy, the modules are in circular 
chain connection and each module has an inner current loop control to track the inductor 
current of its previous module, achieving an equal current distribution. 



v dc 



CQ 



Modulel -G-^H 1 •- 

L 
Module 2 -B-^^H 1 <► 



'JX- 



T 



Module n -Pr^^M • 1 

yj c =r 



T 

Fig. 6. The proposed circular chain control (3C) strategy (Huang 2006). 

Authors of (Hanaoka 2003) proposed an inverter current feed-forward compensation which 
makes the output impedance resistive rather than inductive in order to get a precise load 
sharing. In (Hyun 2006) the paper goes further based on the approach introduced in 
(Hanaoka 2003) and proposes a solution to the noise problem of harmonic circulating 
currents due to PWM non-synchronization which is affecting the load sharing precision. 
This is done in (S. Tamai 1991) using a digital control algorithm. The digital voltage 
controller, which has high-speed current control as a minor loop, provides low voltage 
distortion even for nonlinear loads. Output current of each UPS module is controlled to 
share the total load current equally and the voltage reference command of each inverter is 
controlled to balance the load current. In (H.Oshima, Y.Miyazaya et al. 1991; W.Hoffmann, 
R.Bugyi et al. 1993; Lee, Kim et al. 1998) similar approaches are suggested. In (Qinglin, 
Zhongying et al. 2006) the focus is on developing a solution for the effect of DC offset 
between paralleled inverters and its effect on the circulating currents. In (Xing, Huang et al. 
2002) the authors suggest two-line share bus connecting all inverters, one for current sharing 
control and the other to adjust the voltage reference. 



4.3 Frequency and Voltage Droop Control Techniques 

Many methods were found in the literature and can be roughly categorized into the 
following: 

a. Adopting Conventional Frequency/ Voltage Droop Control 

b. Opposite Frequency/ Voltage Droop Control 

c. Droop Control in Combination with Other Methods 



212 



Energy Management 



a. Adopting Conventional Frequency/Voltage Droop Control 

In (C.-C. Hua) the paper proposes a control technique for operating two or more single 
phase inverter modules in parallel with no auxiliary interconnections. In the proposed 
parallel inverter system, each module includes an inner current loop and an outer voltage 
loop controls, see Fig. 7. This technique is similar to the conventional frequency/ voltage 
droop concept; uses frequency and fundamental voltage droop to allow all independent 
inverters to share the load in proportion to their capacities. 





Reference 

voltage 
calculation 




h- 


P 

tage 
jlation 


Power 
Calculation 








M 


^ 


Wref I 1 

Reference vo 
and power calci 


Vout 


Vrof= V COS Wroft 








\~~ 




Lout 




V 


Q 



Fig. 7. Reference voltage and power calculation (C.-C. Hua). 

In (M. C. Chandorkar 1993) scheme for controlling parallel-connected inverters in a stand- 
alone AC supply system is presented, see Fig. 8. This scheme is suitable for control of 
inverters in distributed source environments such as in isolated AC systems, large and UPS 
systems, PV systems connected to AC grids. Active and reactive power sharing between 
inverters can be achieved by controlling the power angle (by means of frequency), and the 
fundamental inverter voltage magnitude. Simulation results obtained for large units using 
Gate turn-off (GTO) thyristor switches. The control is done in the d-q reference frame; an 
inverter flux vector is formed by integrating the voltage space vector. The choice of the 
switching vectors is essentially accomplished by hysteresis comparators for the set values 
and then using a look-up table to choose the correct inverter output voltage vector. The 
considerations for developing the look-up table are dealt with in (Noguchi 1986). However, 
the inductance connected between the inverter and the load makes the output impedance 
high. Therefore, the voltage regulation as well as the voltage waveform quality is not good 
under load change conditions as well as a nonlinear load condition. The authors explain the 
same concept but with focusing in control issues of UPS systems in (M. C. Chandorkar, 
Divan etal. 1994). 



AC System 
Voltage — 
Feedbak 



AC System 
Current — 
Feedbak 



PandQ 
Calculator 




E*=f(Q) 


Q * 
P 


w*=g(P) 


* 



System 
Voltage 
Vector 
Calc. 



wand E 
Control 



Inverter 
Flux 

Vector 
Calc. 



AC System 
Voltage 
Feedback 



Inverter 
Voltage 
Feedback 



Inverter 

Flux 
Vector 
Control 



Control 

► Inverter 

Switches 



Fig. 8. Inverter control scheme (M. C. Chandorkar 1993). 



Energy Management 



213 



In (Hauck Matthias 2000; Matthias and Helmut 2002) the inverse droop equations are used 
to control the inverter, see Fig. 9. The inverter is able to work in parallel with a constant- 
voltage constant-frequency system, as well as with other inverters or also in stand-alone 
mode. There is no communication interface needed. The different power sources can share 
the load also under unbalanced conditions. Very good load sharing is achieved by using an 
outer control loop with active and reactive power controller, for which the set point 
variables are derived out of droops. Furthermore, a relatively big inductance is used in the 
LC filter and a small decoupling reactance is used to decouple the inverter from other 
voltage sources. The interface inductance make the voltage source converters (VSCs) less 
sensitive to disturbances on the load bus (M. Chandorkar 1994; Sao and Lehn 2005). 













P* \ 

Q* 

i 
Q 






Q* 






Calculator 

ofP.Q, U 

and f 


f 


U 


> — 










u l (t) = U.sm(cot+$) 

u 2 (?) = U.sin(a>t — - + &) 

An 
u 3 (t) = U.sin((ot + 3) 




Grid Voltages ^ 




u* 


^ Voltage controller 1 






P(f)-Droop 




Active power 
controller 


^. Voltage controller 2 


Grid Currents ► 


U 


b. 






^. Voltage controllers 




i — 














Q(U)-Droop 




Reactive powe 
controller 







Fig. 9. Inverter control scheme proposed in (Hauck Matthias 2000; Matthias and Helmut 2002). 



In (C.K. Sao) an interesting autonomous load-sharing technique for parallel connected three- 
phase voltage source converters is presented. This paper focuses on an improvement to the 
conventional frequency droop scheme for real power sharing and the development of a new 
reactive power-sharing scheme. The improved frequency droop scheme computes and sets 
the phase angle of the VSC instead of its frequency. It allows the operator to tune the real 
power sharing controller to achieve desired system response without compromising 
frequency regulation by adding an integral gain into the real power control. The proposed 
reactive power sharing scheme introduces integral control of the load bus voltage, combined 
with a reference that is drooped against reactive power output. This causes two VSCs on a 
common load bus to share the reactive load exactly in the presence of mismatched interface 
inductors if the line impedances are much smaller than the interface reactors (assuming 
short lines). Moreover, in the proposed reactive power control, the integrator gain can be 
varied to achieve the desired speed of response without affecting voltage regulation. 
In (Engler 2000; A. Engler, M. Meinh et al. 2003; A. Engler, M. Meinhardt et al. 2004) the 
author discusses the application of conventional droops for voltage source inverters and 
categorize the system components to form a modular AC-hybrid power system. Then in 
(Engler 2006) by the same author an investigation of what is called opposite droop (active 
power/ voltage and reactive power/ frequency droop) control is carried out. The focus is on 
the need of different droop functions for different types of grids. In (Engler 2006) it is found 
that for high voltage (mainly inductive) grids the regular droop functions can be used also 
for distributed generation systems. For low voltage (mainly resistive) grids, so-called 
opposite droop functions could be used instead but the regular droop functions are 
advantageous since it allows connectivity to higher voltage levels and power sharing also 



214 



Energy Management 



with rotating generators (A. Engler and Soultanis; Engler 2005; Karlsson, Bjornstedt et al. 
2005; Engler 2006). 

A microgrid control was introduced and implemented in (Lasseter 2002; Robert Lasseter 
and Piagi 2006; Lasseter 2007; Piagi and Lasseter June 2006), the microgrid has two critical 
components, the static switch and the micro-source. The static switch has the ability to 
autonomously island the microgrid from disturbances such as faults or power quality 
events. After islanding, the reconnection of the microgrid is achieved autonomously after 
the tripping event is no longer present. This synchronization is achieved by using the 
frequency difference between the islanded microgrid and the utility grid insuring a transient 
free operation without having to match frequency and phase angles at the connection point. 
Each micro-source can seamlessly balance the power on the islanded microgrid using a 
power vs. frequency droop controller. This frequency droop also insures that the microgrid 
frequency is different from the grid to facilitate reconnection to the utility. The introduced 
micro-source control is shown in Fig. 10. 

















tree 






Inverter 




Q 
Calculation 




Low-Pass 
Filter 


Q 


Q versus E 
Droop 




































Eo 








Magnitude 
Calculation 


















' 


V 


Gate Pulse 
Generator 




Load Voltage 




Low- Pass 
Filter 


E 


Voltage Control 


To Inverter 
Gates 






















































§v 








P 
Clculation 




Low- Pass 
Filter 


P 


P versus 
Frequency Droop 








Inverter or 












Line Current 


^ 
















i 
Po 


{ 


i 


CO 


] 



Fig. 10. Inverter control scheme proposed in (Lasseter 2002; Robert Lasseter and Piagi 2006; 
Lasseter 2007; Piagi and Lasseter June 2006). 

The authors of (Ritwik Majumder , Arindam Ghosh et al. 2007) present a scheme for 
controlling parallel connected inverters using droop sharing method in a standalone ac 
system. The scheme proposed a PI regulator to determine the set points for generator angle 
and flux. The dynamic response of the system is investigated under different impedance 
load conditions especially motor loads. Paper (Maria Brucoli and Green 2006) analyzes the 
fault behaviour of four wire paralleled inverters (in droop mode) based on their control 
methodology. 



b. Opposite Frequency/Voltage Droop Control 

In (Karlsson, Bjornstedt et al. 2005; Guerrero, Berbel et al. 2006) the method selected here is 
to modify the droop functions of the source converters so that the regular droop functions 
are used in the steady-state case and opposite droops are used in transients, see Fig. 11. Note 
that here co re f = co n and v re f = V n . The steady-state droop functions are according to: 



Energy Management 



215 



-K a (co„ f -o)) 



-KA^f-v,) 



(1) 
(2) 



where ps* and c\s* are the active and reactive power references (index s denotes source 
converter, e.g. unit 1). K is the droop gain (slope). For the transient droop functions 
according to: 



Ps = K v( V ref- V g) 



where gw= cd* and v re f= v 



(3) 
(4) 




Fig. 11. Conventional droop functions (left) and transient droop functions (right) (Karlsson, 
Bjornstedt et al. 2005; Guerrero, Berbel et al. 2006). 

In this method the load-sharing is acceptable for the investigated, highly resistive, network. 
Still, in the case of line inductance in the same order of magnitude as the converter output 
filter inductance there can be a considerable degradation of power quality in terms of 
voltage disturbance. The origin of this degradation is the LC-circuit formed by the line 
inductance and the converter AC side capacitors. Furthermore, using this approach it is not 
possible to connect with the high level voltage which is using the regular conventional 
droop functions. In (Guerrero J.M, Garcia de Vicuna et al. 2003; Guerrero, Vicuna et al. 2004; 
Guerrero, Berbel et al. 2006; Guerrero 2006; Guerrero 2005) the authors focus on the transient 
behaviour of parallel connected UPS inverters, they claim that damping and oscillatory 
phenomena of phase shift difference between the paralleled inverters could cause 
instabilities, and a large transient circulating current that can overload and damage the 
paralleled inverters. To overcome this they proposed using a method called " droop/ boost" 
control scheme which adds integral-derivative terms to the droop function. This can be seen 
in Fig. 12. Stable steady-state frequency and phase and a good dynamic response are 
obtained. Further, virtual output impedance is proposed in order to reduce the line 
impedance impact and to properly share nonlinear loads, this is done using a high pass 
filter, the filter gain and pole values of this must be carefully chosen. Furthermore, the test 
results shown are considering a short resistive line, but the method is not taking into 
consideration what happens if the distance between the inverters is considerable, which is 
normally the case in distributed generation were an inductive impedance component 
appears. Nevertheless, when an inverter is connected suddenly to the common AC bus, a 



216 



Energy Management 



current peak appears due to the initial phase error (Guerrero 2006). Compatibility problems 
are expected because of the opposite droop scheme (if synch generator will be included). 
The characteristic and the scheme are shown below: 



dP 

E = E* -nP - rij — 
d dt 

co = co* —mQ - m d 

dt 



(5) 
(6) 



E=E*-nP 



AE 



-► P 



w 
A 



Aw 




Fig. 12. Static droop/boost characteristics for resistive output impedance (Guerrero J.M, 
Garcia de Vicuna et al. 2003; Guerrero, Vicuna et al. 2004; Guerrero, Berbel et al. 2006; 
Guerrero 2006; Guerrero 2005). 



Where P is active power, Q is reactive power, E is output voltage, CO is angular frequency 
and m and n are the droop coefficients for the frequency and amplitude, respectively. As an 
addition in (Guerrero 2006) a soft-start is included to avoid the initial current peak as well as 
a bank of band pass filters in order to share the significant output-current harmonics. In 
more recent papers (Guerrero, Berbel et al. 2007; Josep M. Guerrero, Juan C. Vasquez et al. 
2007) the authors use the conventional droop equations for a microgrid too. 



E = E*-n{Q-Q*) 
co = co* -m(P - P*) 



(7) 
(8) 



c. Droop Control in Combination with Other Methods 

In (Brabandere, Bolsens et al. 2004; K. De Brabandere, A. Woyte et al. 2004; De Brabandere, 
Vanthournout et al. 2007; Brabandere October, 2006) each inverter supplies a current that is 
the result of the voltage difference between a reference AC voltage source and the grid 
voltage across a virtual impedance with real and/ or imaginary parts. This is shown in Fig. 
13. The reference AC voltage source is synchronized with the grid, with a phase shift, 
depending on the difference between nominal and real grid frequency. This method 
behaviour is equal to the normal existing droop control methods except that, short-circuit 
behaviour is better since it is controlling the active and reactive currents and not the power. 
It behaves also better in case of a non-negligible line resistance. 



Energy Management 



217 




Fig. 13. Overall scheme for the proposed droop control method (Brabandere, Bolsens et al. 
2004; K. De Brabandere, A. Woyte et al. 2004; De Brabandere, Vanthournout et al. 2007; 
Brabandere October, 2006). 



In (E. Hoff 2004; T.Skjellnes, A.Skjellnes et al. 2002) novel fast control loops that adjust the 
output impedance of the closed-loop inverters is used in order to ensure resistive behaviour 
with the purpose to share the harmonic current content properly. In the measurements part 
a notch filter is added to remove the unwanted harmonics, it seems that without this filter 
the voltage regulator will not work efficiently. Furthermore, the control is done in the afi- 
coordinates using a discrete controller. 

The author of (Mihalache 2003) discusses the problem of inverters with very low output 
impedance (such as those employing resonant controllers) directly connected in parallel 
through a near zero impedance cable. Low total harmonic distortion (THD) content and 
good current sharing are simultaneously obtained by controlling the load angle through an 
least mean square estimator and by synthesizing a variable inductance in series with the 
output impedance of the inverter, while the harmonic current sharing is achieved by 
controlling the gain of the resonant controllers at the selected frequencies. 

The authors of (Ernane Antonio Alves Coelho, Cortizo et al. 2000; Ernane Antonio Alves 
Coelho, Porfirio Cabaleiro Cortizo et al. 2002) introduced fast control loops that adjust the 
output impedance of the closed-loop inverters in order to ensure inductive behaviour with 
the purpose to share the harmonic current content properly. The paper presents a small- 
signal analysis for parallel-connected inverters in stand-alone AC power systems. The 
control approaches have an inherent trade-off between voltage regulation and power 
sharing (Guerrero, Berbel et al. 2006). 

The signal injection technique proposed by (A. Tuladhar 1998; Tuladhar 2000) is not 
dependent in the plant parameters and can share reactive power even if the VSCs have not 
perfectly matched output inductors by having each VSC inject a non-60-Hz signal and use it 
as a means of sharing a common load with other VSCs on the network. However, the 
circuitry required to measure the small real power output variations due to the injected 
signal adds to the complexity of the control (C.K. Sao). Moreover, the controllers use an 
algorithm which is too complicated to calculate the current harmonic content, the harmonic 
current sharing is achieved at the expense of reducing the stability of the system (Guerrero 
J.M, Garcia de Vicuna et al. 2003). 



218 



Energy Management 




$-»- 



Fig. 14. Schematic diagram of implementing the signal injection technique (Tuladhar 2000). 

In (Marwali, Jung et al. 2004) the proposed control method uses low-bandwidth data 
communication signals between each generation system in addition to the locally 
measurable feedback signals. The focus is on systems of distributed resources that can 
switch from grid connection to island operation without causing problems for critical loads. 
This is achieved by combining two control methods: droop control method and average 
power control method. In this method, the sharing of real and reactive powers between each 
DGS is implemented by two independent control variables: power angle and inverter output 
voltage amplitude. However, adding external communication can be considered as a 
drawback. Such communications increase the complexity and reduce the reliability, since 
the power balance and the system stability rely on these signals (Guerrero, Berbel et al. 
2006). In (Glauser, Keller et al. 2000; Chen, Kang et al. 2004) a communication bus is used in 
addition to the conventional droop, it has to trigger all inverters to measure their load 
sharing parameters at the same line period, this is used to correct the load sharing 
calculation. 



4.4 Discussion 

The master/ slave control configuration has many good characteristics. The inverters do not 
need a PLL circuit for synchronisation and give a good load sharing. The line impedance of 
the interconnecting lines does not affect the load sharing and the system is also easily 
expandable. There are, however, a few serious disadvantages. One of the major 
disadvantages is that most of these systems are not truly redundant, and have a single point 
of failure, the master unit. Another disadvantage of this configuration is that the stability of 
the system depends upon the number of slave units in the system (Tuladhar 2000). 
Furthermore, all these master/ slave techniques, need communication and control 
interconnections, so they are less reliable for a distributed power supply system. 



Energy Management 



219 



The current/ power deviation (sharing) control techniques have excellent features. It has a 
very good load sharing, transient response and can reduce circulating currents between the 
inverters. There are as well some drawbacks. It is not easily expandable due to the need for 
measuring the load current and the need to know the number of inverters in the system. The 
needed interconnection makes the system less reliable and not truly redundant and 
distributed. 

Droop control methods are based on local measurements of the network state variables 
which makes them truly distributed and give them an absolute redundancy as they do not 
depend on cables/ communication for reliable operation. It has many desirable features such 
as expandability, modularity flexibility and redundancy. Nevertheless, the droop control 
concept has some limitations including frequency and amplitude deviations, slow transient 
response and possibility of circulating current among inverters due to wire impedance 
mismatches between inverter output and load bus and/ or voltage/ current sensor 
measurement error mismatches. 

Each of these control techniques has its own characteristics, objectives, limits and appropriate 
uses. That often makes it difficult to adapt one control scheme for all applications. However, a 
deep understanding of these control techniques will help in enhancing them and though will 
improve the design and implementation of future distributed modular grid architectures. 

5. The Proposed Smart Grid Philosophy 

A general philosophy to supply electric energy in isolated power systems through power 
electronic inverters is introduced in (Omari 2005) and is extended here. The basic system 
philosophy is illustrated through Fig. 15. The power produced by the ECS is fed through the 
DC-to-DC converter and after that this DC power is fed to the grid through the inverter. The 
inverter produces an AC output of a specific voltage magnitude and frequency. The 
intermediate capacitance is used to decouple the DC current flowing to the input terminal of 
the grid-inverter from the DC current flowing from the DC-to-DC converters of the ECS 
side. 

Intermediate DC Stage 



DC-to-DC; 
Converter! 




i 



V c 



Inverter 




Fig. 15. System overview of the intermediate DC stage. 



The mismatches between these two currents result in variations in the voltage across the 
intermediate capacitance caused by changes in the capacitor's current. This can be expressed 
using the following equation: 



220 



Energy Management 



jl c dt + V Ct0 : 



& 



,)dt + V Q0 



(9) 



Where the voltage across the intermediate capacitance is Vc, the output current of the 
DC/ DC converter is Idc and the input current to the inverter is Iinv- 

These voltage variations can be utilised to control the power flow. The size of the capacitor 
is determined depending on the maximum possible mismatches between power production 
and power consumption. The voltage variations across the capacitor should be kept within 
the allowable ranges. 

This intermediate DC stage has two important characteristics. First, it provides a decoupling 
between the voltages across the terminals of the ECSs from one side and the grid voltage 
from the other side. Second, it provides a decoupling between the frequency of the ECSs (in 
the case of AC energy conversion systems) from one side and the grid frequency from the 
other side. In this philosophy the power flow from an energy conversion source (ECS) into 
the grid may be driven by the grid or by the ECS itself as summarised in Fig. 16. 



Feeding Modes at Grid-Side 



Grid-Driven Feeding 



Grid-Forming <■ 



ECS-Driven Feeding 



> Grid-Supporting 



Symmetrical 
Grid-Forming 



Asymmetrical 
Grid-Forming 



Grid-Parallel 



Symmetrical 
Grid-Supporting 



Asymmetrical 
Grid-Supporting 



Symmetrical 
Grid-Parallel 



Asymmetrical 



Fig. 16. A general definition of feeding modes for DER. 



In a grid-driven feeding mode the flow of power from the ECS to the grid is controlled 
according to the requirements of the grid while in an ECS-driven feeding mode, the flow of 
power is controlled according to the requirements of the ECS itself. In the second case, ECSs 
are normally controlled to maximise their power production despite the requirements of the 
grid. The grid-driven feeding mode represents the active integration case while the ECSs- 
driven feeding mode represents the passive one. A grid-driven feeding mode may be 
realised through two different cases: grid-forming case and grid-supporting case, while an 
ECS-driven feeding mode may be realised through a grid-parallel case. 

An ECS in a grid-forming case is responsible for establishing the voltage and the frequency 
of the grid (state variables) and maintaining them (Omari 2005). This is done by increasing 
or decreasing its power production in order to keep the power balance in the electrical 
system. 

An ECS in a grid-supporting case produces predefined amounts of power which are 
normally specified by a management unit. Therefore, the power production in such a case is 



Energy Management 



221 



not a function of the power imbalances in the grid. Nevertheless, the predefined amounts of 
power for these units may be adjusted. The management system may change the reference 
values according to the system's requirements and the units' own qualifications. The control 
strategy of the intermediate DC circuit is derived from the feeding modes definition. 
Therefore, in the grid-driven feeding mode the voltage across the capacitor is kept within 
the allowable ranges through controlling Idc current while keeping Iinv free to change, see 
Fig. 17. 



DC-to-DC 
Converter 



Inverter 




Controller V REF 



Values 



Fig. 17. General control of a system operating in a grid-driven feeding mode (Forming, 
Supporting). 

An ECS in a grid-parallel case is a power production unit that is not controlled according to 
the requirements of the electrical system. RES's such as wind energy converters and 
photovoltaic systems may be used to feed their maximum power into the grid (standard 
applications in conventional grids). In such a case, these systems are considered as grid 
parallel units. For the ECSs-driven feeding mode control strategy the vice versa applies, Iinv 
is controlled and Idc is free to change, see Fig. 18. 



DC-to-DC 
Converter 




VcON . I c , 



'DC 



h: 



Inverter 



PI 
Controller 



E 



SVM 



<P 



CU 

YT 

Reference 
Values 



L I 




Fig. 18. General control of a system operating in ECSs-driven feeding mode (parallel). 



222 



Energy Management 



5.1 Inverter Topologies 

To articulate the control strategies in relation to power electronic devices a short 
introduction of the different used three-phase inverter topologies is given. 

a) Three-phase, Three-leg Voltage Source Inverters 
Three single-phase half-bridge inverters can be connected in parallel to form the three phase 
inverter configuration, one leg for each phase, see Fig. 19. The gating signals of single-phase 
inverters should be advanced or delayed by 120 degree with respect to each other in order to 
obtain three-phase balanced voltages (Rashid 1995). In this case it requires that the three currents 
are a balanced three-phase set. However, this topology can be used to feed balanced loads only. 




Fig. 19. Three leg inverter (balanced output). 

Two configurations able to generate three-phase asymmetrical signals will be discussed. 
These are: The three-leg neutral point built by capacitors and the four-leg inverter with a 
controlled neutral point by the fourth leg. 

b) Three-phase, Three-leg, Four-wire Voltage Source Inverters 
Three-phase inverters with neutral point are an evolution from the single-phase ones. Three 
half-bridge single-phase inverters joined together can be seen as a three-phase neutral point 
inverter, see Fig. 20, where each output feeds one phase. This topology can be used to feed 
balanced or unbalanced loads. In case of unbalanced loads, the sum of the output currents i a , 
ib, and i c will not be zero and the neutral current will flow in the connection between the 
neutral point and the mid-point of the capacitive divider (G. Seguier and Labrique 1993; 
Said El-Barbari and Hofmann 2000; Omari 2005). To maintain a symmetrical voltage across 
the two capacitors an adequate power electronic and a voltage stage management are 
needed, this will not be taken further into discussion. 












b 


Vab 




— | Load | — -, 




V b c 


1 , ■ 








-| Load | — 1 


C a 


c b 


.1 


L 




N 



Fig. 20. Three-leg inverter with a neutral point. 



Energy Management 



223 



c) Three-phase, Four-leg Voltage Source Inverters 
The general power electronic topology of the four-legged inverter is shown in Fig. 21. The 
goal of the three-phase four-leg inverter is to supply a desired sinusoidal output voltage 
waveform to the load for all load conditions and transients. By tying the load neutral point 
to the mid-point of the fourth leg, it can handle the neutral current caused by an unbalanced 
load. A balanced output voltage can be achieved due to the tightly regulated neutral point. 
The additional neutral inductor L n is optional. It can reduce switching frequency ripple 
(Zhang 1998). A four leg inverter can produce sixteen switching states. This enlarges the 
space vector modulation to three-dimensional (3-D-SVM), for a four-leg voltage source 
inverter the representation of the phase voltage space vectors is done in the a,(3,y space. 
Compared with the four-leg inverter, the three-leg four-wire inverter has a lower number of 
semiconductor switches and the control function can be built like three individual single line 
inverters. However, the four-leg inverter still has the advantages of higher utilization of the 
DC link voltage. This is because the maximum available peak value of the line-to-neutral 
output voltage in the three-leg four-wire inverter is equal to half the value of the dc link 
voltage while the maximum amplitude of the line-to-line voltage with a four-leg inverter is 
equal to the dc bus voltage. Moreover, the high unbalanced current flowing through the dc 
link capacitors of the three-leg four-wire inverter requires higher capacitance (Zhang, 
Boroyevich et al. 1997; Maria Brucoli and Green 2006). So, the four-leg inverter has small DC 
link capacitor as no zero sequence current flow across the DC link capacitor and has an 
additional degree of freedom due to the fourth leg (Said El-Barbari and Hofmann 2000; E. 
Ortjohann 2006; E.Ortjohann, A.Mohd et al. 2006). 



+ 




Q 


J 


1 


1 


i 


Q J 


l 


°X I 






'{ 


V 


r 


\ 


r 


Y 


r 


y 


J, 


v. 





























Q 


r 


n 


a r 


h 


Q r 


h 


°J7 








•i 


a 


i* 


%) 


A D « 


<£) 


i- 


%) £< 


- 








T 


i 


T 


i 


T 


T T 















- | Load 



1—m — ► 1 Load 

"1 



Fig. 21. Four-leg inverter. 

In general, three-leg inverter will use the two-dimensional space vector modulation (2-D- 
SVM). On the other hand, the three-leg inverter with neutral point and the four leg inverter 
will extend the space vector modulation to three-dimensional (3-D-SVM) making the 
selection of the modulation vectors more complex. The 3-D-SVM of three-leg with neutral 
point inverter differ from that of the four leg inverter. Nevertheless, the control strategies 
are similar. Both the control strategies and the SVM algorithms will be discussed in detail in 
the following sections. 



5.2 Inverter Control 

In the following sections, the known control strategies of symmetrical inverters will be 
briefly reviewed; Further details can be found in (Omari 2005). Afterwards, the proposed 
control strategies for the asymmetrical inverters will be introduced, these were published in 
papers (Egon Ortjohann, Mohd et al. 2006; E.Ortjohann, A.Mohd et al. 2006). 



224 



Energy Management 



5.2.1 Symmetrical Grid Forming 

The control strategy of a three-phase inverter in grid forming mode for balanced load is 
shown in Fig. 22. The inverter in this case determines the voltage and the frequency of the 
grid. There is one inner current control loop and a second voltage control loop. Both loops 
use only the d-component. The q-component of the current cannot be influenced since the 
reactive part is depending on the load condition. Therefore, the q-component is not 
considered in this case. The reference angle for the dq-transformation is taken from the 
reference frequency. 



"X 



it 



ap 



'tt 










L L Rl 



vei 



aB, 



V +V re 



Jg^EV -^y^^^v 



Fig. 22. Inverter in grid forming mode for balanced loads. 



5.2.2 Symmetrical Grid Supporting 



Fig. 23. P, Q-contr oiled inverter in grid supporting mode for balanced loads. 




The grid supporting unit for balanced loads feeds the grid with a specified amount of 
power, which might be active, reactive, or a combination of both, see Fig. 23. The control 



Energy Management 



225 



strategy for the grid supporting unit using active and reactive power has four controllers, 
two for the current (id and iq), and two for the power (P and Q). Active power, P, is 
controlled by the real part of the grid current "id" , while reactive power, Q, is controlled by 
the imaginary part "i q ". Synchronization is implemented by the generation of the angle for 
the dq transformation from the voltage on the grid. Other control strategies for the grid 
supporting mode can be implemented straight forward through controlling the real and the 
imaginary components of the grid current or the magnitude of the voltage and the active 
component of the power fed into the grid. 

5.2.3 Symmetrical Grid Parallel 

In the case of grid-parallel feeding mode, see Fig. 24, all of the produced active power by the 
ECS is passed to the grid through the inverter. The active power management is done in this 
application by the control of the voltage of the DC stage. The reactive power control is 
similar to the grid supporting case. 




Fig. 24. Q-controlled inverter in grid parallel mode. 



5.2.4 Asymmetrical Grid Forming 

As a grid forming unit the inverter has to provide both the voltage and the frequency of the 
grid. This is done as following: The voltage and the current sensed values are transformed 
from the abc-frame to the positive-negative-zero dq sequence components. The controller 
block comprises current and voltage PI controllers for each component. Six controllers are 
needed for the voltage and the current components of the load. For the controller only the d- 
component of the positive sequence V p _d_ re f is considered. The other reference values are set 
to zero since the inverter has to supply symmetrical three phase voltage. The output 
reference values from the control unit are transformed to the apy-space and the SVM block 
uses them to calculate the pulse pattern for the switches (Egon Ortjohann, Mohd et al. 2006). 
Fig. 25 shows an inverter in grid forming mode for unbalanced loads. The control functions 
can be also described as vectors according to the following definition: 



226 



Energy Management 



w t 



pnO _ dq _ ref 



] = 



\ v " 


_d 


_ref 


K 


_#_ 


ref 


v n 


J . 


_ref 


v„ 


_9_ 


ref 


V o_ 


J . 


.ref 


A 


.?_ 


ref 



w,_ 



pnO dq J 



\y pnO dq _actJ 



\ ¥p 


_d 


_ act 


V P 


_?. 


act 


v n 


_^_ 


_ act 


v n 


.?_ 


act 


V o. 


A . 


act 


Jo. 


A. 


act 



\f» 



\I, 


-d 


_ act 


h 


_q 


_ act 


I n 


-d. 


_ act 


I n 


.q - 


act 


h_ 


-d. 


_ act 


Jo. 


.?_ 


act 



(10) 



(11) 




Fig. 25. Inverter in grid forming mode for unbalanced loads. 



5.2.5 Asymmetrical Grid Supporting 

The asymmetrical grid supporting unit has to supply the grid with a specified amount of 
power, which might be active, reactive, or a combination of both as mentioned before. 
Synchronisation with the grid voltage is done by the voltage reference angle which has to be 
generated as in the symmetrical grid supporting mode. The desired amount of power has to 
be set by a management unit in positive, negative and zero sequence components. The 



Energy Management 



227 



power controller block generates a reference signal for the current controller. The current 
controller is delivering a reference voltage signal represented by positive, negative and zero 
sequence components. These reference values have to be transformed (composed) to the 
apy-space vector and the SVM block uses them to calculate the pulse pattern for the switches 
(Egon Ortjohann, Mohd et al. 2006). Fig. 26 shows a P, Q-controlled Inverter in grid 
supporting mode for unbalanced loads, the control functions can be also described as 
vectors according to the following definition: 



IP, 



pnO _ref J 



~ p ,. 


_ref 


p„_ 


ref 


A 


ref 



[Q, 



■pnO _ref J 



A 


_ref 


Qn_ 


ref 


A 


ref 



(12) 



[P,: 



pnO _ act J 



~ p , 


act 


p„ 


act 


p°- 


act 



\Q, 



pnO act J 



Q,. 


act 


Qn_ 


act 


a_ 


act 



(13) 



[/ 



pnO _d act-i 



p _d _ act 



V, 



pnOqact-l 



~h 


_9 


act 


I n 


_4_ 


act 


Jo. 


Jl _ 


act 



(14) 



V^ pnO d\~ 



p_d 



\y pnO q\~ 



0_q 



(15) 



Other control strategies can be implemented simply through the real and the imaginary 
components of the grid current or the magnitude of the voltage and the active component of 
the power fed into the grid. 



228 



Energy Management 



jk 



trn— i 



^ 



pt@f 



t= 



^ 



p£@5 



Fig. 26. P, Q-controlled Inverter in grid supporting mode for unbalanced loads. 

5.2.6 Asymmetrical Grid Parallel 

Obviously, in the case of asymmetrical grid-parallel unit, shown in Fig. 27, the values that 
can be controlled are the flow of the reactive power or reactive current to the grid. In 
comparison to the asymmetrical grid supporting remarkable is the active power control 
using Vdc and: 



\-*nQ ref\ ~ 



n _ref 



L 0_ref 



\-*n0 act\ 



(16) 




[P„0_act] 



Fig. 27. Inverter in grid parallel mode for unbalanced loads. 



Energy Management 



229 



This section presented the system components developed for the smart grid. Including the 
general feeding architecture was presented and discussed. Then it presents the main power 
electronic element of the philosophy, the inverter, showing the different topologies used. 
Finally, the operating principles and control techniques for these inverters were presented. 
This included novel standardized advanced control concept for four-wire inverters (three- 
leg four-wire and four-leg) using symmetrical components based on sequence 
decomposition to supply balanced/ unbalanced loads. The principle idea is to control the 
positive, negative and zero sequence components. Controlling (eliminating) the negative 
and zero sequence components helps expanding the inverter based systems by increasing 
the distribution network efficiency (consequently leads to less losses and results in 
enhancing the power quality). This can be used for shunt active filters' applications and also 
grant the opportunity to supply unbalanced loads which mean supplying single and three 
phase loads using the same source. 

6. The Proposed Smart Grid philosophy "Operation, control, 
and management" 

In the previous section, the principles of the proposed smart grid philosophy and its 
components have been introduced. In this chapter, the operation, control, application and 
management of this philosophy are going to be presented. 

Even though, most of the current approaches to build future smart power systems are trying 
to introduce one-size-fits-all solution but the fact is that each system (customer) needs are 
different and various approaches are needed to fit their exact specifications. This chapter 
will introduce varied opportunities of control functions for three-phase inverters used to 
feed passive/ active grids including different topologies to feed balanced/ unbalanced loads. 





Sil HH 



m^'P 




5i7S3-@ x ' 



(■— i 

1 T r " K 



I 



Supervisory Control and Droop Control Isochronous Control 

Energy Management 



Fig. 28. The control philosophy (example). 



230 



Energy Management 



The proposed philosophy will develop different and various robust control approaches for a 
realistic distributed power system with power electronics inverters as front-end, see Fig. 28. 
These control strategies should guarantee real modularity, higher reliability and avoid a 
single point of failure to qualify to be standardised. The proposed control architecture 
should maintain three phase voltages and frequency in the grid within certain defined limits 
and has to provide power sharing between the units according to their ratings and user 
settings. 

The electrical energy produced by ECSs may be fed into the electrical grid according to one 
of two possible feeding modes. In the first mode, the amount of electrical energy fed into the 
grid is specified according to the grid requirements. This mode is denoted as a " Grid-driven 
feeding mode". In the second mode, the ECSs specify the amount of energy fed into the 
grid. This mode is denoted as an "ECSs-driven feeding mode". Fig. 29 presents a diagram 
showing the structure of the control functions proposed in this research study. These control 
strategies will be launched in this chapter. 

The system philosophy under discussion is also characterised by an intermediate DC stage 
between the energy sources from one side and the electrical grid from the other side. From 
the DC-DC converters' side, it connects to the ECSs and from the main inverter's side it 
connects to the electrical grid, see chapter three. However, in order to simplify the analysis, 
the ECSs-side (the generation sources such as PV and fuel cells) are represented using a DC 
voltage source. 



Feeding Modes at Grid-Side 



Grid-Driven Feeding 



Grid-Forming 



ECS-Driven Feeding 



Grid-Supporting 



-i 



Isochronous Mode 



-c 



i Isochronous Mode 



T^ 



T^ 



Fig. 29. Feeding modes at the grid side. 



Energy Management 



231 



Based on the modes proposed in Fig. 29. many scenarios can be obtained. The key scenarios 
are taken into account in this research study as shown in Fig. 30. The proposed philosophy 
has two main categories. The first category is the Multi-inverter Three- wire system and the 
second is the Multi-inverter Four-wire system. For each of these categories different control 
scenarios will be proposed and explored. 





















Proposed Scenario 


















Three-wire 
system 






Four-wire 
system 




< 
























Supervisory control and 
energy managment 




Supervisory control and 
energy managment 
















Droop control 




Droop control 
















Isochronous control 




Isochronous control 
















Droop/Isochronous 
control 




Droop/Isochronous 
control 
















Swing inverter/droop 
control 




Swing inverter/droop 
control 

























Fig. 30. The proposed scenarios. 

6.1 Multi-inverter Three-wire System Control Philosophy 

Since the inverters are relatively stiff sources, with unique value of open circuit frequency 
and voltage (due to components tolerance), large circulating currents would result if they 
were simply paralleled without additional control. This can be done based on information 
available locally at the inverter (state variables) for example using droops to make the 
system less stiff or using data communication such as in supervisory controlled systems. 
Recently data communication between units became easy realized by the rapid advances in 
the field of communication. However, it is preferred that communication of information will 
be used to enhance system performance but must not be critical for system operation. The 
following sections will introduce modular approaches to parallel inverters using different 
methodologies. 



6.1.1 Supervisory Control and Energy Management Scenario 

The specific aim of this concept is to develop a standardised control strategy for a realistic 
distributed power system with power electronics inverters as front-end. The proposed 
control architecture will maintain the three phase voltages and frequencies in the grid 
precisely and will provide power sharing between the units according to their ratings, 
meteorological parameters, economical dispatch prospective (can include real-time pricing) 
and user settings. This allows total energy optimization. The designed system can include 
inverter units of different power rating, distributed at various locations feeding distributed 



232 



Energy Management 



unequal loads taking into account dissimilar line impedances between them to insure true 
expandability and generation placement flexibility. This means that the types, sizes, and 
numbers of the inverters, and the size and nature of the electrical loads may all vary without 
the need to alter the control strategy. The amount of data exchange can be small if it 
includes only basic measurements and set points but will increase proportionally as more 
functions are added. The proposed structure is shown in Fig. 31. It is worthy to note that the 
source do not have to be a single ECS and could be a hybrid power system (HPS). 

The supervisory control is responsible for units dispatching, load management, and power 
optimization. It can include also many functions like meteorological forecasting and 
demand side management as illustrated in (Osama Omari, Egon Ortjohann et al. 2007). It 
can also manage an intelligent switch or a feeder to the main grid or to other mini-grids. The 
current and voltage control are done locally at the inverters according to the definition 
introduced in chapter three. Moreover, the proposed control can be implemented not only in 
distribution system of isolated grid systems, but also in the interconnected power systems 
(some times called on-grid micro-grid). 



Meteorological Forecasting 
User Settings 




Fig. 31. Overview of supervisory control and energy management proposed system structure. 



The control functions of the inverters are shown in Fig. 32 As mentioned in section 5, each 
grid mode has its own character for controlling the inverter. The grid forming contains inner 
current control loop and outer voltage control loop. The reference voltage is given to control 
the voltage of the system. The angular speed related to the frequency of the system is also 
set as constant (2nf). The control loop produce the voltage of d-axis which will be 
transformed to ap frame, the angle is required for that. These voltages in cr.p frame are 
supplied to the SVM to calculate the switching sequence and periods. In the next step the 
inverter supplies the three-phase currents to the system through the LC filter. The output 
currents will be measured to feed the signal to the inner current loop. The voltages across 
the capacitor are also measured to feed the outer control loop. 



Energy Management 



233 



o 
O 



& 
cs3 



n 



O 0) 

1*3 




Load 2 



Fig. 32. Supervisory control and energy management scenario. 



As stated previously, the responsibility of the grid supporting mode is to maintain the 
system power balance. The reference power of the grid supporting inverter is calculated in 
the supervisory unit based on other inverters in the system (grid forming and parallel 
modes) and loads. Moreover, it depends also on the pre-setting percentages or algorithms 
used in the supervisory control to manage the power balance. The reference values of Pgs 
and Qgs are calculated based on that. In the simplest case, the set values can be adjusted by 
the percentage value (GS pe rcent) and the active power load (Pioad) and reactive power load 
(Qioad)- As a simple example, the set values of active and reactive power can be calculated via 
equations 17 and 18 respectively: 



234 Energy Management 

I / Pload. — / . . PgP. I X GS percent 

P GS r , f = \±^ ' ~g ^ — (17) 

100 

_ (Z.'li Q had i - Z>i jH ) x g&^» (18) 

Where, } Pload . and /^ . Qload i are the summation of the active and reactive power 
of load in the system, where, n is the number of loads and i is the counter. /^ . j gp. and 

/ , . ^G/ 5 are the summation of the active and reactive power of grid parallel units in the 

system, where, m is the number of grid parallel units and; is the counter. 
This means that the amount of power needed is deducted from the power of the grid 
parallel units since they cannot be influenced by the grid, the rest is shared between the grid 
forming and supporting according to the percentage GS percen t. This percentage can be 
calculated according to an algorithm based on the units' ratings, meteorological parameters, 
economical dispatch prospective and user settings but this will not be taken into discussion 
over here since its out of the scope of this study. This was demonstrated in (Osama Omari, 
Egon Ortjohann et al. 2007). 

After the actual active and reactive power of the grid supporting mode is passed to the outer 
loop of the controllers, another inner current control loop is used. The current of d-axis is 
used to control the active power signal and the current of q-axis is used to control the 
reactive power signal. 

The grid parallel mode is used to produce maximum amount of active power and can 
sometimes supply certain amount of reactive power to the system. In the voltage control 
loop, there are two reference inputs, voltage reference and reactive power reference. There 
are three inputs measured to calculate the new reference for U and I q controllers. These are 
first, the DC intermediate stage which will be passed through the voltage controller to feed 
into the inner current loop for Id controller; based on that the new reference of the voltage is 
established. The second input, is the three-phase voltage measured from the line. The three- 
phase voltage is transformed into dq-fmme and the angle of the voltage can be measured 
from voltage of ^-axis (V q ). The voltage magnitude is fed to the I q controller which is 
compared to the reactive set value to get the new reference value for I q controller. Third, the 
actual output current values measured are used by Id and I q controllers of the inner control 
loop. The current signals are transformed into ^-frame. After the controlled signals passed 
through the Id and I q controllers, both signals are added with the actual values of the voltage 
in dq-fmme and then transformed into af3 frame to control the inverter's output. 

It should be also noticed that as a grid parallel unit, if the system frequency is rising too high 
the inverter's output should be reduced or set to zero (disconnected). 



Energy Management 



235 



The following simulation case study is carried using MATLAB/Simulink to validate the 
proposed inverter supervisory control approach. The supervisory control is responsible for 
units dispatching, load management, and power optimization. However, the current and 
voltage control are done locally at the inverters according to the definition introduced 
before. The proposed control can be implemented in isolated grid as well as in 
interconnected power systems. In this case study there are three inverters operating in grid 
forming mode, grid supporting mode and grid parallel mode respectively. They are 
connected in parallel to supply two loads including steps as shown in Fig. 33. 

The first load step is at t=l second and the second load step is at t=1.5 second. At t=2 
seconds, the active power of the grid parallel unit is stepped up from 14 kW to 21 kW. The 
frequency response of the system is shown in Fig. 34. At t=l second, when the load is 
increased the frequency will drop. In the other hand at t=1.5 second, the load is decreased 
and then the frequency will rise. At t=2 second, the grid parallel gives more power to the 
system. As a response and to keep the frequency constant, the grid forming and supporting 
inverters will supply less power to the system. 



Fig. 35 shows the active power response of the inverters and loads from 0.5 second to 2.5 
seconds. At the first step (t=l second), active power of load one is increased as shown in Fig. 
35. Consequently, the active power of grid forming and grid supporting inverters are 
increased to balance with the increased load. The grid supporting takes 30 percent of the 
load as pre-set (This is the result based on the optimization algorithm). The active power of 
the grid parallel unit supplied to the system is the same. At second step (t=1.5 second), the 
active power of load two is decreased. The active power of the grid forming and grid 
supporting inverters are decreased, while the active power of the grid parallel inverter is 
still the same. At last step (2 second), the grid parallel is set to give more active power to the 
system. 



Meteorological Forecasting 



I M I Measurement Unit 




S= 23 T 3 kVA 


S=21.1 kVA 


S= 8.9 kVA 


S= 28.9 kW 


P = 21 kW 


P=19kW 


P = 8kW 


P=26 kW 


Q= 4.7 kvar 


Q= 8.5 kvar 


Q= 3.8 kvar 


Q= 9 kvar 



Fig. 33. Case Study. 



236 



Energy Management 




Fig. 34. The system frequency. 

Therefore, the active power of the grid parallel inverter will increase and as a response both 
active power of grid forming and grid supporting inverters will be signaled to decrease 
since the load is kept constant. The exact values are shown in Table II and confirm the 
system active power balance. 

The reactive power behavior of the inverters is similar to the active power. The difference is 
that the grid parallel inverter is set only to give more active power to the system and is not 
contributing to the reactive power balance. Therefore, it is not affecting the reactive power 
of the grid parallel unit at the last step as shown in Fig. 36; loads are almost the same. The 
exact values are shown in Table 2 and confirm the system reactive power balance. 




I | 30 













Ldadl 




Nk. .., 


*—... , r .. 




Load 2 


/ 




" 




y~ 


1 





















Fig. 35. The active power. 



Time [s] 



Time (s) 


Pload 1 


Pload 2 


£ Pload 


GF 


GS 


GP 


0-1.0 


19 


26 


45 


21.7 


9.3 


14 


1.0-1.5 


40 


26 


66 


36.8 


15.6 


14 


1.5-2.0 


40 


14 


54 


28 


12.5 


14 


2.0 - 2.5 


40 


14 


54 


23.6 


9.9 


21 



Table 1. Active power (kW) 



Energy Management 



237 




^0Mmmwmmn00# 



o _£ 



r 



Fig. 36. The reactive power. 



K. 



L_ 



1.5 
Time [s] 



J****** 



Time (s) 


Qload 1 


Qload 2 


2 Q load 


GF 


GS 


GP 


0-1.0 


8.5 


9 


17.5 


8.4 


3.8 


55 


1.0-1.5 


13.2 


9 


22.2 


11.9 


5.1 


55 


1.5-2.0 


13.2 


5.2 


18.4 


9.3 


3.87 


55 


2.0 - 2.5 


13.2 


5.2 


18.4 


9.3 


3.87 


55 



Table 2. Reactive power (kvar) 



Having a look at Fig. 37 we can see the response of the grid forming inverter to the load 
increase at t=l second. The inverter will hold voltage constant and the current will increase 
to satisfy the load demand. Another example is the responses of the grid supporting inverter 
shown in Fig. 38, when the load decreases, which is the case at t=1.5 seconds. We can see 
that the voltage will stay constant as forced by the grid forming inverter while the supplied 
current will decrease as signaled by the supervisory unit. 

Since the grid parallel unit is not dependent on the load and is not actively dispatchable by 
the grid we can see in Fig. 39 that it does not respond to the load steps in the grid and 
instead of that keeps supplying the same amount of current all the time. This matches the 
definition of grid parallel inverter since it is not actively controlled by the grid. 
Having a look at the load voltage and current response at t=l second when a step happens, 
see Fig. 40, we can see that the voltage is kept constant all the time by the system and is 
restored rapidly in case of any load step. This shows the controller capabilities to supply a 
high power quality. 



238 



Energy Management 






100 




80 


< 


60 


T3 


40 


CO 

o 


20 











r 


-20 


£ 


-40 


O 


-60 



0.9 0.92 0.94 0.96 



0.98 1 1.02 

Time [s] 



Fig. 37. Voltage and current of grid forming at first step. 




100 
„ 80 - 
£ 60 
^ 40 
§ 20 

d 

1 -20 

2 -40 

5 - 60 

-80 

-100 



1.4 1.42 1.44 1.46 1.48 1.5 1.52 1.54 1.56 1.58 1.6 

Time [s] 



Fig. 38. Voltage and current of grid supporting at second step. 



Energy Management 



239 




* \J V vf \y v 



0.9 0.92 0.94 0.96 0.98 1 1.02 1.04 1.06 1.08 1.1 

Time [s] 



Fig. 39. Voltage and current of grid parallel at first step. 



400 


i i 


i 






1 


! 


1 


^ 300 
" 200 


\ m f\f\ 


YWV 




yto 




WW\A 




ra 100 

o 

z! o 

CD 

d) -100 
a -200 










w 




O...UJ 


> -300 


\J\J\j\y\j\fiJ 


wbv 


l/W 


Jvv 1 


VVV;-VV--V 


AA/v 




1 1.02 1.04 1.06 



Time [s] 



Fig. 40. Voltage and current at load one during first step. 



7. Conclusion 

Our present and future power network situation requires extra flexibility in the integration 
of distributed generation more than ever. Mainly for the small and medium energy 
converting systems including intelligent control and advanced power electronics conversion 
systems. 

This research study showed the visibility of various methods of forming an electric power 
supply system by paralleling power electronic inverters. These methods foundation is based 
on the conventional grid control methodologies. This research addressed mainly the control 
issues related to future modular distributed power systems with flexible power electronics 
inverters as front-end. 



240 Energy Management 

This work introduced a variety of standardized modular architectures and techniques for 
distributed intelligence and smart power systems control that can be used to build an 
electric power supply system by paralleling power electronic inverters. It launched different 
and various robust control approaches based on the feeding mode definition for a realistic 
distributed power system with power electronics inverters as front-end. These control 
strategies guarantee real modularity, high reliability and true redundancy. The proposed 
control architectures maintain the three phase voltages and frequencies in the grid within 
certain limits and provide power sharing between the units according to their ratings. 
The research led to an original philosophy for supervisory control and energy management 
of an Inverter-based modular smart grid for distributed generation applications. The 
method developed is based on the feeding modes definition and supports the active 
integration of the inverters (energy converting systems & renewable energy sources). The 
main control tasks (voltage/ frequency control) are done locally at the inverters to guarantee 
modularity and to minimize communication bandwidth requirements. The supervisory 
control is used for dispatching and optimization control. It can also include real time pricing 
and meteorological forecasting. The concept was developed and tested for three-phase, 
three- wire and four- wire systems. 

In this study, the general control functions and the system behaviour have been 
investigated. With this investigation it has been shown that the realisation of smart power 
systems in general through the new system philosophy is possible and advantageous. 

8. References 

GRID 2030 :National Vision for Electricity's Second 100 Years (2003)., United States 

Department of Energy. 
Vision and Strategy for Europe's Electricity Networks of the Future (2006).. E. Commission. 

Luxembourg. 
A. Engler, M. Meinh, et al. (2003). New V/f-Statics controlled Battery Inverter: Sunny Island 

- the key component for AC-Coupled Hybrid Systems and Mini Grids. 2nd 

European PV Hybrid and Mini-Grid Conference Kassel 
A. Engler, M. Meinhardt, et al. (2004). Pure AC-Coupling - The Concept for Simplified 

Design of Scalable PV-Hybrid Systems Using Voltage / Frequency Statics 

Controlled Battery Inverters 14th International Photovoltaic Science and 

Engineering Conference (PVSEC-14), Bangkok. 
A. Engler and N. Soultanis Droop control in LV-Grids. International Conference Future 

Power Systems, Amsterdam, Niederlande. 
A. Tuladhar, H. J., T. Unger, and K. Mauch (1998). Control of parallel inverters in distributed 

ac power systems with consideration of the line impedance effect. APEC 
Brabandere, K. D. (October, 2006). Voltage and frequency droop control in low voltage grids 

by distributed generators with inverter frond-end Departement Elektrotechniek. 

Leuven, Katholieke Universiteit Leuven. 
Brabandere, K. D., B. Bolsens, et al. (2004). A Voltage and Frequency Droop Control Method 

for Parallel Inverters, the 35th IEEE PESC Conference, Aachen, Germany. 
C.-C. Hua, K.-A. L., and J.-R. Lin, Parallel operation of inverters for distributed photovoltaic 

power supply system. IEEE Annual Power Electronics Specialists Conference. 



Energy Management 241 

C.K. Sao, P. W. L. "Autonomous Load Sharing of Voltage Source Converters." EEE 

Transactions on Power Delivery 20(2): 1009-1016. 
Chen, J.-F., C.-L. Chu, et al. (1995). Modular parallel three-phase inverter system. 

Proceedings of the IEEE International Symposium on Industrial Electronics. 
Chen, X., Y. Kang, et al. (2004). Operation, control technique of parallel connected high 

power three-phase inverters. The 4th International Power Electronics and Motion 

Control Conference. 
De Brabandere, K., K. Vanthournout, et al. (2007). Control of Microgrids. IEEE Power 

Engineering Society General Meeting, Tampa,Florida. 
Driesen, J. and R. Belmans (2006). Distributed generation: challenges and possible solutions. 

IEEE 2006 Power Engineering Society General Meeting. 
E. Hoff, T. S., L. Norum (2004). Paralleled Three-phase Inverters. NORPIE '04, Nordic 

Workshop on Power and Industrial Electronics. 
E. Ortjohann, A. M., N. Hamsic, D. Morton , O. Omari (2006). Advanced Control Strategy for 

Three-Phase Grid Inverters with Unbalanced Loads for PV/ Hybrid Power Systems. 

21th European PV Solar Energy Conference, Dresden. 
E.Ortjohann, A.Mohd, et al. ( 2006). Control and Representation of Three-Phase 

Asymmetrical Signals Used by Modular Inverters to Feed Unbalanced Loads in 

Hybrid Power Systems. The Great Wall World Renewable Energy Forum 

(GWREF), Beijing, China. 
Egon Ortjohann, A. Mohd, et al. (2006). Advanced Control Strategy for Three-Phase Grid 

Inverters with Unbalanced Loads for PV/ Hybrid Power Systems. 21th European 

PV Solar Energy Conference, Dresden. 
Energy, X. (2007). "Xcel Energy Smart Grid: A White Paper." Denver Business Journal. 
Engler, A. (2000). Control of Parallel Operating Battery Inverters. Photovoltaic Hybrid 

Power Systems Conference, Aix-en-Provence. 
Engler, A. (2005). "Applicability of droops in low voltage grids." International Journal of 

Distributed Energy Resources 1(1). 
Engler, A. (2006). APPLICABILITY OF DROOPS IN LOW VOLTAGE GRIDS. 3rd European 

PV-Hybrid and Mini-Grid Conference, Aix en Provence, France. 
Ernane Antonio Alves Coelho, Cortizo, et al. (2000). Small Signal Stability for Parallel 

Connected Inverters in Stand-Alone AC Supply Systems. THE IEEE INDUSTRY 

APPLICATIONS CONFERENCE, CONFERENCE RECORD OF THE IEEE 

INDUSTRY APPLICATIONS CONFERENCE. 
Ernane Antonio Alves Coelho, Porfirio Cabaleiro Cortizo, et al. (2002). "Small-signal stability 

for parallel-connected inverters in stand-alone AC supply systems." IEEE Trans on 

Industry applications(38(2):533-542.). 
G. Seguier and F. Labrique (1993). Power Electronic Converters, DC- AC Conversion. 

Heidelberg, Germany, Springer- Verlag. 
Glauser, H.-P., M. Keller, et al. (2000). New inverter module with digital control for parallel 

operation. The Third International Telecommunications Energy Special Conference. 
Guerrero J.M, Garcia de Vicuna, et al. (2003). A Wireless Controller for Parallel Inverters in 

Distributed Online UPS Systems. THE 29TH ANUAL CONFERENCE OF THE 

IEEE INDUSTRIAL ELECTRONICS SOCIETY. 



242 Energy Management 

Guerrero, J. M., N. Berbel, et al. (2007). control of line-interactive UPS connected in parallel 

forming a microgrid. IEEE International Symposium on Industrial Electronics, 

Vigo, Spain. 
Guerrero, J. M., N. d. V. Berbel, et al. (2006). Droop control method for the parallel operation 

of online uninterruptible power systems using resistive output impedance. Applied 

Power Electronics Conference and Exposition, APEC '06. Twenty-First Annual 

IEEE. 
Guerrero, J. M., L. G. d. Vicuna, et al. (2004). "A wireless controller to enhance dynamic 

performance of parallel inverters in distributed generation systems." IEEE 

Trans.Power Electron. 19(5): 1205-1212. 
Guerrero, J. M. B., Nestor Matas, Jose de Vicuna, Luis Garcia Miret, Jaume (2006). 

Decentralized Control for Parallel Operation of Distributed Generation Inverters in 

Microgrids Using Resistive Output Impedance. 32nd Annual Conference on IEEE 

Industrial Electronics, IECON 2006, Paris, France. 
Guerrero, J. M. M., J.; de Vicuna, L.G.; Berbel, N.; Sosa, J. ( 2005). Wireless-control strategy 

for parallel operation of distributed generation inverters. Industrial Electronics, 

2005. ISIE 2005. 
Guerrero, J. M. M., J.; Garcia De Vicunagarcia De Vicuna, L.; Castilla, M.; Miret, J. (2006). 

"Wireless-Control Strategy for Parallel Operation of Distributed-Generation 

Inverters." IEEE Transactions on Industrial Electronics 53(5): 1461 - 1470. 
H.Oshima, Y.Miyazaya, et al. (1991). Parallel redundant UPS with instantaneous PWM 

control. 13th International Telecommunications Energy Conference. 
Hanaoka, H. N., M.; Yanagisawa, M. (2003). Development of a novel parallel redundant 

UPS. The 25th International Telecommunications Energy Conference. 
Hatziagyriou, N. (2008). Microgrids: the key to unlock distributed energy resources. IEEE 

power and enegy 6: 26-29. 
Hauck Matthias , S. H. (2000). "Wechselrichter problemlos parallel betreiben " Elektronik 

H.12/2000: 120-124. 
Holtz, J. and K.-H. Werner (1990). "Multi-inverter UPS system with redundant load sharing 

control." IEEE Transactions on Industrial Electronics Industrial Electronics 37(6): 

506-513. 
Huang, B. (2006). Stability of Distribution Systems with a Large Penetration of Distributed 

Generation. Fakultat fur Elektrotechnik und Informationtechnik. Dortmund, 

University of Dortmund. Dr.-Ing. 
Hyun, K.-H. K. D.-S. (2006). A High Performance DSP Voltage Controller with PWM 

Synchronization for Parallel Operation of UPS Systems. 37th IEEE Power 

Electronics Specialists Conference. 
Ipakchi, A. ( 2007 ). Implementing the Smart Grid: Enterprise Information Integration. Grid- 

Interop Forum, Albuquerque, NM. 
J.A.P.Lopes, C. L. Moreira, et al. (2006). "Defining control strategies for MicroGrids islanded 

operation." IEEE Transactions on Power Systems 21(2): 916 - 924. 
Jiann-Fuh Chen and C.-L. Chu (1995). "Combination voltage-controlled and current- 
controlled PWM invertersfor UPS parallel operation." IEEE Transactions on Power 

Electronics 10(5): 547 - 558. 
Josep M. Guerrero, Juan C. Vasquez, et al. (2007). Parallel Operation of Uninterruptible 

Power Supply Systems in MicroGrids. EPE 2007, Aalborg, Denmark. 



Energy Management 243 

K Siri, C.Q. Lee, et al. (1992). "Current distribution control for parallel connected converters." 

IEEE Transactions on Aerospace and Electronic Systems 28(3): 841 - 851. 
K. De Brabandere, A. Woyte, et al. (2004). Prevemtion of inverter voltage tripping in high 

density PV grids. 19th EU-PVSEC, Paris, France. 
Karlsson, P., J. Bjornstedt, et al. (2005). Stability of Voltage and Frequency Control in 

Distributed Generation Based on Parallel-Connected Converters Feeding Constant 

Power Loads. EPE, Dresden, Germany. 
Lasseter, R. H. (2002). MicroGrids. Power Engineering Society Winter Meeting. 
Lasseter, R. H. (2007). "Microgrids and Distributed Generation." Journal of Energy 

Engineering. 
Lee, C. S., S. K. Kim, et al. (1998). Parallel UPS with a instantaneous current sharing control. 

Proceedings of the 24th Annual Conference of the IEEE Industrial Electronics 

Society, Aachen, Germany. 
Lopes, J. P. (2004). MICROGRIDS Large Scale Integration of Microgeneration to Low 

Voltage Grids-Emergency Strategies and Algorithms. 
M. C. Chandorkar, D. M. Divan, et al. (1994). Control of distributed ups systems. IEEE 

Annual Power Electronics Specialists Conference. 
M. C. Chandorkar, D. D., R. Adapa (1993). "Control of Parallel Connected Inverters in 

Standalone ac Supply Systems." IEEE Transactions on Industry Applications 29(1). 
M. Chandorkar, D. D., Y. Hu and B. Banerjee (1994). Novel architectures and control for 

distributed UPS systems. Applied Power Electronics Conference and Exposition, 

Orlando, FL, USA. 
Maria Brucoli and T. C. Green (2006). Fault Response of Inverter Dominated Microgrids. 2nd 

International Conference on Integration of Renewable and Distributed Energy 

Resources, Napa, California, USA. 
Marwali, M. N., J.-W. Jung, et al. (2004). "Control of Distributed Generation Systems,Part II: 

Load Sharing Control." IEEE TRANSACTIONS ON POWER ELECTRONICS 19(6). 
Matthias, H. and S. Helmut (2002). Control of a Three-Phase Inverter Feeding an 

Unbalanced Load and Working in Parallel with Other Power Sources. EPE-PEMC 

Dubrovnik. 
McDowall, J. A. (2007). Status and Outlook of the Energy Storage Market. PES 2007, Tampa. 
Mihalache, L. (2003). Paralleling control technique with no intercommunication signals for 

resonant controller-based inverters. 38th IAS Annual Meeting Industry 

Applications Conference. 
Nigim, K. and W.-J. Lee (2007). Micro Grid Integration Opportunities and Challanges. IEEE 

PES 2007, Tampa, FL. 
Noguchi, I. T. a. T. (1986). "A new quick-response and high-efficiency control strategy of an 

induction motor." IEEE Trans. Industry Applications, IA(22): 820-827. 
Omari, O. (2005). Conceptual Development of a General Supply Philosophy for Isolated 

Electrical Power Systems. Soest, Germany, South Westphalia University of Applied 

Sciences. PhD. 
Ortjohann, E. and O. Omari (2004). Advanced Integration of Distributed Electricity 

Generators into Conventional Electric Networks Including Control, Management, 

and Communication Strategies. Soest. 
Osama Omari, Egon Ortjohann, et al. (2007). An Online Control Strategy for DC Coupled 

Hybrid Power Systems. IEEE PES general meeting, Tampa, Florida. 



244 Energy Management 

Pei, Y., G. Jiang, et al. (2004). Auto-master-slave control technique of parallel inverters in 

distributed AC power systems and UPS. IEEE 35th Annual Power Electronics 

Specialists Conference. 
Pepermans, G., J. Driesen, et al. (2005). "Distributed generation: definition, benefits and 

issues." Energy Policy 33: 787-798. 
Petruzziello, Z., G Joos (1990). A novel approach to paralleling of power converter units 

with true redundancy. 21st Annual IEEE Power Electronics Specialists Conference, 

San Antonio, TX, USA. 
Piagi, P. and R. H. Lasseter (June 2006). Autonomous Control of Microgrids. IEEE PES 

Meeting, Montreal. 
Prodanovic, M., T. C. Green, et al. (2000). A survey of control methods for three-phase 

inverters in parallel connection. Eighth International Conference on Power 

Electronics and Variable Speed Drives. 
Prodanovic, M. G., T.C. (Oct. 2006). "High-Quality Power Generation Through Distributed 

Control of a Power Park Microgrid." IEEE Transactions on Industrial Electronics 

53(5): 1471-1482. 
Purchala, K., R. Belmans, et al. (2006). Distributed generation and the grid integration issues. 

E. S. E. C. A. o. F. E. D. a. G. o. E. E. a. i. S. o. Supply. 
Qinglin, Z., C. Zhongying, et al. (2006). Improved Control for Parallel Inverter with Current- 
Sharing Control Scheme. CES/IEEE 5th International Power Electronics and 

Motion Control Conference. 
Rashid, M. H. (1995). Power Electronics Handbook: Devices, Circuits and Applications. 
Ritwik Majumder , Arindam Ghosh , et al. (2007). Load Sharing with Parallel Inverters in 

Distributed Generation and Power System Stability. Smart Systems 2007 

"Technology, Systems and Innovation". 
Robert Lasseter and P. Piagi (2006). Control and Design of Microgrid Components. P. P. 06- 

03, University of Wisconsin-Madison. 
S Tamai, M. K. (1991). Parallel operation of digital controlled UPS system. International 

Conference on Industrial Electronics, Control and Instrumentation. 
Said El-Barbari and W. Hofmann (2000). Digital Control of a Four Leg Inverter for 

Standalone Photovoltaic Systems with Unbalanced Load. IECON 2000. 26th Annual 

Conference of the IEEE. 
Sao, C. K. and P. W. Lehn (2005). "Autonomous Load Sharing of Voltage Source Converters." 

IEEE Transactions on Power Delivery 20(2): 1009-1016. 
T.C. Green and M. Prodanovic (2007). "Control of inverter-based micro-grids." Electric 

Power Systems Research 77(9): 1204-1213 
T.Kawabata and S.Higashino (1988). "Parallel operation of voltage source inverters." IEEE 

Transactions on Industrial Electronics Industry Applications 24( 2): 281-287. 
T.Skjellnes, A.Skjellnes, et al. ( 2002). Load Sharing for Parallel Inverters without 

Communication. Nordic Workshop on Power and Industrial Electronics (Norpie 

2002), Stockholm, Sweden. 
Tuladhar, A. (2000). Advanced control techniques for parallel inverter operation without 

control interconnections. Dept of electrical and computer engineering, The 

University of British Columbia. Doctor of Philosophy. 



Energy Management 245 

Van Der Broeck, H. and U. Boeke (1998). A simple method for parallel operation of 

inverters. Twentieth International Telecommunications Energy Conference, . 

INTELEC. . 
W.Hoffmann, R.Bugyi, et al. (1993). PWM inverter for parallel operation as high quality AC 

source intelecommunication. 15th International Telecommunications Energy 

Conference, 1993. INTELEC '93. , Paris, France. 
Xing, Y., L. P. Huang, et al. (2002). A decoupling control method for inverters in parallel 

operation. International Conference on Power System Technology, PowerCon 2002. 
Zhang, R. (1998). High performance power converter systems for nonlinear and unbalanced 

load/ source. Faculty of the Virginia Polytechnic Institute and State University. 

Virginia. PhD. 
Zhang, R., D. P. Boroyevich, et al. (1997). A three-phase inverter with a neutral leg with 

space vector modulation. Twelfth Annual Applied Power Electronics Conference 

and Exposition,. 



246 Energy Management 



