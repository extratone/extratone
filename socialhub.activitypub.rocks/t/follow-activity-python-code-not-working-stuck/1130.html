<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Follow Activity python code not working, STUCK! - Server to Server - SocialHub</title>
    <meta name="description" content="Hi all, 
I am trying to wrote some sample Follow code and Instance response code on the Fediverse, but am not having success after a prolonged period of time. 
In short, I am trying to simulate a Follow request from one &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta2 - https://github.com/discourse/discourse version c39ab6c0ae3803b6a62501954ae40adb6b73d580">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/b7023860b3d7df97ea10ba3c7ab11cb046a77c7a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/8faac84234dc73d074dadaa2bcf24dc746b8647f_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1130.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://socialhub.activitypub.rocks","potentialAction":{"@type":"SearchAction","target":"https://socialhub.activitypub.rocks/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="SocialHub Search">

      <link href="https://socialhub.activitypub.rocks/stylesheets/desktop_caa977791d50efc800b8ef1bcbafb8a15f082761.css?__ws=socialhub.activitypub.rocks" media="all" rel="stylesheet" data-target="desktop" />
      <link href="https://socialhub.activitypub.rocks/stylesheets/desktop_theme_5_969dd27459c19a0b7620746a3d179b86ef033d7a.css?__ws=socialhub.activitypub.rocks" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="5"/>
<link href="https://socialhub.activitypub.rocks/stylesheets/desktop_theme_3_f50bf2f225326f482d56e65e93f1f047d48417a9.css?__ws=socialhub.activitypub.rocks" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3"/>
<link href="https://socialhub.activitypub.rocks/stylesheets/desktop_theme_8_e3f93470fef56ec97b63f77e16779e328baab8ea.css?__ws=socialhub.activitypub.rocks" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="8"/>
<link href="https://socialhub.activitypub.rocks/stylesheets/desktop_theme_4_8d506fd22b761a15044193a6d4ebda5f6bde2498.css?__ws=socialhub.activitypub.rocks" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4"/>
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Follow Activity python code not working, STUCK!&#39;" href="1130.rss" />
    <meta property="og:site_name" content="SocialHub" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://socialhub.activitypub.rocks/uploads/default/original/1X/8faac84234dc73d074dadaa2bcf24dc746b8647f.png" />
<meta property="og:image" content="https://socialhub.activitypub.rocks/uploads/default/original/1X/8faac84234dc73d074dadaa2bcf24dc746b8647f.png" />
<meta property="og:url" content="https://socialhub.activitypub.rocks/t/follow-activity-python-code-not-working-stuck/1130" />
<meta name="twitter:url" content="https://socialhub.activitypub.rocks/t/follow-activity-python-code-not-working-stuck/1130" />
<meta property="og:title" content="Follow Activity python code not working, STUCK!" />
<meta name="twitter:title" content="Follow Activity python code not working, STUCK!" />
<meta property="og:description" content="Hi all,  I am trying to wrote some sample Follow code and Instance response code on the Fediverse, but am not having success after a prolonged period of time.  In short, I am trying to simulate a Follow request from one instance to another. The Follow Request instance is supposed to be farhan@p.farhan.codes. This runs some custom Python code I have written. The receiving host is ngrok@ee880c3b32b8.ngrok.io, an active instance running Pleroma.  I am having the receiving host, in this case ee880c3..." />
<meta name="twitter:description" content="Hi all,  I am trying to wrote some sample Follow code and Instance response code on the Fediverse, but am not having success after a prolonged period of time.  In short, I am trying to simulate a Follow request from one instance to another. The Follow Request instance is supposed to be farhan@p.farhan.codes. This runs some custom Python code I have written. The receiving host is ngrok@ee880c3b32b8.ngrok.io, an active instance running Pleroma.  I am having the receiving host, in this case ee880c3..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />
<meta property="article:published_time" content="2020-11-08T08:08:37+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
<script src="https://socialhub.activitypub.rocks/theme-javascripts/3a68d4ddcab78e923b7c4169708a8f1deb79df66.js?__ws=socialhub.activitypub.rocks"></script>
    <header>
      <a href="https://socialhub.activitypub.rocks/">
          <img src="../../uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png" alt="SocialHub" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1130.html">Follow Activity python code not working, STUCK!</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/activitypub.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0088CC'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>ActivityPub</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/activitypub/s2s/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #808281'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Server to Server</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/python.html' class='discourse-tag' rel="tag">python</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/farhan.html'><span itemprop='name'>farhan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-08T08:08:37Z' class='post-time'>
                November 8, 2020,  8:08am
              </time>
              <meta itemprop='dateModified' content='2020-11-08T08:08:37Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi all,<br>
I am trying to wrote some sample Follow code and Instance response code on the Fediverse, but am not having success after a prolonged period of time.</p>
<p>In short, I am trying to simulate a Follow request from one instance to another. The Follow Request instance is supposed to be farhan@p.farhan.codes. This runs some custom Python code I have written. The receiving host is <a href="mailto:ngrok@ee880c3b32b8.ngrok.io">ngrok@ee880c3b32b8.ngrok.io</a>, an active instance running Pleroma.</p>
<p>I am having the receiving host, in this case ee880c3b32b8 (dot) ngrok (dot) io (changed because of forum limitations), reach back out to the test server, p.farhan.codes/users/farhan, upon which it reports back that there was a failure.</p>
<p>I suspect the mistake is somewhere in the httpsig or the response, but I have no idea where or what. My follow code is as follows below. Feel free to also reach out to the running host p.farhan.codes.</p>
<p>Please please assist! I am utterly stuck!<br>
<a href="https://dpaste.org/8OGk" rel="noopener nofollow ugc">https://dpaste.org/8OGk</a></p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>
          <meta itemprop='keywords' content='python'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/grishka.html'><span itemprop='name'>grishka</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-08T08:28:27Z' class='post-time'>
                November 8, 2020,  8:28am
              </time>
              <meta itemprop='dateModified' content='2020-11-08T08:28:27Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I don’t see where you’re making the actor object available when the receiving host tries to request it. See <a href="https://blog.joinmastodon.org/2018/06/how-to-implement-a-basic-activitypub-server/" rel="noopener nofollow ugc">this tutorial</a> and its <a href="https://blog.joinmastodon.org/2018/07/how-to-make-friends-and-verify-requests/" rel="noopener nofollow ugc">second part</a>.</p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/farhan.html'><span itemprop='name'>farhan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-08T19:38:02Z' class='post-time'>
                November 8, 2020,  7:38pm
              </time>
              <meta itemprop='dateModified' content='2020-11-08T19:38:02Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi Grishka,</p>
<p>I did not understand what you mean by not making the actor object available. Do you mean that the Requested instance, in this case ee880c3b32b8(dot)ngrok(dot)io, will reach back out to the requestor instance? Would that be a request to /inbox/username? I have code that does exactly that and replies with the public portion of the certificate used to send the initial certificate. However, I still receive an “error” message.</p>
<p>My thoughts are either:<br>
A. The format that it is replying in is not correct - However, I verbatim copied a Mastodon instance’s reply format.<br>
B. Something is wrong with the HTTP sig code<br>
C. Something else.</p>
<p>I read the Mastodon documentation, but to be honest, it is not very clear on how a response to the actor object should look.</p>
<p>Still stuck and don’t have a path forward…</p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/grishka.html'><span itemprop='name'>grishka</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-08T19:52:10Z' class='post-time'>
                November 8, 2020,  7:52pm
              </time>
              <meta itemprop='dateModified' content='2020-11-08T19:52:10Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It will request the actor object from the URL you specify in the <code>actor</code> field in your activity. The object should be a well-formed JSON document, with the public key among other things. Please read the tutorials I linked, they explain everything you need to achieve the exact thing you’re trying to do. Just replace Ruby code with Python equivalent.</p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/cjs.html'><span itemprop='name'>cjs</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-09T10:53:41Z' class='post-time'>
                November 9, 2020, 10:53am
              </time>
              <meta itemprop='dateModified' content='2020-11-09T10:53:41Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Your <code>publicKeyPem</code> is not being encoded correctly. When I run</p>
<p><code>curl https://p.farhan.codes/users/farhan -H "Accept: application/activity+json"</code></p>
<p>I get:</p>
<pre><code class="lang-auto">{
  "@context": ["https://www.w3.org/ns/activitystreams", "https://p.farhan.codes/schemas/litepub-0.1.jsonld", {"@language": "und"}],
  "attachment": [],
  "capabilities": {"acceptsChatMessages": true},
  "discoverable": false,
  "endpoints": {"oauthAuthorizationEndpoint": "https://p.farhan.codes/oauth/authorize", "oauthRegistrationEndpoint": "https://p.farhan.codes/api/v1/apps", "oauthTokenEndpoint": "https://p.farhan.codes/oauth/token", "sharedInbox": "https://p.farhan.codes/inbox", "uploadMedia": "https://p.farhan.codes/api/ap/upload_media"},
  "followers": "https://p.farhan.codes/users/farhan/followers",
  "following": "https://p.farhan.codes/users/farhan/following",
  "id": "https://p.farhan.codes/users/farhan",
  "inbox": "https://p.farhan.codes/users/farhan/inbox",
  "manuallyApprovesFollowers": false,
  "name": "farhan",
  "outbox": "https://p.farhan.codes/users/farhan/outbox",
  "preferredUsername": "farhan",
  "publicKey": {
    "id": "https://p.farhan.codes/users/farhan#main-key",
    "owner": "https://p.farhan.codes/users/farhan",
    "publicKeyPem": "-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn5JI+uBbt3w0tPekK+UD\\naQLRG220XztYLEE1gC8eGYctYgrTX0wruNP+CFap1VsvyWxRoitNjFLDD3pwYxK9\\n+k6P459ekL0fSRqQ0bzOQ5Vb22PBs9iOKonV9FSljCcDg0kc3cvxCeU246BMurGI\\nIs0vWk3UwygkeMo+rYXDluTtuSvZs+2ume2JYgrtcQoDH5YzU+76dRLYfd1+xEFo\\nP+K0hFb7+LhwGwDuLtTUYQ39kqm2jnC9/3W5yyweBqh05iQ0joDC0nuoZpjvT7on\\n2Obwluci30Q2xS1i+5244qr9Ouq1EK+9kdf15RMMOH1Azumho1YNFoVZlcxy2bar\\n6wIDAQAB\\n-----END PUBLIC KEY-----\\n"
  },
  "summary": "",
  "tag": [], "type":
  "Person",
  "url": "https://p.farhan.codes/users/farhan"
}
</code></pre>
<p>Which has <code>publicKeyPem</code> improperly escaped with <code>\\n</code> instead of <code>\n</code>. For verification, see <a href="https://play.golang.org/p/ORiR8OMuJus" rel="noopener nofollow ugc">this playground in Golang</a>.</p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/farhan.html'><span itemprop='name'>farhan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2020-11-09T23:06:45Z'>
              <time itemprop='dateModified' datetime='2020-11-09T23:08:16Z' class='post-time'>
                November 9, 2020, 11:08pm
              </time>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="cjs" data-post="5" data-topic="1130">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/socialhub.activitypub.rocks/cjs/40/35_2.png" class="avatar"> cjs:</div>
<blockquote>
<p><code>curl https://p.farhan.codes/users/farhan -H "Accept: application/activity+json"</code></p>
</blockquote>
</aside>
<p>I modified the code to remove the double escape characters. The failure remains. Please see below:</p>
<pre><code class="lang-auto">$ curl https://p.farhan.codes/users/farhan -H "Accept: application/activity+json"
{
  "@context": [
    "https://www.w3.org/ns/activitystreams",
    "https://p.farhan.codes/schemas/litepub-0.1.jsonld",
    {
      "@language": "und"
    }
  ],
  "attachment": [],
  "capabilities": {
    "acceptsChatMessages": true
  },
  "discoverable": false,
  "endpoints": {
    "oauthAuthorizationEndpoint": "https://p.farhan.codes/oauth/authorize",
    "oauthRegistrationEndpoint": "https://p.farhan.codes/api/v1/apps",
    "oauthTokenEndpoint": "https://p.farhan.codes/oauth/token",
    "sharedInbox": "https://p.farhan.codes/inbox",
    "uploadMedia": "https://p.farhan.codes/api/ap/upload_media"
  },
  "followers": "https://p.farhan.codes/users/farhan/followers",
  "following": "https://p.farhan.codes/users/farhan/following",
  "id": "https://p.farhan.codes/users/farhan",
  "inbox": "https://p.farhan.codes/users/farhan/inbox",
  "manuallyApprovesFollowers": false,
  "name": "farhan",
  "outbox": "https://p.farhan.codes/users/farhan/outbox",
  "preferredUsername": "farhan",
  "publicKey": {
    "id": "https://p.farhan.codes/users/farhan#main-key",
    "owner": "https://p.farhan.codes/users/farhan",
    "publicKeyPem": "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn5JI+uBbt3w0tPekK+UD\naQLRG220XztYLEE1gC8eGYctYgrTX0wruNP+CFap1VsvyWxRoitNjFLDD3pwYxK9\n+k6P459ekL0fSRqQ0bzOQ5Vb22PBs9iOKonV9FSljCcDg0kc3cvxCeU246BMurGI\nIs0vWk3UwygkeMo+rYXDluTtuSvZs+2ume2JYgrtcQoDH5YzU+76dRLYfd1+xEFo\nP+K0hFb7+LhwGwDuLtTUYQ39kqm2jnC9/3W5yyweBqh05iQ0joDC0nuoZpjvT7on\n2Obwluci30Q2xS1i+5244qr9Ouq1EK+9kdf15RMMOH1Azumho1YNFoVZlcxy2bar\n6wIDAQAB\n-----END PUBLIC KEY-----\n"
  },
  "summary": "",
  "tag": [],
  "type": "Person",
  "url": "https://p.farhan.codes/users/farhan"
}</code></pre>
<p>Still does not follow. In the case of a Mastodon server, it reports</p>
<blockquote>
<p>Verification failed for farhan@p.farhan.codes <a href="https://p.farhan.codes/users/farhan" rel="noopener nofollow ugc">https://p.farhan.codes/users/farhan</a></p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/grishka.html'><span itemprop='name'>grishka</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2020-11-10T08:23:36Z'>
              <time itemprop='dateModified' datetime='2020-11-10T08:30:08Z' class='post-time'>
                November 10, 2020,  8:30am
              </time>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Are you sure you’re signing your requests correctly? Your actor object appears to be valid now, including the public key, at least Smithereen happily accepts it (<a href="https://friends.grishka.me/farhan@p.farhan.codes" rel="noopener nofollow ugc">see on my instance</a>).</p>
<p>Edit: see my <a href="https://github.com/grishka/Smithereen/blob/af68150770b0acb292cbe92b6946a1debdd21d1a/src/main/java/smithereen/activitypub/ActivityPub.java#L93" rel="noopener nofollow ugc">definitely working Java code</a> for HTTP signatures. You may skip Digest, the part where you hash the entire request body, but be aware that some Mastodon instances won’t accept requests without it.</p>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Petites Singularités'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://socialhub.activitypub.rocks/uploads/default/original/1X/4d2bcc2cd17698f8d3efb8ffaa6983d11bbf3229.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/cjs.html'><span itemprop='name'>cjs</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1130.html">

            <link itemprop="image" href="../../uploads/default/original/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166.png">

          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-10T18:16:17Z' class='post-time'>
                November 10, 2020,  6:16pm
              </time>
              <meta itemprop='dateModified' content='2020-11-10T18:16:17Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Your python3 code is:</p>
<pre><code class="lang-auto">signed_message = '(request-target): {%s} {%s}\nhost: {%s}\ndate: {%s}' % (method, request_path, to_hostname, now)
</code></pre>
<p>Which is confusing the <a href="https://docs.python.org/3.3/library/string.html#format-string-syntax" rel="noopener nofollow ugc"><code>.format</code> string syntax</a> and the <a href="https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting" rel="noopener nofollow ugc">string interpolation operator</a>.</p>
<p>Your <code>signed_message</code> on the playground looks like:</p>
<pre><code class="lang-auto">(request-target): {post} {../Playground/}
host: {ee880c3b32b8.ngrok.io}
date: {Tue, 10 Nov 2020 18:13:39 GMT}
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../uploads/default/original/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166.png" data-download-href="https://socialhub.activitypub.rocks/uploads/default/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166" title="Screen Shot 2020-11-10 at 19.14.57"><img src="../../uploads/default/optimized/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166_2_690x194.png" alt="Screen Shot 2020-11-10 at 19.14.57" data-base62-sha1="tkgk42J4dCmH0bw4mwvLVRVj2hE" width="690" height="194" srcset="../../uploads/default/optimized/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166_2_690x194.png, ../../uploads/default/optimized/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166_2_1035x291.png 1.5x, ../../uploads/default/optimized/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166_2_1380x388.png 2x" data-small-upload="https://socialhub.activitypub.rocks/uploads/default/optimized/1X/cd896e0d8dc137bfaa3aa5be0dad16fb6b3b2166_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Screen Shot 2020-11-10 at 19.14.57</span><span class="informations">1409×397 53.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>Which is incorrectly adding the <code>{}</code>s.</p>
<p>Simply remove them:</p>
<pre><code class="lang-auto">signed_message = '(request-target): %s %s\nhost: %s\ndate: %s' % (method, request_path, to_hostname, now)
</code></pre>
        </div>

        <meta itemprop='headline' content='Follow Activity python code not working, STUCK!'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://socialhub.activitypub.rocks/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://socialhub.activitypub.rocks/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://socialhub.activitypub.rocks/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://socialhub.activitypub.rocks/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://socialhub.activitypub.rocks/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
